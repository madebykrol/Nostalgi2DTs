var sd=Object.defineProperty;var ad=(e,t,r)=>t in e?sd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var L=(e,t,r)=>ad(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();function ld(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var df={exports:{}},La={},vf={exports:{}},G={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qo=Symbol.for("react.element"),ud=Symbol.for("react.portal"),cd=Symbol.for("react.fragment"),hd=Symbol.for("react.strict_mode"),md=Symbol.for("react.profiler"),fd=Symbol.for("react.provider"),pd=Symbol.for("react.context"),_d=Symbol.for("react.forward_ref"),dd=Symbol.for("react.suspense"),vd=Symbol.for("react.memo"),yd=Symbol.for("react.lazy"),Hc=Symbol.iterator;function gd(e){return e===null||typeof e!="object"?null:(e=Hc&&e[Hc]||e["@@iterator"],typeof e=="function"?e:null)}var yf={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},gf=Object.assign,xf={};function Hn(e,t,r){this.props=e,this.context=t,this.refs=xf,this.updater=r||yf}Hn.prototype.isReactComponent={};Hn.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Hn.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Af(){}Af.prototype=Hn.prototype;function Ru(e,t,r){this.props=e,this.context=t,this.refs=xf,this.updater=r||yf}var Du=Ru.prototype=new Af;Du.constructor=Ru;gf(Du,Hn.prototype);Du.isPureReactComponent=!0;var Yc=Array.isArray,wf=Object.prototype.hasOwnProperty,Ou={current:null},Bf={key:!0,ref:!0,__self:!0,__source:!0};function Cf(e,t,r){var i,n={},o=null,s=null;if(t!=null)for(i in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(o=""+t.key),t)wf.call(t,i)&&!Bf.hasOwnProperty(i)&&(n[i]=t[i]);var a=arguments.length-2;if(a===1)n.children=r;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];n.children=l}if(e&&e.defaultProps)for(i in a=e.defaultProps,a)n[i]===void 0&&(n[i]=a[i]);return{$$typeof:Qo,type:e,key:o,ref:s,props:n,_owner:Ou.current}}function xd(e,t){return{$$typeof:Qo,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function qu(e){return typeof e=="object"&&e!==null&&e.$$typeof===Qo}function Ad(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Jc=/\/+/g;function Ga(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Ad(""+e.key):t.toString(36)}function Ys(e,t,r,i,n){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case Qo:case ud:s=!0}}if(s)return s=e,n=n(s),e=i===""?"."+Ga(s,0):i,Yc(n)?(r="",e!=null&&(r=e.replace(Jc,"$&/")+"/"),Ys(n,t,r,"",function(c){return c})):n!=null&&(qu(n)&&(n=xd(n,r+(!n.key||s&&s.key===n.key?"":(""+n.key).replace(Jc,"$&/")+"/")+e)),t.push(n)),1;if(s=0,i=i===""?".":i+":",Yc(e))for(var a=0;a<e.length;a++){o=e[a];var l=i+Ga(o,a);s+=Ys(o,t,r,l,n)}else if(l=gd(e),typeof l=="function")for(e=l.call(e),a=0;!(o=e.next()).done;)o=o.value,l=i+Ga(o,a++),s+=Ys(o,t,r,l,n);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function rs(e,t,r){if(e==null)return e;var i=[],n=0;return Ys(e,i,"","",function(o){return t.call(r,o,n++)}),i}function wd(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ne={current:null},Js={transition:null},Bd={ReactCurrentDispatcher:ne,ReactCurrentBatchConfig:Js,ReactCurrentOwner:Ou};function Sf(){throw Error("act(...) is not supported in production builds of React.")}G.Children={map:rs,forEach:function(e,t,r){rs(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return rs(e,function(){t++}),t},toArray:function(e){return rs(e,function(t){return t})||[]},only:function(e){if(!qu(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};G.Component=Hn;G.Fragment=cd;G.Profiler=md;G.PureComponent=Ru;G.StrictMode=hd;G.Suspense=dd;G.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Bd;G.act=Sf;G.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=gf({},e.props),n=e.key,o=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,s=Ou.current),t.key!==void 0&&(n=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)wf.call(t,l)&&!Bf.hasOwnProperty(l)&&(i[l]=t[l]===void 0&&a!==void 0?a[l]:t[l])}var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];i.children=a}return{$$typeof:Qo,type:e.type,key:n,ref:o,props:i,_owner:s}};G.createContext=function(e){return e={$$typeof:pd,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:fd,_context:e},e.Consumer=e};G.createElement=Cf;G.createFactory=function(e){var t=Cf.bind(null,e);return t.type=e,t};G.createRef=function(){return{current:null}};G.forwardRef=function(e){return{$$typeof:_d,render:e}};G.isValidElement=qu;G.lazy=function(e){return{$$typeof:yd,_payload:{_status:-1,_result:e},_init:wd}};G.memo=function(e,t){return{$$typeof:vd,type:e,compare:t===void 0?null:t}};G.startTransition=function(e){var t=Js.transition;Js.transition={};try{e()}finally{Js.transition=t}};G.unstable_act=Sf;G.useCallback=function(e,t){return ne.current.useCallback(e,t)};G.useContext=function(e){return ne.current.useContext(e)};G.useDebugValue=function(){};G.useDeferredValue=function(e){return ne.current.useDeferredValue(e)};G.useEffect=function(e,t){return ne.current.useEffect(e,t)};G.useId=function(){return ne.current.useId()};G.useImperativeHandle=function(e,t,r){return ne.current.useImperativeHandle(e,t,r)};G.useInsertionEffect=function(e,t){return ne.current.useInsertionEffect(e,t)};G.useLayoutEffect=function(e,t){return ne.current.useLayoutEffect(e,t)};G.useMemo=function(e,t){return ne.current.useMemo(e,t)};G.useReducer=function(e,t,r){return ne.current.useReducer(e,t,r)};G.useRef=function(e){return ne.current.useRef(e)};G.useState=function(e){return ne.current.useState(e)};G.useSyncExternalStore=function(e,t,r){return ne.current.useSyncExternalStore(e,t,r)};G.useTransition=function(){return ne.current.useTransition()};G.version="18.3.1";vf.exports=G;var Ae=vf.exports;const Cd=ld(Ae);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sd=Ae,Pd=Symbol.for("react.element"),bd=Symbol.for("react.fragment"),Md=Object.prototype.hasOwnProperty,Vd=Sd.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Td={key:!0,ref:!0,__self:!0,__source:!0};function Pf(e,t,r){var i,n={},o=null,s=null;r!==void 0&&(o=""+r),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(s=t.ref);for(i in t)Md.call(t,i)&&!Td.hasOwnProperty(i)&&(n[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)n[i]===void 0&&(n[i]=t[i]);return{$$typeof:Pd,type:e,key:o,ref:s,props:n,_owner:Vd.current}}La.Fragment=bd;La.jsx=Pf;La.jsxs=Pf;df.exports=La;var Uu=df.exports;const bf=Uu.Fragment,tr=Uu.jsx,Mf=Uu.jsxs;var Vf={exports:{}},Pe={},Tf={exports:{}},kf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(k,N){var W=k.length;k.push(N);t:for(;0<W;){var et=W-1>>>1,lt=k[et];if(0<n(lt,N))k[et]=N,k[W]=lt,W=et;else break t}}function r(k){return k.length===0?null:k[0]}function i(k){if(k.length===0)return null;var N=k[0],W=k.pop();if(W!==N){k[0]=W;t:for(var et=0,lt=k.length,Ve=lt>>>1;et<Ve;){var _e=2*(et+1)-1,lr=k[_e],We=_e+1,gi=k[We];if(0>n(lr,W))We<lt&&0>n(gi,lr)?(k[et]=gi,k[We]=W,et=We):(k[et]=lr,k[_e]=W,et=_e);else if(We<lt&&0>n(gi,W))k[et]=gi,k[We]=W,et=We;else break t}}return N}function n(k,N){var W=k.sortIndex-N.sortIndex;return W!==0?W:k.id-N.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();e.unstable_now=function(){return s.now()-a}}var l=[],c=[],h=1,m=null,f=3,p=!1,_=!1,d=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(k){for(var N=r(c);N!==null;){if(N.callback===null)i(c);else if(N.startTime<=k)i(c),N.sortIndex=N.expirationTime,t(l,N);else break;N=r(c)}}function A(k){if(d=!1,g(k),!_)if(r(l)!==null)_=!0,ht(w);else{var N=r(c);N!==null&&At(A,N.startTime-k)}}function w(k,N){_=!1,d&&(d=!1,v(P),P=-1),p=!0;var W=f;try{for(g(N),m=r(l);m!==null&&(!(m.expirationTime>N)||k&&!O());){var et=m.callback;if(typeof et=="function"){m.callback=null,f=m.priorityLevel;var lt=et(m.expirationTime<=N);N=e.unstable_now(),typeof lt=="function"?m.callback=lt:m===r(l)&&i(l),g(N)}else i(l);m=r(l)}if(m!==null)var Ve=!0;else{var _e=r(c);_e!==null&&At(A,_e.startTime-N),Ve=!1}return Ve}finally{m=null,f=W,p=!1}}var C=!1,S=null,P=-1,F=5,I=-1;function O(){return!(e.unstable_now()-I<F)}function X(){if(S!==null){var k=e.unstable_now();I=k;var N=!0;try{N=S(!0,k)}finally{N?Q():(C=!1,S=null)}}else C=!1}var Q;if(typeof y=="function")Q=function(){y(X)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,Nt=K.port2;K.port1.onmessage=X,Q=function(){Nt.postMessage(null)}}else Q=function(){x(X,0)};function ht(k){S=k,C||(C=!0,Q())}function At(k,N){P=x(function(){k(e.unstable_now())},N)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(k){k.callback=null},e.unstable_continueExecution=function(){_||p||(_=!0,ht(w))},e.unstable_forceFrameRate=function(k){0>k||125<k?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<k?Math.floor(1e3/k):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(k){switch(f){case 1:case 2:case 3:var N=3;break;default:N=f}var W=f;f=N;try{return k()}finally{f=W}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(k,N){switch(k){case 1:case 2:case 3:case 4:case 5:break;default:k=3}var W=f;f=k;try{return N()}finally{f=W}},e.unstable_scheduleCallback=function(k,N,W){var et=e.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?et+W:et):W=et,k){case 1:var lt=-1;break;case 2:lt=250;break;case 5:lt=1073741823;break;case 4:lt=1e4;break;default:lt=5e3}return lt=W+lt,k={id:h++,callback:N,priorityLevel:k,startTime:W,expirationTime:lt,sortIndex:-1},W>et?(k.sortIndex=W,t(c,k),r(l)===null&&k===r(c)&&(d?(v(P),P=-1):d=!0,At(A,W-et))):(k.sortIndex=lt,t(l,k),_||p||(_=!0,ht(w))),k},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(k){var N=f;return function(){var W=f;f=N;try{return k.apply(this,arguments)}finally{f=W}}}})(kf);Tf.exports=kf;var kd=Tf.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Id=Ae,Ce=kd;function T(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var If=new Set,To={};function Gi(e,t){Rn(e,t),Rn(e+"Capture",t)}function Rn(e,t){for(To[e]=t,e=0;e<t.length;e++)If.add(t[e])}var Fr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ul=Object.prototype.hasOwnProperty,zd=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Xc={},Qc={};function Ld(e){return Ul.call(Qc,e)?!0:Ul.call(Xc,e)?!1:zd.test(e)?Qc[e]=!0:(Xc[e]=!0,!1)}function Fd(e,t,r,i){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Ed(e,t,r,i){if(t===null||typeof t>"u"||Fd(e,t,r,i))return!0;if(i)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function oe(e,t,r,i,n,o,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var Ht={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ht[e]=new oe(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ht[t]=new oe(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ht[e]=new oe(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ht[e]=new oe(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ht[e]=new oe(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ht[e]=new oe(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ht[e]=new oe(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ht[e]=new oe(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ht[e]=new oe(e,5,!1,e.toLowerCase(),null,!1,!1)});var $u=/[\-:]([a-z])/g;function ju(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace($u,ju);Ht[t]=new oe(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace($u,ju);Ht[t]=new oe(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace($u,ju);Ht[t]=new oe(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ht[e]=new oe(e,1,!1,e.toLowerCase(),null,!1,!1)});Ht.xlinkHref=new oe("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ht[e]=new oe(e,1,!1,e.toLowerCase(),null,!0,!0)});function Wu(e,t,r,i){var n=Ht.hasOwnProperty(t)?Ht[t]:null;(n!==null?n.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Ed(t,r,n,i)&&(r=null),i||n===null?Ld(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):n.mustUseProperty?e[n.propertyName]=r===null?n.type===3?!1:"":r:(t=n.attributeName,i=n.attributeNamespace,r===null?e.removeAttribute(t):(n=n.type,r=n===3||n===4&&r===!0?"":""+r,i?e.setAttributeNS(i,t,r):e.setAttribute(t,r))))}var Or=Id.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,is=Symbol.for("react.element"),gn=Symbol.for("react.portal"),xn=Symbol.for("react.fragment"),Hu=Symbol.for("react.strict_mode"),$l=Symbol.for("react.profiler"),zf=Symbol.for("react.provider"),Lf=Symbol.for("react.context"),Yu=Symbol.for("react.forward_ref"),jl=Symbol.for("react.suspense"),Wl=Symbol.for("react.suspense_list"),Ju=Symbol.for("react.memo"),Jr=Symbol.for("react.lazy"),Ff=Symbol.for("react.offscreen"),Gc=Symbol.iterator;function Xn(e){return e===null||typeof e!="object"?null:(e=Gc&&e[Gc]||e["@@iterator"],typeof e=="function"?e:null)}var xt=Object.assign,Ka;function fo(e){if(Ka===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Ka=t&&t[1]||""}return`
`+Ka+e}var Za=!1;function tl(e,t){if(!e||Za)return"";Za=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&typeof c.stack=="string"){for(var n=c.stack.split(`
`),o=i.stack.split(`
`),s=n.length-1,a=o.length-1;1<=s&&0<=a&&n[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(n[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||n[s]!==o[a]){var l=`
`+n[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=s&&0<=a);break}}}finally{Za=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?fo(e):""}function Nd(e){switch(e.tag){case 5:return fo(e.type);case 16:return fo("Lazy");case 13:return fo("Suspense");case 19:return fo("SuspenseList");case 0:case 2:case 15:return e=tl(e.type,!1),e;case 11:return e=tl(e.type.render,!1),e;case 1:return e=tl(e.type,!0),e;default:return""}}function Hl(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case xn:return"Fragment";case gn:return"Portal";case $l:return"Profiler";case Hu:return"StrictMode";case jl:return"Suspense";case Wl:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Lf:return(e.displayName||"Context")+".Consumer";case zf:return(e._context.displayName||"Context")+".Provider";case Yu:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ju:return t=e.displayName||null,t!==null?t:Hl(e.type)||"Memo";case Jr:t=e._payload,e=e._init;try{return Hl(e(t))}catch{}}return null}function Rd(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Hl(t);case 8:return t===Hu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function hi(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ef(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Dd(e){var t=Ef(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var n=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(s){i=""+s,o.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return i},setValue:function(s){i=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ns(e){e._valueTracker||(e._valueTracker=Dd(e))}function Nf(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),i="";return e&&(i=Ef(e)?e.checked?"true":"false":e.value),e=i,e!==r?(t.setValue(e),!0):!1}function oa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Yl(e,t){var r=t.checked;return xt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Kc(e,t){var r=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;r=hi(t.value!=null?t.value:r),e._wrapperState={initialChecked:i,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Rf(e,t){t=t.checked,t!=null&&Wu(e,"checked",t,!1)}function Jl(e,t){Rf(e,t);var r=hi(t.value),i=t.type;if(r!=null)i==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Xl(e,t.type,r):t.hasOwnProperty("defaultValue")&&Xl(e,t.type,hi(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Zc(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Xl(e,t,r){(t!=="number"||oa(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var po=Array.isArray;function In(e,t,r,i){if(e=e.options,t){t={};for(var n=0;n<r.length;n++)t["$"+r[n]]=!0;for(r=0;r<e.length;r++)n=t.hasOwnProperty("$"+e[r].value),e[r].selected!==n&&(e[r].selected=n),n&&i&&(e[r].defaultSelected=!0)}else{for(r=""+hi(r),t=null,n=0;n<e.length;n++){if(e[n].value===r){e[n].selected=!0,i&&(e[n].defaultSelected=!0);return}t!==null||e[n].disabled||(t=e[n])}t!==null&&(t.selected=!0)}}function Ql(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(T(91));return xt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function th(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(T(92));if(po(r)){if(1<r.length)throw Error(T(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:hi(r)}}function Df(e,t){var r=hi(t.value),i=hi(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),i!=null&&(e.defaultValue=""+i)}function eh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Of(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Gl(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Of(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var os,qf=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,i,n){MSApp.execUnsafeLocalFunction(function(){return e(t,r,i,n)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(os=os||document.createElement("div"),os.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=os.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ko(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var go={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Od=["Webkit","ms","Moz","O"];Object.keys(go).forEach(function(e){Od.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),go[t]=go[e]})});function Uf(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||go.hasOwnProperty(e)&&go[e]?(""+t).trim():t+"px"}function $f(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var i=r.indexOf("--")===0,n=Uf(r,t[r],i);r==="float"&&(r="cssFloat"),i?e.setProperty(r,n):e[r]=n}}var qd=xt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Kl(e,t){if(t){if(qd[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(T(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(T(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(T(61))}if(t.style!=null&&typeof t.style!="object")throw Error(T(62))}}function Zl(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var tu=null;function Xu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var eu=null,zn=null,Ln=null;function rh(e){if(e=Zo(e)){if(typeof eu!="function")throw Error(T(280));var t=e.stateNode;t&&(t=Da(t),eu(e.stateNode,e.type,t))}}function jf(e){zn?Ln?Ln.push(e):Ln=[e]:zn=e}function Wf(){if(zn){var e=zn,t=Ln;if(Ln=zn=null,rh(e),t)for(e=0;e<t.length;e++)rh(t[e])}}function Hf(e,t){return e(t)}function Yf(){}var el=!1;function Jf(e,t,r){if(el)return e(t,r);el=!0;try{return Hf(e,t,r)}finally{el=!1,(zn!==null||Ln!==null)&&(Yf(),Wf())}}function Io(e,t){var r=e.stateNode;if(r===null)return null;var i=Da(r);if(i===null)return null;r=i[t];t:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break t;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(T(231,t,typeof r));return r}var ru=!1;if(Fr)try{var Qn={};Object.defineProperty(Qn,"passive",{get:function(){ru=!0}}),window.addEventListener("test",Qn,Qn),window.removeEventListener("test",Qn,Qn)}catch{ru=!1}function Ud(e,t,r,i,n,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(h){this.onError(h)}}var xo=!1,sa=null,aa=!1,iu=null,$d={onError:function(e){xo=!0,sa=e}};function jd(e,t,r,i,n,o,s,a,l){xo=!1,sa=null,Ud.apply($d,arguments)}function Wd(e,t,r,i,n,o,s,a,l){if(jd.apply(this,arguments),xo){if(xo){var c=sa;xo=!1,sa=null}else throw Error(T(198));aa||(aa=!0,iu=c)}}function Ki(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Xf(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ih(e){if(Ki(e)!==e)throw Error(T(188))}function Hd(e){var t=e.alternate;if(!t){if(t=Ki(e),t===null)throw Error(T(188));return t!==e?null:e}for(var r=e,i=t;;){var n=r.return;if(n===null)break;var o=n.alternate;if(o===null){if(i=n.return,i!==null){r=i;continue}break}if(n.child===o.child){for(o=n.child;o;){if(o===r)return ih(n),e;if(o===i)return ih(n),t;o=o.sibling}throw Error(T(188))}if(r.return!==i.return)r=n,i=o;else{for(var s=!1,a=n.child;a;){if(a===r){s=!0,r=n,i=o;break}if(a===i){s=!0,i=n,r=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===r){s=!0,r=o,i=n;break}if(a===i){s=!0,i=o,r=n;break}a=a.sibling}if(!s)throw Error(T(189))}}if(r.alternate!==i)throw Error(T(190))}if(r.tag!==3)throw Error(T(188));return r.stateNode.current===r?e:t}function Qf(e){return e=Hd(e),e!==null?Gf(e):null}function Gf(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Gf(e);if(t!==null)return t;e=e.sibling}return null}var Kf=Ce.unstable_scheduleCallback,nh=Ce.unstable_cancelCallback,Yd=Ce.unstable_shouldYield,Jd=Ce.unstable_requestPaint,St=Ce.unstable_now,Xd=Ce.unstable_getCurrentPriorityLevel,Qu=Ce.unstable_ImmediatePriority,Zf=Ce.unstable_UserBlockingPriority,la=Ce.unstable_NormalPriority,Qd=Ce.unstable_LowPriority,tp=Ce.unstable_IdlePriority,Fa=null,gr=null;function Gd(e){if(gr&&typeof gr.onCommitFiberRoot=="function")try{gr.onCommitFiberRoot(Fa,e,void 0,(e.current.flags&128)===128)}catch{}}var rr=Math.clz32?Math.clz32:tv,Kd=Math.log,Zd=Math.LN2;function tv(e){return e>>>=0,e===0?32:31-(Kd(e)/Zd|0)|0}var ss=64,as=4194304;function _o(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ua(e,t){var r=e.pendingLanes;if(r===0)return 0;var i=0,n=e.suspendedLanes,o=e.pingedLanes,s=r&268435455;if(s!==0){var a=s&~n;a!==0?i=_o(a):(o&=s,o!==0&&(i=_o(o)))}else s=r&~n,s!==0?i=_o(s):o!==0&&(i=_o(o));if(i===0)return 0;if(t!==0&&t!==i&&!(t&n)&&(n=i&-i,o=t&-t,n>=o||n===16&&(o&4194240)!==0))return t;if(i&4&&(i|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)r=31-rr(t),n=1<<r,i|=e[r],t&=~n;return i}function ev(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rv(e,t){for(var r=e.suspendedLanes,i=e.pingedLanes,n=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-rr(o),a=1<<s,l=n[s];l===-1?(!(a&r)||a&i)&&(n[s]=ev(a,t)):l<=t&&(e.expiredLanes|=a),o&=~a}}function nu(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ep(){var e=ss;return ss<<=1,!(ss&4194240)&&(ss=64),e}function rl(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Go(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-rr(t),e[t]=r}function iv(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<r;){var n=31-rr(r),o=1<<n;t[n]=0,i[n]=-1,e[n]=-1,r&=~o}}function Gu(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var i=31-rr(r),n=1<<i;n&t|e[i]&t&&(e[i]|=t),r&=~n}}var st=0;function rp(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var ip,Ku,np,op,sp,ou=!1,ls=[],ii=null,ni=null,oi=null,zo=new Map,Lo=new Map,Gr=[],nv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function oh(e,t){switch(e){case"focusin":case"focusout":ii=null;break;case"dragenter":case"dragleave":ni=null;break;case"mouseover":case"mouseout":oi=null;break;case"pointerover":case"pointerout":zo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lo.delete(t.pointerId)}}function Gn(e,t,r,i,n,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:r,eventSystemFlags:i,nativeEvent:o,targetContainers:[n]},t!==null&&(t=Zo(t),t!==null&&Ku(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,n!==null&&t.indexOf(n)===-1&&t.push(n),e)}function ov(e,t,r,i,n){switch(t){case"focusin":return ii=Gn(ii,e,t,r,i,n),!0;case"dragenter":return ni=Gn(ni,e,t,r,i,n),!0;case"mouseover":return oi=Gn(oi,e,t,r,i,n),!0;case"pointerover":var o=n.pointerId;return zo.set(o,Gn(zo.get(o)||null,e,t,r,i,n)),!0;case"gotpointercapture":return o=n.pointerId,Lo.set(o,Gn(Lo.get(o)||null,e,t,r,i,n)),!0}return!1}function ap(e){var t=Ei(e.target);if(t!==null){var r=Ki(t);if(r!==null){if(t=r.tag,t===13){if(t=Xf(r),t!==null){e.blockedOn=t,sp(e.priority,function(){np(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xs(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=su(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var i=new r.constructor(r.type,r);tu=i,r.target.dispatchEvent(i),tu=null}else return t=Zo(r),t!==null&&Ku(t),e.blockedOn=r,!1;t.shift()}return!0}function sh(e,t,r){Xs(e)&&r.delete(t)}function sv(){ou=!1,ii!==null&&Xs(ii)&&(ii=null),ni!==null&&Xs(ni)&&(ni=null),oi!==null&&Xs(oi)&&(oi=null),zo.forEach(sh),Lo.forEach(sh)}function Kn(e,t){e.blockedOn===t&&(e.blockedOn=null,ou||(ou=!0,Ce.unstable_scheduleCallback(Ce.unstable_NormalPriority,sv)))}function Fo(e){function t(n){return Kn(n,e)}if(0<ls.length){Kn(ls[0],e);for(var r=1;r<ls.length;r++){var i=ls[r];i.blockedOn===e&&(i.blockedOn=null)}}for(ii!==null&&Kn(ii,e),ni!==null&&Kn(ni,e),oi!==null&&Kn(oi,e),zo.forEach(t),Lo.forEach(t),r=0;r<Gr.length;r++)i=Gr[r],i.blockedOn===e&&(i.blockedOn=null);for(;0<Gr.length&&(r=Gr[0],r.blockedOn===null);)ap(r),r.blockedOn===null&&Gr.shift()}var Fn=Or.ReactCurrentBatchConfig,ca=!0;function av(e,t,r,i){var n=st,o=Fn.transition;Fn.transition=null;try{st=1,Zu(e,t,r,i)}finally{st=n,Fn.transition=o}}function lv(e,t,r,i){var n=st,o=Fn.transition;Fn.transition=null;try{st=4,Zu(e,t,r,i)}finally{st=n,Fn.transition=o}}function Zu(e,t,r,i){if(ca){var n=su(e,t,r,i);if(n===null)ml(e,t,i,ha,r),oh(e,i);else if(ov(n,e,t,r,i))i.stopPropagation();else if(oh(e,i),t&4&&-1<nv.indexOf(e)){for(;n!==null;){var o=Zo(n);if(o!==null&&ip(o),o=su(e,t,r,i),o===null&&ml(e,t,i,ha,r),o===n)break;n=o}n!==null&&i.stopPropagation()}else ml(e,t,i,null,r)}}var ha=null;function su(e,t,r,i){if(ha=null,e=Xu(i),e=Ei(e),e!==null)if(t=Ki(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Xf(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ha=e,null}function lp(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xd()){case Qu:return 1;case Zf:return 4;case la:case Qd:return 16;case tp:return 536870912;default:return 16}default:return 16}}var ti=null,tc=null,Qs=null;function up(){if(Qs)return Qs;var e,t=tc,r=t.length,i,n="value"in ti?ti.value:ti.textContent,o=n.length;for(e=0;e<r&&t[e]===n[e];e++);var s=r-e;for(i=1;i<=s&&t[r-i]===n[o-i];i++);return Qs=n.slice(e,1<i?1-i:void 0)}function Gs(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function us(){return!0}function ah(){return!1}function be(e){function t(r,i,n,o,s){this._reactName=r,this._targetInst=n,this.type=i,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(r=e[a],this[a]=r?r(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?us:ah,this.isPropagationStopped=ah,this}return xt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=us)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=us)},persist:function(){},isPersistent:us}),t}var Yn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ec=be(Yn),Ko=xt({},Yn,{view:0,detail:0}),uv=be(Ko),il,nl,Zn,Ea=xt({},Ko,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Zn&&(Zn&&e.type==="mousemove"?(il=e.screenX-Zn.screenX,nl=e.screenY-Zn.screenY):nl=il=0,Zn=e),il)},movementY:function(e){return"movementY"in e?e.movementY:nl}}),lh=be(Ea),cv=xt({},Ea,{dataTransfer:0}),hv=be(cv),mv=xt({},Ko,{relatedTarget:0}),ol=be(mv),fv=xt({},Yn,{animationName:0,elapsedTime:0,pseudoElement:0}),pv=be(fv),_v=xt({},Yn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),dv=be(_v),vv=xt({},Yn,{data:0}),uh=be(vv),yv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Av(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=xv[e])?!!t[e]:!1}function rc(){return Av}var wv=xt({},Ko,{key:function(e){if(e.key){var t=yv[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Gs(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?gv[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rc,charCode:function(e){return e.type==="keypress"?Gs(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Gs(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Bv=be(wv),Cv=xt({},Ea,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ch=be(Cv),Sv=xt({},Ko,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rc}),Pv=be(Sv),bv=xt({},Yn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Mv=be(bv),Vv=xt({},Ea,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Tv=be(Vv),kv=[9,13,27,32],ic=Fr&&"CompositionEvent"in window,Ao=null;Fr&&"documentMode"in document&&(Ao=document.documentMode);var Iv=Fr&&"TextEvent"in window&&!Ao,cp=Fr&&(!ic||Ao&&8<Ao&&11>=Ao),hh=" ",mh=!1;function hp(e,t){switch(e){case"keyup":return kv.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mp(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var An=!1;function zv(e,t){switch(e){case"compositionend":return mp(t);case"keypress":return t.which!==32?null:(mh=!0,hh);case"textInput":return e=t.data,e===hh&&mh?null:e;default:return null}}function Lv(e,t){if(An)return e==="compositionend"||!ic&&hp(e,t)?(e=up(),Qs=tc=ti=null,An=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return cp&&t.locale!=="ko"?null:t.data;default:return null}}var Fv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Fv[e.type]:t==="textarea"}function fp(e,t,r,i){jf(i),t=ma(t,"onChange"),0<t.length&&(r=new ec("onChange","change",null,r,i),e.push({event:r,listeners:t}))}var wo=null,Eo=null;function Ev(e){Cp(e,0)}function Na(e){var t=Cn(e);if(Nf(t))return e}function Nv(e,t){if(e==="change")return t}var pp=!1;if(Fr){var sl;if(Fr){var al="oninput"in document;if(!al){var ph=document.createElement("div");ph.setAttribute("oninput","return;"),al=typeof ph.oninput=="function"}sl=al}else sl=!1;pp=sl&&(!document.documentMode||9<document.documentMode)}function _h(){wo&&(wo.detachEvent("onpropertychange",_p),Eo=wo=null)}function _p(e){if(e.propertyName==="value"&&Na(Eo)){var t=[];fp(t,Eo,e,Xu(e)),Jf(Ev,t)}}function Rv(e,t,r){e==="focusin"?(_h(),wo=t,Eo=r,wo.attachEvent("onpropertychange",_p)):e==="focusout"&&_h()}function Dv(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Na(Eo)}function Ov(e,t){if(e==="click")return Na(t)}function qv(e,t){if(e==="input"||e==="change")return Na(t)}function Uv(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ar=typeof Object.is=="function"?Object.is:Uv;function No(e,t){if(ar(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(i=0;i<r.length;i++){var n=r[i];if(!Ul.call(t,n)||!ar(e[n],t[n]))return!1}return!0}function dh(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function vh(e,t){var r=dh(e);e=0;for(var i;r;){if(r.nodeType===3){if(i=e+r.textContent.length,e<=t&&i>=t)return{node:r,offset:t-e};e=i}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=dh(r)}}function dp(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?dp(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function vp(){for(var e=window,t=oa();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=oa(e.document)}return t}function nc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function $v(e){var t=vp(),r=e.focusedElem,i=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&dp(r.ownerDocument.documentElement,r)){if(i!==null&&nc(r)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var n=r.textContent.length,o=Math.min(i.start,n);i=i.end===void 0?o:Math.min(i.end,n),!e.extend&&o>i&&(n=i,i=o,o=n),n=vh(r,o);var s=vh(r,i);n&&s&&(e.rangeCount!==1||e.anchorNode!==n.node||e.anchorOffset!==n.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(n.node,n.offset),e.removeAllRanges(),o>i?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var jv=Fr&&"documentMode"in document&&11>=document.documentMode,wn=null,au=null,Bo=null,lu=!1;function yh(e,t,r){var i=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;lu||wn==null||wn!==oa(i)||(i=wn,"selectionStart"in i&&nc(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Bo&&No(Bo,i)||(Bo=i,i=ma(au,"onSelect"),0<i.length&&(t=new ec("onSelect","select",null,t,r),e.push({event:t,listeners:i}),t.target=wn)))}function cs(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Bn={animationend:cs("Animation","AnimationEnd"),animationiteration:cs("Animation","AnimationIteration"),animationstart:cs("Animation","AnimationStart"),transitionend:cs("Transition","TransitionEnd")},ll={},yp={};Fr&&(yp=document.createElement("div").style,"AnimationEvent"in window||(delete Bn.animationend.animation,delete Bn.animationiteration.animation,delete Bn.animationstart.animation),"TransitionEvent"in window||delete Bn.transitionend.transition);function Ra(e){if(ll[e])return ll[e];if(!Bn[e])return e;var t=Bn[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in yp)return ll[e]=t[r];return e}var gp=Ra("animationend"),xp=Ra("animationiteration"),Ap=Ra("animationstart"),wp=Ra("transitionend"),Bp=new Map,gh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _i(e,t){Bp.set(e,t),Gi(t,[e])}for(var ul=0;ul<gh.length;ul++){var cl=gh[ul],Wv=cl.toLowerCase(),Hv=cl[0].toUpperCase()+cl.slice(1);_i(Wv,"on"+Hv)}_i(gp,"onAnimationEnd");_i(xp,"onAnimationIteration");_i(Ap,"onAnimationStart");_i("dblclick","onDoubleClick");_i("focusin","onFocus");_i("focusout","onBlur");_i(wp,"onTransitionEnd");Rn("onMouseEnter",["mouseout","mouseover"]);Rn("onMouseLeave",["mouseout","mouseover"]);Rn("onPointerEnter",["pointerout","pointerover"]);Rn("onPointerLeave",["pointerout","pointerover"]);Gi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Gi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Gi("onBeforeInput",["compositionend","keypress","textInput","paste"]);Gi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Gi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Gi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Yv=new Set("cancel close invalid load scroll toggle".split(" ").concat(vo));function xh(e,t,r){var i=e.type||"unknown-event";e.currentTarget=r,Wd(i,t,void 0,e),e.currentTarget=null}function Cp(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var i=e[r],n=i.event;i=i.listeners;t:{var o=void 0;if(t)for(var s=i.length-1;0<=s;s--){var a=i[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&n.isPropagationStopped())break t;xh(n,a,c),o=l}else for(s=0;s<i.length;s++){if(a=i[s],l=a.instance,c=a.currentTarget,a=a.listener,l!==o&&n.isPropagationStopped())break t;xh(n,a,c),o=l}}}if(aa)throw e=iu,aa=!1,iu=null,e}function mt(e,t){var r=t[fu];r===void 0&&(r=t[fu]=new Set);var i=e+"__bubble";r.has(i)||(Sp(t,e,2,!1),r.add(i))}function hl(e,t,r){var i=0;t&&(i|=4),Sp(r,e,i,t)}var hs="_reactListening"+Math.random().toString(36).slice(2);function Ro(e){if(!e[hs]){e[hs]=!0,If.forEach(function(r){r!=="selectionchange"&&(Yv.has(r)||hl(r,!1,e),hl(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[hs]||(t[hs]=!0,hl("selectionchange",!1,t))}}function Sp(e,t,r,i){switch(lp(t)){case 1:var n=av;break;case 4:n=lv;break;default:n=Zu}r=n.bind(null,t,r,e),n=void 0,!ru||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(n=!0),i?n!==void 0?e.addEventListener(t,r,{capture:!0,passive:n}):e.addEventListener(t,r,!0):n!==void 0?e.addEventListener(t,r,{passive:n}):e.addEventListener(t,r,!1)}function ml(e,t,r,i,n){var o=i;if(!(t&1)&&!(t&2)&&i!==null)t:for(;;){if(i===null)return;var s=i.tag;if(s===3||s===4){var a=i.stateNode.containerInfo;if(a===n||a.nodeType===8&&a.parentNode===n)break;if(s===4)for(s=i.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===n||l.nodeType===8&&l.parentNode===n))return;s=s.return}for(;a!==null;){if(s=Ei(a),s===null)return;if(l=s.tag,l===5||l===6){i=o=s;continue t}a=a.parentNode}}i=i.return}Jf(function(){var c=o,h=Xu(r),m=[];t:{var f=Bp.get(e);if(f!==void 0){var p=ec,_=e;switch(e){case"keypress":if(Gs(r)===0)break t;case"keydown":case"keyup":p=Bv;break;case"focusin":_="focus",p=ol;break;case"focusout":_="blur",p=ol;break;case"beforeblur":case"afterblur":p=ol;break;case"click":if(r.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=lh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=hv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=Pv;break;case gp:case xp:case Ap:p=pv;break;case wp:p=Mv;break;case"scroll":p=uv;break;case"wheel":p=Tv;break;case"copy":case"cut":case"paste":p=dv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=ch}var d=(t&4)!==0,x=!d&&e==="scroll",v=d?f!==null?f+"Capture":null:f;d=[];for(var y=c,g;y!==null;){g=y;var A=g.stateNode;if(g.tag===5&&A!==null&&(g=A,v!==null&&(A=Io(y,v),A!=null&&d.push(Do(y,A,g)))),x)break;y=y.return}0<d.length&&(f=new p(f,_,null,r,h),m.push({event:f,listeners:d}))}}if(!(t&7)){t:{if(f=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",f&&r!==tu&&(_=r.relatedTarget||r.fromElement)&&(Ei(_)||_[Er]))break t;if((p||f)&&(f=h.window===h?h:(f=h.ownerDocument)?f.defaultView||f.parentWindow:window,p?(_=r.relatedTarget||r.toElement,p=c,_=_?Ei(_):null,_!==null&&(x=Ki(_),_!==x||_.tag!==5&&_.tag!==6)&&(_=null)):(p=null,_=c),p!==_)){if(d=lh,A="onMouseLeave",v="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(d=ch,A="onPointerLeave",v="onPointerEnter",y="pointer"),x=p==null?f:Cn(p),g=_==null?f:Cn(_),f=new d(A,y+"leave",p,r,h),f.target=x,f.relatedTarget=g,A=null,Ei(h)===c&&(d=new d(v,y+"enter",_,r,h),d.target=g,d.relatedTarget=x,A=d),x=A,p&&_)e:{for(d=p,v=_,y=0,g=d;g;g=nn(g))y++;for(g=0,A=v;A;A=nn(A))g++;for(;0<y-g;)d=nn(d),y--;for(;0<g-y;)v=nn(v),g--;for(;y--;){if(d===v||v!==null&&d===v.alternate)break e;d=nn(d),v=nn(v)}d=null}else d=null;p!==null&&Ah(m,f,p,d,!1),_!==null&&x!==null&&Ah(m,x,_,d,!0)}}t:{if(f=c?Cn(c):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var w=Nv;else if(fh(f))if(pp)w=qv;else{w=Dv;var C=Rv}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(w=Ov);if(w&&(w=w(e,c))){fp(m,w,r,h);break t}C&&C(e,f,c),e==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&Xl(f,"number",f.value)}switch(C=c?Cn(c):window,e){case"focusin":(fh(C)||C.contentEditable==="true")&&(wn=C,au=c,Bo=null);break;case"focusout":Bo=au=wn=null;break;case"mousedown":lu=!0;break;case"contextmenu":case"mouseup":case"dragend":lu=!1,yh(m,r,h);break;case"selectionchange":if(jv)break;case"keydown":case"keyup":yh(m,r,h)}var S;if(ic)t:{switch(e){case"compositionstart":var P="onCompositionStart";break t;case"compositionend":P="onCompositionEnd";break t;case"compositionupdate":P="onCompositionUpdate";break t}P=void 0}else An?hp(e,r)&&(P="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(cp&&r.locale!=="ko"&&(An||P!=="onCompositionStart"?P==="onCompositionEnd"&&An&&(S=up()):(ti=h,tc="value"in ti?ti.value:ti.textContent,An=!0)),C=ma(c,P),0<C.length&&(P=new uh(P,e,null,r,h),m.push({event:P,listeners:C}),S?P.data=S:(S=mp(r),S!==null&&(P.data=S)))),(S=Iv?zv(e,r):Lv(e,r))&&(c=ma(c,"onBeforeInput"),0<c.length&&(h=new uh("onBeforeInput","beforeinput",null,r,h),m.push({event:h,listeners:c}),h.data=S))}Cp(m,t)})}function Do(e,t,r){return{instance:e,listener:t,currentTarget:r}}function ma(e,t){for(var r=t+"Capture",i=[];e!==null;){var n=e,o=n.stateNode;n.tag===5&&o!==null&&(n=o,o=Io(e,r),o!=null&&i.unshift(Do(e,o,n)),o=Io(e,t),o!=null&&i.push(Do(e,o,n))),e=e.return}return i}function nn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Ah(e,t,r,i,n){for(var o=t._reactName,s=[];r!==null&&r!==i;){var a=r,l=a.alternate,c=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&c!==null&&(a=c,n?(l=Io(r,o),l!=null&&s.unshift(Do(r,l,a))):n||(l=Io(r,o),l!=null&&s.push(Do(r,l,a)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var Jv=/\r\n?/g,Xv=/\u0000|\uFFFD/g;function wh(e){return(typeof e=="string"?e:""+e).replace(Jv,`
`).replace(Xv,"")}function ms(e,t,r){if(t=wh(t),wh(e)!==t&&r)throw Error(T(425))}function fa(){}var uu=null,cu=null;function hu(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var mu=typeof setTimeout=="function"?setTimeout:void 0,Qv=typeof clearTimeout=="function"?clearTimeout:void 0,Bh=typeof Promise=="function"?Promise:void 0,Gv=typeof queueMicrotask=="function"?queueMicrotask:typeof Bh<"u"?function(e){return Bh.resolve(null).then(e).catch(Kv)}:mu;function Kv(e){setTimeout(function(){throw e})}function fl(e,t){var r=t,i=0;do{var n=r.nextSibling;if(e.removeChild(r),n&&n.nodeType===8)if(r=n.data,r==="/$"){if(i===0){e.removeChild(n),Fo(t);return}i--}else r!=="$"&&r!=="$?"&&r!=="$!"||i++;r=n}while(r);Fo(t)}function si(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Ch(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Jn=Math.random().toString(36).slice(2),yr="__reactFiber$"+Jn,Oo="__reactProps$"+Jn,Er="__reactContainer$"+Jn,fu="__reactEvents$"+Jn,Zv="__reactListeners$"+Jn,ty="__reactHandles$"+Jn;function Ei(e){var t=e[yr];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Er]||r[yr]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Ch(e);e!==null;){if(r=e[yr])return r;e=Ch(e)}return t}e=r,r=e.parentNode}return null}function Zo(e){return e=e[yr]||e[Er],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Cn(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(T(33))}function Da(e){return e[Oo]||null}var pu=[],Sn=-1;function di(e){return{current:e}}function pt(e){0>Sn||(e.current=pu[Sn],pu[Sn]=null,Sn--)}function ct(e,t){Sn++,pu[Sn]=e.current,e.current=t}var mi={},Gt=di(mi),me=di(!1),Wi=mi;function Dn(e,t){var r=e.type.contextTypes;if(!r)return mi;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var n={},o;for(o in r)n[o]=t[o];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=n),n}function fe(e){return e=e.childContextTypes,e!=null}function pa(){pt(me),pt(Gt)}function Sh(e,t,r){if(Gt.current!==mi)throw Error(T(168));ct(Gt,t),ct(me,r)}function Pp(e,t,r){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return r;i=i.getChildContext();for(var n in i)if(!(n in t))throw Error(T(108,Rd(e)||"Unknown",n));return xt({},r,i)}function _a(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||mi,Wi=Gt.current,ct(Gt,e),ct(me,me.current),!0}function Ph(e,t,r){var i=e.stateNode;if(!i)throw Error(T(169));r?(e=Pp(e,t,Wi),i.__reactInternalMemoizedMergedChildContext=e,pt(me),pt(Gt),ct(Gt,e)):pt(me),ct(me,r)}var kr=null,Oa=!1,pl=!1;function bp(e){kr===null?kr=[e]:kr.push(e)}function ey(e){Oa=!0,bp(e)}function vi(){if(!pl&&kr!==null){pl=!0;var e=0,t=st;try{var r=kr;for(st=1;e<r.length;e++){var i=r[e];do i=i(!0);while(i!==null)}kr=null,Oa=!1}catch(n){throw kr!==null&&(kr=kr.slice(e+1)),Kf(Qu,vi),n}finally{st=t,pl=!1}}return null}var Pn=[],bn=0,da=null,va=0,Re=[],De=0,Hi=null,Ir=1,zr="";function Ii(e,t){Pn[bn++]=va,Pn[bn++]=da,da=e,va=t}function Mp(e,t,r){Re[De++]=Ir,Re[De++]=zr,Re[De++]=Hi,Hi=e;var i=Ir;e=zr;var n=32-rr(i)-1;i&=~(1<<n),r+=1;var o=32-rr(t)+n;if(30<o){var s=n-n%5;o=(i&(1<<s)-1).toString(32),i>>=s,n-=s,Ir=1<<32-rr(t)+n|r<<n|i,zr=o+e}else Ir=1<<o|r<<n|i,zr=e}function oc(e){e.return!==null&&(Ii(e,1),Mp(e,1,0))}function sc(e){for(;e===da;)da=Pn[--bn],Pn[bn]=null,va=Pn[--bn],Pn[bn]=null;for(;e===Hi;)Hi=Re[--De],Re[De]=null,zr=Re[--De],Re[De]=null,Ir=Re[--De],Re[De]=null}var Be=null,we=null,dt=!1,Ze=null;function Vp(e,t){var r=Oe(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function bh(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Be=e,we=si(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Be=e,we=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Hi!==null?{id:Ir,overflow:zr}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Oe(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Be=e,we=null,!0):!1;default:return!1}}function _u(e){return(e.mode&1)!==0&&(e.flags&128)===0}function du(e){if(dt){var t=we;if(t){var r=t;if(!bh(e,t)){if(_u(e))throw Error(T(418));t=si(r.nextSibling);var i=Be;t&&bh(e,t)?Vp(i,r):(e.flags=e.flags&-4097|2,dt=!1,Be=e)}}else{if(_u(e))throw Error(T(418));e.flags=e.flags&-4097|2,dt=!1,Be=e}}}function Mh(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Be=e}function fs(e){if(e!==Be)return!1;if(!dt)return Mh(e),dt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!hu(e.type,e.memoizedProps)),t&&(t=we)){if(_u(e))throw Tp(),Error(T(418));for(;t;)Vp(e,t),t=si(t.nextSibling)}if(Mh(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(T(317));t:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){we=si(e.nextSibling);break t}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}we=null}}else we=Be?si(e.stateNode.nextSibling):null;return!0}function Tp(){for(var e=we;e;)e=si(e.nextSibling)}function On(){we=Be=null,dt=!1}function ac(e){Ze===null?Ze=[e]:Ze.push(e)}var ry=Or.ReactCurrentBatchConfig;function to(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(T(309));var i=r.stateNode}if(!i)throw Error(T(147,e));var n=i,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(s){var a=n.refs;s===null?delete a[o]:a[o]=s},t._stringRef=o,t)}if(typeof e!="string")throw Error(T(284));if(!r._owner)throw Error(T(290,e))}return e}function ps(e,t){throw e=Object.prototype.toString.call(t),Error(T(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Vh(e){var t=e._init;return t(e._payload)}function kp(e){function t(v,y){if(e){var g=v.deletions;g===null?(v.deletions=[y],v.flags|=16):g.push(y)}}function r(v,y){if(!e)return null;for(;y!==null;)t(v,y),y=y.sibling;return null}function i(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function n(v,y){return v=ci(v,y),v.index=0,v.sibling=null,v}function o(v,y,g){return v.index=g,e?(g=v.alternate,g!==null?(g=g.index,g<y?(v.flags|=2,y):g):(v.flags|=2,y)):(v.flags|=1048576,y)}function s(v){return e&&v.alternate===null&&(v.flags|=2),v}function a(v,y,g,A){return y===null||y.tag!==6?(y=Al(g,v.mode,A),y.return=v,y):(y=n(y,g),y.return=v,y)}function l(v,y,g,A){var w=g.type;return w===xn?h(v,y,g.props.children,A,g.key):y!==null&&(y.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Jr&&Vh(w)===y.type)?(A=n(y,g.props),A.ref=to(v,y,g),A.return=v,A):(A=na(g.type,g.key,g.props,null,v.mode,A),A.ref=to(v,y,g),A.return=v,A)}function c(v,y,g,A){return y===null||y.tag!==4||y.stateNode.containerInfo!==g.containerInfo||y.stateNode.implementation!==g.implementation?(y=wl(g,v.mode,A),y.return=v,y):(y=n(y,g.children||[]),y.return=v,y)}function h(v,y,g,A,w){return y===null||y.tag!==7?(y=qi(g,v.mode,A,w),y.return=v,y):(y=n(y,g),y.return=v,y)}function m(v,y,g){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Al(""+y,v.mode,g),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case is:return g=na(y.type,y.key,y.props,null,v.mode,g),g.ref=to(v,null,y),g.return=v,g;case gn:return y=wl(y,v.mode,g),y.return=v,y;case Jr:var A=y._init;return m(v,A(y._payload),g)}if(po(y)||Xn(y))return y=qi(y,v.mode,g,null),y.return=v,y;ps(v,y)}return null}function f(v,y,g,A){var w=y!==null?y.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return w!==null?null:a(v,y,""+g,A);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case is:return g.key===w?l(v,y,g,A):null;case gn:return g.key===w?c(v,y,g,A):null;case Jr:return w=g._init,f(v,y,w(g._payload),A)}if(po(g)||Xn(g))return w!==null?null:h(v,y,g,A,null);ps(v,g)}return null}function p(v,y,g,A,w){if(typeof A=="string"&&A!==""||typeof A=="number")return v=v.get(g)||null,a(y,v,""+A,w);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case is:return v=v.get(A.key===null?g:A.key)||null,l(y,v,A,w);case gn:return v=v.get(A.key===null?g:A.key)||null,c(y,v,A,w);case Jr:var C=A._init;return p(v,y,g,C(A._payload),w)}if(po(A)||Xn(A))return v=v.get(g)||null,h(y,v,A,w,null);ps(y,A)}return null}function _(v,y,g,A){for(var w=null,C=null,S=y,P=y=0,F=null;S!==null&&P<g.length;P++){S.index>P?(F=S,S=null):F=S.sibling;var I=f(v,S,g[P],A);if(I===null){S===null&&(S=F);break}e&&S&&I.alternate===null&&t(v,S),y=o(I,y,P),C===null?w=I:C.sibling=I,C=I,S=F}if(P===g.length)return r(v,S),dt&&Ii(v,P),w;if(S===null){for(;P<g.length;P++)S=m(v,g[P],A),S!==null&&(y=o(S,y,P),C===null?w=S:C.sibling=S,C=S);return dt&&Ii(v,P),w}for(S=i(v,S);P<g.length;P++)F=p(S,v,P,g[P],A),F!==null&&(e&&F.alternate!==null&&S.delete(F.key===null?P:F.key),y=o(F,y,P),C===null?w=F:C.sibling=F,C=F);return e&&S.forEach(function(O){return t(v,O)}),dt&&Ii(v,P),w}function d(v,y,g,A){var w=Xn(g);if(typeof w!="function")throw Error(T(150));if(g=w.call(g),g==null)throw Error(T(151));for(var C=w=null,S=y,P=y=0,F=null,I=g.next();S!==null&&!I.done;P++,I=g.next()){S.index>P?(F=S,S=null):F=S.sibling;var O=f(v,S,I.value,A);if(O===null){S===null&&(S=F);break}e&&S&&O.alternate===null&&t(v,S),y=o(O,y,P),C===null?w=O:C.sibling=O,C=O,S=F}if(I.done)return r(v,S),dt&&Ii(v,P),w;if(S===null){for(;!I.done;P++,I=g.next())I=m(v,I.value,A),I!==null&&(y=o(I,y,P),C===null?w=I:C.sibling=I,C=I);return dt&&Ii(v,P),w}for(S=i(v,S);!I.done;P++,I=g.next())I=p(S,v,P,I.value,A),I!==null&&(e&&I.alternate!==null&&S.delete(I.key===null?P:I.key),y=o(I,y,P),C===null?w=I:C.sibling=I,C=I);return e&&S.forEach(function(X){return t(v,X)}),dt&&Ii(v,P),w}function x(v,y,g,A){if(typeof g=="object"&&g!==null&&g.type===xn&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case is:t:{for(var w=g.key,C=y;C!==null;){if(C.key===w){if(w=g.type,w===xn){if(C.tag===7){r(v,C.sibling),y=n(C,g.props.children),y.return=v,v=y;break t}}else if(C.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Jr&&Vh(w)===C.type){r(v,C.sibling),y=n(C,g.props),y.ref=to(v,C,g),y.return=v,v=y;break t}r(v,C);break}else t(v,C);C=C.sibling}g.type===xn?(y=qi(g.props.children,v.mode,A,g.key),y.return=v,v=y):(A=na(g.type,g.key,g.props,null,v.mode,A),A.ref=to(v,y,g),A.return=v,v=A)}return s(v);case gn:t:{for(C=g.key;y!==null;){if(y.key===C)if(y.tag===4&&y.stateNode.containerInfo===g.containerInfo&&y.stateNode.implementation===g.implementation){r(v,y.sibling),y=n(y,g.children||[]),y.return=v,v=y;break t}else{r(v,y);break}else t(v,y);y=y.sibling}y=wl(g,v.mode,A),y.return=v,v=y}return s(v);case Jr:return C=g._init,x(v,y,C(g._payload),A)}if(po(g))return _(v,y,g,A);if(Xn(g))return d(v,y,g,A);ps(v,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,y!==null&&y.tag===6?(r(v,y.sibling),y=n(y,g),y.return=v,v=y):(r(v,y),y=Al(g,v.mode,A),y.return=v,v=y),s(v)):r(v,y)}return x}var qn=kp(!0),Ip=kp(!1),ya=di(null),ga=null,Mn=null,lc=null;function uc(){lc=Mn=ga=null}function cc(e){var t=ya.current;pt(ya),e._currentValue=t}function vu(e,t,r){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===r)break;e=e.return}}function En(e,t){ga=e,lc=Mn=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(he=!0),e.firstContext=null)}function $e(e){var t=e._currentValue;if(lc!==e)if(e={context:e,memoizedValue:t,next:null},Mn===null){if(ga===null)throw Error(T(308));Mn=e,ga.dependencies={lanes:0,firstContext:e}}else Mn=Mn.next=e;return t}var Ni=null;function hc(e){Ni===null?Ni=[e]:Ni.push(e)}function zp(e,t,r,i){var n=t.interleaved;return n===null?(r.next=r,hc(t)):(r.next=n.next,n.next=r),t.interleaved=r,Nr(e,i)}function Nr(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Xr=!1;function mc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Lp(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Lr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ai(e,t,r){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,rt&2){var n=i.pending;return n===null?t.next=t:(t.next=n.next,n.next=t),i.pending=t,Nr(e,r)}return n=i.interleaved,n===null?(t.next=t,hc(i)):(t.next=n.next,n.next=t),i.interleaved=t,Nr(e,r)}function Ks(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,Gu(e,r)}}function Th(e,t){var r=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,r===i)){var n=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?n=o=s:o=o.next=s,r=r.next}while(r!==null);o===null?n=o=t:o=o.next=t}else n=o=t;r={baseState:i.baseState,firstBaseUpdate:n,lastBaseUpdate:o,shared:i.shared,effects:i.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function xa(e,t,r,i){var n=e.updateQueue;Xr=!1;var o=n.firstBaseUpdate,s=n.lastBaseUpdate,a=n.shared.pending;if(a!==null){n.shared.pending=null;var l=a,c=l.next;l.next=null,s===null?o=c:s.next=c,s=l;var h=e.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==s&&(a===null?h.firstBaseUpdate=c:a.next=c,h.lastBaseUpdate=l))}if(o!==null){var m=n.baseState;s=0,h=c=l=null,a=o;do{var f=a.lane,p=a.eventTime;if((i&f)===f){h!==null&&(h=h.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});t:{var _=e,d=a;switch(f=t,p=r,d.tag){case 1:if(_=d.payload,typeof _=="function"){m=_.call(p,m,f);break t}m=_;break t;case 3:_.flags=_.flags&-65537|128;case 0:if(_=d.payload,f=typeof _=="function"?_.call(p,m,f):_,f==null)break t;m=xt({},m,f);break t;case 2:Xr=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,f=n.effects,f===null?n.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(c=h=p,l=m):h=h.next=p,s|=f;if(a=a.next,a===null){if(a=n.shared.pending,a===null)break;f=a,a=f.next,f.next=null,n.lastBaseUpdate=f,n.shared.pending=null}}while(!0);if(h===null&&(l=m),n.baseState=l,n.firstBaseUpdate=c,n.lastBaseUpdate=h,t=n.shared.interleaved,t!==null){n=t;do s|=n.lane,n=n.next;while(n!==t)}else o===null&&(n.shared.lanes=0);Ji|=s,e.lanes=s,e.memoizedState=m}}function kh(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],n=i.callback;if(n!==null){if(i.callback=null,i=r,typeof n!="function")throw Error(T(191,n));n.call(i)}}}var ts={},xr=di(ts),qo=di(ts),Uo=di(ts);function Ri(e){if(e===ts)throw Error(T(174));return e}function fc(e,t){switch(ct(Uo,t),ct(qo,e),ct(xr,ts),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Gl(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Gl(t,e)}pt(xr),ct(xr,t)}function Un(){pt(xr),pt(qo),pt(Uo)}function Fp(e){Ri(Uo.current);var t=Ri(xr.current),r=Gl(t,e.type);t!==r&&(ct(qo,e),ct(xr,r))}function pc(e){qo.current===e&&(pt(xr),pt(qo))}var vt=di(0);function Aa(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var _l=[];function _c(){for(var e=0;e<_l.length;e++)_l[e]._workInProgressVersionPrimary=null;_l.length=0}var Zs=Or.ReactCurrentDispatcher,dl=Or.ReactCurrentBatchConfig,Yi=0,gt=null,Ft=null,Dt=null,wa=!1,Co=!1,$o=0,iy=0;function Yt(){throw Error(T(321))}function dc(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ar(e[r],t[r]))return!1;return!0}function vc(e,t,r,i,n,o){if(Yi=o,gt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Zs.current=e===null||e.memoizedState===null?ay:ly,e=r(i,n),Co){o=0;do{if(Co=!1,$o=0,25<=o)throw Error(T(301));o+=1,Dt=Ft=null,t.updateQueue=null,Zs.current=uy,e=r(i,n)}while(Co)}if(Zs.current=Ba,t=Ft!==null&&Ft.next!==null,Yi=0,Dt=Ft=gt=null,wa=!1,t)throw Error(T(300));return e}function yc(){var e=$o!==0;return $o=0,e}function _r(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dt===null?gt.memoizedState=Dt=e:Dt=Dt.next=e,Dt}function je(){if(Ft===null){var e=gt.alternate;e=e!==null?e.memoizedState:null}else e=Ft.next;var t=Dt===null?gt.memoizedState:Dt.next;if(t!==null)Dt=t,Ft=e;else{if(e===null)throw Error(T(310));Ft=e,e={memoizedState:Ft.memoizedState,baseState:Ft.baseState,baseQueue:Ft.baseQueue,queue:Ft.queue,next:null},Dt===null?gt.memoizedState=Dt=e:Dt=Dt.next=e}return Dt}function jo(e,t){return typeof t=="function"?t(e):t}function vl(e){var t=je(),r=t.queue;if(r===null)throw Error(T(311));r.lastRenderedReducer=e;var i=Ft,n=i.baseQueue,o=r.pending;if(o!==null){if(n!==null){var s=n.next;n.next=o.next,o.next=s}i.baseQueue=n=o,r.pending=null}if(n!==null){o=n.next,i=i.baseState;var a=s=null,l=null,c=o;do{var h=c.lane;if((Yi&h)===h)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:e(i,c.action);else{var m={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=m,s=i):l=l.next=m,gt.lanes|=h,Ji|=h}c=c.next}while(c!==null&&c!==o);l===null?s=i:l.next=a,ar(i,t.memoizedState)||(he=!0),t.memoizedState=i,t.baseState=s,t.baseQueue=l,r.lastRenderedState=i}if(e=r.interleaved,e!==null){n=e;do o=n.lane,gt.lanes|=o,Ji|=o,n=n.next;while(n!==e)}else n===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function yl(e){var t=je(),r=t.queue;if(r===null)throw Error(T(311));r.lastRenderedReducer=e;var i=r.dispatch,n=r.pending,o=t.memoizedState;if(n!==null){r.pending=null;var s=n=n.next;do o=e(o,s.action),s=s.next;while(s!==n);ar(o,t.memoizedState)||(he=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),r.lastRenderedState=o}return[o,i]}function Ep(){}function Np(e,t){var r=gt,i=je(),n=t(),o=!ar(i.memoizedState,n);if(o&&(i.memoizedState=n,he=!0),i=i.queue,gc(Op.bind(null,r,i,e),[e]),i.getSnapshot!==t||o||Dt!==null&&Dt.memoizedState.tag&1){if(r.flags|=2048,Wo(9,Dp.bind(null,r,i,n,t),void 0,null),Ut===null)throw Error(T(349));Yi&30||Rp(r,t,n)}return n}function Rp(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=gt.updateQueue,t===null?(t={lastEffect:null,stores:null},gt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Dp(e,t,r,i){t.value=r,t.getSnapshot=i,qp(t)&&Up(e)}function Op(e,t,r){return r(function(){qp(t)&&Up(e)})}function qp(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ar(e,r)}catch{return!0}}function Up(e){var t=Nr(e,1);t!==null&&ir(t,e,1,-1)}function Ih(e){var t=_r();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:jo,lastRenderedState:e},t.queue=e,e=e.dispatch=sy.bind(null,gt,e),[t.memoizedState,e]}function Wo(e,t,r,i){return e={tag:e,create:t,destroy:r,deps:i,next:null},t=gt.updateQueue,t===null?(t={lastEffect:null,stores:null},gt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(i=r.next,r.next=e,e.next=i,t.lastEffect=e)),e}function $p(){return je().memoizedState}function ta(e,t,r,i){var n=_r();gt.flags|=e,n.memoizedState=Wo(1|t,r,void 0,i===void 0?null:i)}function qa(e,t,r,i){var n=je();i=i===void 0?null:i;var o=void 0;if(Ft!==null){var s=Ft.memoizedState;if(o=s.destroy,i!==null&&dc(i,s.deps)){n.memoizedState=Wo(t,r,o,i);return}}gt.flags|=e,n.memoizedState=Wo(1|t,r,o,i)}function zh(e,t){return ta(8390656,8,e,t)}function gc(e,t){return qa(2048,8,e,t)}function jp(e,t){return qa(4,2,e,t)}function Wp(e,t){return qa(4,4,e,t)}function Hp(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Yp(e,t,r){return r=r!=null?r.concat([e]):null,qa(4,4,Hp.bind(null,t,e),r)}function xc(){}function Jp(e,t){var r=je();t=t===void 0?null:t;var i=r.memoizedState;return i!==null&&t!==null&&dc(t,i[1])?i[0]:(r.memoizedState=[e,t],e)}function Xp(e,t){var r=je();t=t===void 0?null:t;var i=r.memoizedState;return i!==null&&t!==null&&dc(t,i[1])?i[0]:(e=e(),r.memoizedState=[e,t],e)}function Qp(e,t,r){return Yi&21?(ar(r,t)||(r=ep(),gt.lanes|=r,Ji|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,he=!0),e.memoizedState=r)}function ny(e,t){var r=st;st=r!==0&&4>r?r:4,e(!0);var i=dl.transition;dl.transition={};try{e(!1),t()}finally{st=r,dl.transition=i}}function Gp(){return je().memoizedState}function oy(e,t,r){var i=ui(e);if(r={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null},Kp(e))Zp(t,r);else if(r=zp(e,t,r,i),r!==null){var n=re();ir(r,e,i,n),t_(r,t,i)}}function sy(e,t,r){var i=ui(e),n={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null};if(Kp(e))Zp(t,n);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var s=t.lastRenderedState,a=o(s,r);if(n.hasEagerState=!0,n.eagerState=a,ar(a,s)){var l=t.interleaved;l===null?(n.next=n,hc(t)):(n.next=l.next,l.next=n),t.interleaved=n;return}}catch{}finally{}r=zp(e,t,n,i),r!==null&&(n=re(),ir(r,e,i,n),t_(r,t,i))}}function Kp(e){var t=e.alternate;return e===gt||t!==null&&t===gt}function Zp(e,t){Co=wa=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function t_(e,t,r){if(r&4194240){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,Gu(e,r)}}var Ba={readContext:$e,useCallback:Yt,useContext:Yt,useEffect:Yt,useImperativeHandle:Yt,useInsertionEffect:Yt,useLayoutEffect:Yt,useMemo:Yt,useReducer:Yt,useRef:Yt,useState:Yt,useDebugValue:Yt,useDeferredValue:Yt,useTransition:Yt,useMutableSource:Yt,useSyncExternalStore:Yt,useId:Yt,unstable_isNewReconciler:!1},ay={readContext:$e,useCallback:function(e,t){return _r().memoizedState=[e,t===void 0?null:t],e},useContext:$e,useEffect:zh,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,ta(4194308,4,Hp.bind(null,t,e),r)},useLayoutEffect:function(e,t){return ta(4194308,4,e,t)},useInsertionEffect:function(e,t){return ta(4,2,e,t)},useMemo:function(e,t){var r=_r();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var i=_r();return t=r!==void 0?r(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=oy.bind(null,gt,e),[i.memoizedState,e]},useRef:function(e){var t=_r();return e={current:e},t.memoizedState=e},useState:Ih,useDebugValue:xc,useDeferredValue:function(e){return _r().memoizedState=e},useTransition:function(){var e=Ih(!1),t=e[0];return e=ny.bind(null,e[1]),_r().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var i=gt,n=_r();if(dt){if(r===void 0)throw Error(T(407));r=r()}else{if(r=t(),Ut===null)throw Error(T(349));Yi&30||Rp(i,t,r)}n.memoizedState=r;var o={value:r,getSnapshot:t};return n.queue=o,zh(Op.bind(null,i,o,e),[e]),i.flags|=2048,Wo(9,Dp.bind(null,i,o,r,t),void 0,null),r},useId:function(){var e=_r(),t=Ut.identifierPrefix;if(dt){var r=zr,i=Ir;r=(i&~(1<<32-rr(i)-1)).toString(32)+r,t=":"+t+"R"+r,r=$o++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=iy++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ly={readContext:$e,useCallback:Jp,useContext:$e,useEffect:gc,useImperativeHandle:Yp,useInsertionEffect:jp,useLayoutEffect:Wp,useMemo:Xp,useReducer:vl,useRef:$p,useState:function(){return vl(jo)},useDebugValue:xc,useDeferredValue:function(e){var t=je();return Qp(t,Ft.memoizedState,e)},useTransition:function(){var e=vl(jo)[0],t=je().memoizedState;return[e,t]},useMutableSource:Ep,useSyncExternalStore:Np,useId:Gp,unstable_isNewReconciler:!1},uy={readContext:$e,useCallback:Jp,useContext:$e,useEffect:gc,useImperativeHandle:Yp,useInsertionEffect:jp,useLayoutEffect:Wp,useMemo:Xp,useReducer:yl,useRef:$p,useState:function(){return yl(jo)},useDebugValue:xc,useDeferredValue:function(e){var t=je();return Ft===null?t.memoizedState=e:Qp(t,Ft.memoizedState,e)},useTransition:function(){var e=yl(jo)[0],t=je().memoizedState;return[e,t]},useMutableSource:Ep,useSyncExternalStore:Np,useId:Gp,unstable_isNewReconciler:!1};function Ge(e,t){if(e&&e.defaultProps){t=xt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function yu(e,t,r,i){t=e.memoizedState,r=r(i,t),r=r==null?t:xt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Ua={isMounted:function(e){return(e=e._reactInternals)?Ki(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var i=re(),n=ui(e),o=Lr(i,n);o.payload=t,r!=null&&(o.callback=r),t=ai(e,o,n),t!==null&&(ir(t,e,n,i),Ks(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var i=re(),n=ui(e),o=Lr(i,n);o.tag=1,o.payload=t,r!=null&&(o.callback=r),t=ai(e,o,n),t!==null&&(ir(t,e,n,i),Ks(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=re(),i=ui(e),n=Lr(r,i);n.tag=2,t!=null&&(n.callback=t),t=ai(e,n,i),t!==null&&(ir(t,e,i,r),Ks(t,e,i))}};function Lh(e,t,r,i,n,o,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,o,s):t.prototype&&t.prototype.isPureReactComponent?!No(r,i)||!No(n,o):!0}function e_(e,t,r){var i=!1,n=mi,o=t.contextType;return typeof o=="object"&&o!==null?o=$e(o):(n=fe(t)?Wi:Gt.current,i=t.contextTypes,o=(i=i!=null)?Dn(e,n):mi),t=new t(r,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Ua,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=o),t}function Fh(e,t,r,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,i),t.state!==e&&Ua.enqueueReplaceState(t,t.state,null)}function gu(e,t,r,i){var n=e.stateNode;n.props=r,n.state=e.memoizedState,n.refs={},mc(e);var o=t.contextType;typeof o=="object"&&o!==null?n.context=$e(o):(o=fe(t)?Wi:Gt.current,n.context=Dn(e,o)),n.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(yu(e,t,o,r),n.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(t=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),t!==n.state&&Ua.enqueueReplaceState(n,n.state,null),xa(e,r,n,i),n.state=e.memoizedState),typeof n.componentDidMount=="function"&&(e.flags|=4194308)}function $n(e,t){try{var r="",i=t;do r+=Nd(i),i=i.return;while(i);var n=r}catch(o){n=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:n,digest:null}}function gl(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function xu(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var cy=typeof WeakMap=="function"?WeakMap:Map;function r_(e,t,r){r=Lr(-1,r),r.tag=3,r.payload={element:null};var i=t.value;return r.callback=function(){Sa||(Sa=!0,Tu=i),xu(e,t)},r}function i_(e,t,r){r=Lr(-1,r),r.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var n=t.value;r.payload=function(){return i(n)},r.callback=function(){xu(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){xu(e,t),typeof i!="function"&&(li===null?li=new Set([this]):li.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function Eh(e,t,r){var i=e.pingCache;if(i===null){i=e.pingCache=new cy;var n=new Set;i.set(t,n)}else n=i.get(t),n===void 0&&(n=new Set,i.set(t,n));n.has(r)||(n.add(r),e=Cy.bind(null,e,t,r),t.then(e,e))}function Nh(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Rh(e,t,r,i,n){return e.mode&1?(e.flags|=65536,e.lanes=n,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Lr(-1,1),t.tag=2,ai(r,t,1))),r.lanes|=1),e)}var hy=Or.ReactCurrentOwner,he=!1;function ee(e,t,r,i){t.child=e===null?Ip(t,null,r,i):qn(t,e.child,r,i)}function Dh(e,t,r,i,n){r=r.render;var o=t.ref;return En(t,n),i=vc(e,t,r,i,o,n),r=yc(),e!==null&&!he?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Rr(e,t,n)):(dt&&r&&oc(t),t.flags|=1,ee(e,t,i,n),t.child)}function Oh(e,t,r,i,n){if(e===null){var o=r.type;return typeof o=="function"&&!Mc(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=o,n_(e,t,o,i,n)):(e=na(r.type,null,i,t,t.mode,n),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&n)){var s=o.memoizedProps;if(r=r.compare,r=r!==null?r:No,r(s,i)&&e.ref===t.ref)return Rr(e,t,n)}return t.flags|=1,e=ci(o,i),e.ref=t.ref,e.return=t,t.child=e}function n_(e,t,r,i,n){if(e!==null){var o=e.memoizedProps;if(No(o,i)&&e.ref===t.ref)if(he=!1,t.pendingProps=i=o,(e.lanes&n)!==0)e.flags&131072&&(he=!0);else return t.lanes=e.lanes,Rr(e,t,n)}return Au(e,t,r,i,n)}function o_(e,t,r){var i=t.pendingProps,n=i.children,o=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ct(Tn,xe),xe|=r;else{if(!(r&1073741824))return e=o!==null?o.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ct(Tn,xe),xe|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=o!==null?o.baseLanes:r,ct(Tn,xe),xe|=i}else o!==null?(i=o.baseLanes|r,t.memoizedState=null):i=r,ct(Tn,xe),xe|=i;return ee(e,t,n,r),t.child}function s_(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Au(e,t,r,i,n){var o=fe(r)?Wi:Gt.current;return o=Dn(t,o),En(t,n),r=vc(e,t,r,i,o,n),i=yc(),e!==null&&!he?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Rr(e,t,n)):(dt&&i&&oc(t),t.flags|=1,ee(e,t,r,n),t.child)}function qh(e,t,r,i,n){if(fe(r)){var o=!0;_a(t)}else o=!1;if(En(t,n),t.stateNode===null)ea(e,t),e_(t,r,i),gu(t,r,i,n),i=!0;else if(e===null){var s=t.stateNode,a=t.memoizedProps;s.props=a;var l=s.context,c=r.contextType;typeof c=="object"&&c!==null?c=$e(c):(c=fe(r)?Wi:Gt.current,c=Dn(t,c));var h=r.getDerivedStateFromProps,m=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function";m||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==i||l!==c)&&Fh(t,s,i,c),Xr=!1;var f=t.memoizedState;s.state=f,xa(t,i,s,n),l=t.memoizedState,a!==i||f!==l||me.current||Xr?(typeof h=="function"&&(yu(t,r,h,i),l=t.memoizedState),(a=Xr||Lh(t,r,a,i,f,l,c))?(m||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),s.props=i,s.state=l,s.context=c,i=a):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{s=t.stateNode,Lp(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:Ge(t.type,a),s.props=c,m=t.pendingProps,f=s.context,l=r.contextType,typeof l=="object"&&l!==null?l=$e(l):(l=fe(r)?Wi:Gt.current,l=Dn(t,l));var p=r.getDerivedStateFromProps;(h=typeof p=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==m||f!==l)&&Fh(t,s,i,l),Xr=!1,f=t.memoizedState,s.state=f,xa(t,i,s,n);var _=t.memoizedState;a!==m||f!==_||me.current||Xr?(typeof p=="function"&&(yu(t,r,p,i),_=t.memoizedState),(c=Xr||Lh(t,r,c,i,f,_,l)||!1)?(h||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(i,_,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(i,_,l)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=_),s.props=i,s.state=_,s.context=l,i=c):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),i=!1)}return wu(e,t,r,i,o,n)}function wu(e,t,r,i,n,o){s_(e,t);var s=(t.flags&128)!==0;if(!i&&!s)return n&&Ph(t,r,!1),Rr(e,t,o);i=t.stateNode,hy.current=t;var a=s&&typeof r.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&s?(t.child=qn(t,e.child,null,o),t.child=qn(t,null,a,o)):ee(e,t,a,o),t.memoizedState=i.state,n&&Ph(t,r,!0),t.child}function a_(e){var t=e.stateNode;t.pendingContext?Sh(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Sh(e,t.context,!1),fc(e,t.containerInfo)}function Uh(e,t,r,i,n){return On(),ac(n),t.flags|=256,ee(e,t,r,i),t.child}var Bu={dehydrated:null,treeContext:null,retryLane:0};function Cu(e){return{baseLanes:e,cachePool:null,transitions:null}}function l_(e,t,r){var i=t.pendingProps,n=vt.current,o=!1,s=(t.flags&128)!==0,a;if((a=s)||(a=e!==null&&e.memoizedState===null?!1:(n&2)!==0),a?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(n|=1),ct(vt,n&1),e===null)return du(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=i.children,e=i.fallback,o?(i=t.mode,o=t.child,s={mode:"hidden",children:s},!(i&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=Wa(s,i,0,null),e=qi(e,i,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Cu(r),t.memoizedState=Bu,e):Ac(t,s));if(n=e.memoizedState,n!==null&&(a=n.dehydrated,a!==null))return my(e,t,s,i,a,n,r);if(o){o=i.fallback,s=t.mode,n=e.child,a=n.sibling;var l={mode:"hidden",children:i.children};return!(s&1)&&t.child!==n?(i=t.child,i.childLanes=0,i.pendingProps=l,t.deletions=null):(i=ci(n,l),i.subtreeFlags=n.subtreeFlags&14680064),a!==null?o=ci(a,o):(o=qi(o,s,r,null),o.flags|=2),o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,s=e.child.memoizedState,s=s===null?Cu(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=e.childLanes&~r,t.memoizedState=Bu,i}return o=e.child,e=o.sibling,i=ci(o,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=r),i.return=t,i.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=i,t.memoizedState=null,i}function Ac(e,t){return t=Wa({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function _s(e,t,r,i){return i!==null&&ac(i),qn(t,e.child,null,r),e=Ac(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function my(e,t,r,i,n,o,s){if(r)return t.flags&256?(t.flags&=-257,i=gl(Error(T(422))),_s(e,t,s,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=i.fallback,n=t.mode,i=Wa({mode:"visible",children:i.children},n,0,null),o=qi(o,n,s,null),o.flags|=2,i.return=t,o.return=t,i.sibling=o,t.child=i,t.mode&1&&qn(t,e.child,null,s),t.child.memoizedState=Cu(s),t.memoizedState=Bu,o);if(!(t.mode&1))return _s(e,t,s,null);if(n.data==="$!"){if(i=n.nextSibling&&n.nextSibling.dataset,i)var a=i.dgst;return i=a,o=Error(T(419)),i=gl(o,i,void 0),_s(e,t,s,i)}if(a=(s&e.childLanes)!==0,he||a){if(i=Ut,i!==null){switch(s&-s){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(i.suspendedLanes|s)?0:n,n!==0&&n!==o.retryLane&&(o.retryLane=n,Nr(e,n),ir(i,e,n,-1))}return bc(),i=gl(Error(T(421))),_s(e,t,s,i)}return n.data==="$?"?(t.flags|=128,t.child=e.child,t=Sy.bind(null,e),n._reactRetry=t,null):(e=o.treeContext,we=si(n.nextSibling),Be=t,dt=!0,Ze=null,e!==null&&(Re[De++]=Ir,Re[De++]=zr,Re[De++]=Hi,Ir=e.id,zr=e.overflow,Hi=t),t=Ac(t,i.children),t.flags|=4096,t)}function $h(e,t,r){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),vu(e.return,t,r)}function xl(e,t,r,i,n){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:r,tailMode:n}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=r,o.tailMode=n)}function u_(e,t,r){var i=t.pendingProps,n=i.revealOrder,o=i.tail;if(ee(e,t,i.children,r),i=vt.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)t:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&$h(e,r,t);else if(e.tag===19)$h(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break t;for(;e.sibling===null;){if(e.return===null||e.return===t)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(ct(vt,i),!(t.mode&1))t.memoizedState=null;else switch(n){case"forwards":for(r=t.child,n=null;r!==null;)e=r.alternate,e!==null&&Aa(e)===null&&(n=r),r=r.sibling;r=n,r===null?(n=t.child,t.child=null):(n=r.sibling,r.sibling=null),xl(t,!1,n,r,o);break;case"backwards":for(r=null,n=t.child,t.child=null;n!==null;){if(e=n.alternate,e!==null&&Aa(e)===null){t.child=n;break}e=n.sibling,n.sibling=r,r=n,n=e}xl(t,!0,r,null,o);break;case"together":xl(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ea(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Rr(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ji|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(T(153));if(t.child!==null){for(e=t.child,r=ci(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ci(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function fy(e,t,r){switch(t.tag){case 3:a_(t),On();break;case 5:Fp(t);break;case 1:fe(t.type)&&_a(t);break;case 4:fc(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,n=t.memoizedProps.value;ct(ya,i._currentValue),i._currentValue=n;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(ct(vt,vt.current&1),t.flags|=128,null):r&t.child.childLanes?l_(e,t,r):(ct(vt,vt.current&1),e=Rr(e,t,r),e!==null?e.sibling:null);ct(vt,vt.current&1);break;case 19:if(i=(r&t.childLanes)!==0,e.flags&128){if(i)return u_(e,t,r);t.flags|=128}if(n=t.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),ct(vt,vt.current),i)break;return null;case 22:case 23:return t.lanes=0,o_(e,t,r)}return Rr(e,t,r)}var c_,Su,h_,m_;c_=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Su=function(){};h_=function(e,t,r,i){var n=e.memoizedProps;if(n!==i){e=t.stateNode,Ri(xr.current);var o=null;switch(r){case"input":n=Yl(e,n),i=Yl(e,i),o=[];break;case"select":n=xt({},n,{value:void 0}),i=xt({},i,{value:void 0}),o=[];break;case"textarea":n=Ql(e,n),i=Ql(e,i),o=[];break;default:typeof n.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=fa)}Kl(r,i);var s;r=null;for(c in n)if(!i.hasOwnProperty(c)&&n.hasOwnProperty(c)&&n[c]!=null)if(c==="style"){var a=n[c];for(s in a)a.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(To.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in i){var l=i[c];if(a=n!=null?n[c]:void 0,i.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(r||(r={}),r[s]=l[s])}else r||(o||(o=[]),o.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(To.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&mt("scroll",e),o||a===l||(o=[])):(o=o||[]).push(c,l))}r&&(o=o||[]).push("style",r);var c=o;(t.updateQueue=c)&&(t.flags|=4)}};m_=function(e,t,r,i){r!==i&&(t.flags|=4)};function eo(e,t){if(!dt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var i=null;r!==null;)r.alternate!==null&&(i=r),r=r.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Jt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,i=0;if(t)for(var n=e.child;n!==null;)r|=n.lanes|n.childLanes,i|=n.subtreeFlags&14680064,i|=n.flags&14680064,n.return=e,n=n.sibling;else for(n=e.child;n!==null;)r|=n.lanes|n.childLanes,i|=n.subtreeFlags,i|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=i,e.childLanes=r,t}function py(e,t,r){var i=t.pendingProps;switch(sc(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jt(t),null;case 1:return fe(t.type)&&pa(),Jt(t),null;case 3:return i=t.stateNode,Un(),pt(me),pt(Gt),_c(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(fs(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ze!==null&&(zu(Ze),Ze=null))),Su(e,t),Jt(t),null;case 5:pc(t);var n=Ri(Uo.current);if(r=t.type,e!==null&&t.stateNode!=null)h_(e,t,r,i,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(T(166));return Jt(t),null}if(e=Ri(xr.current),fs(t)){i=t.stateNode,r=t.type;var o=t.memoizedProps;switch(i[yr]=t,i[Oo]=o,e=(t.mode&1)!==0,r){case"dialog":mt("cancel",i),mt("close",i);break;case"iframe":case"object":case"embed":mt("load",i);break;case"video":case"audio":for(n=0;n<vo.length;n++)mt(vo[n],i);break;case"source":mt("error",i);break;case"img":case"image":case"link":mt("error",i),mt("load",i);break;case"details":mt("toggle",i);break;case"input":Kc(i,o),mt("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},mt("invalid",i);break;case"textarea":th(i,o),mt("invalid",i)}Kl(r,o),n=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?i.textContent!==a&&(o.suppressHydrationWarning!==!0&&ms(i.textContent,a,e),n=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&ms(i.textContent,a,e),n=["children",""+a]):To.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&mt("scroll",i)}switch(r){case"input":ns(i),Zc(i,o,!0);break;case"textarea":ns(i),eh(i);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(i.onclick=fa)}i=n,t.updateQueue=i,i!==null&&(t.flags|=4)}else{s=n.nodeType===9?n:n.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Of(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=s.createElement(r,{is:i.is}):(e=s.createElement(r),r==="select"&&(s=e,i.multiple?s.multiple=!0:i.size&&(s.size=i.size))):e=s.createElementNS(e,r),e[yr]=t,e[Oo]=i,c_(e,t,!1,!1),t.stateNode=e;t:{switch(s=Zl(r,i),r){case"dialog":mt("cancel",e),mt("close",e),n=i;break;case"iframe":case"object":case"embed":mt("load",e),n=i;break;case"video":case"audio":for(n=0;n<vo.length;n++)mt(vo[n],e);n=i;break;case"source":mt("error",e),n=i;break;case"img":case"image":case"link":mt("error",e),mt("load",e),n=i;break;case"details":mt("toggle",e),n=i;break;case"input":Kc(e,i),n=Yl(e,i),mt("invalid",e);break;case"option":n=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},n=xt({},i,{value:void 0}),mt("invalid",e);break;case"textarea":th(e,i),n=Ql(e,i),mt("invalid",e);break;default:n=i}Kl(r,n),a=n;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?$f(e,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&qf(e,l)):o==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&ko(e,l):typeof l=="number"&&ko(e,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(To.hasOwnProperty(o)?l!=null&&o==="onScroll"&&mt("scroll",e):l!=null&&Wu(e,o,l,s))}switch(r){case"input":ns(e),Zc(e,i,!1);break;case"textarea":ns(e),eh(e);break;case"option":i.value!=null&&e.setAttribute("value",""+hi(i.value));break;case"select":e.multiple=!!i.multiple,o=i.value,o!=null?In(e,!!i.multiple,o,!1):i.defaultValue!=null&&In(e,!!i.multiple,i.defaultValue,!0);break;default:typeof n.onClick=="function"&&(e.onclick=fa)}switch(r){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break t;case"img":i=!0;break t;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Jt(t),null;case 6:if(e&&t.stateNode!=null)m_(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(T(166));if(r=Ri(Uo.current),Ri(xr.current),fs(t)){if(i=t.stateNode,r=t.memoizedProps,i[yr]=t,(o=i.nodeValue!==r)&&(e=Be,e!==null))switch(e.tag){case 3:ms(i.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ms(i.nodeValue,r,(e.mode&1)!==0)}o&&(t.flags|=4)}else i=(r.nodeType===9?r:r.ownerDocument).createTextNode(i),i[yr]=t,t.stateNode=i}return Jt(t),null;case 13:if(pt(vt),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(dt&&we!==null&&t.mode&1&&!(t.flags&128))Tp(),On(),t.flags|=98560,o=!1;else if(o=fs(t),i!==null&&i.dehydrated!==null){if(e===null){if(!o)throw Error(T(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(T(317));o[yr]=t}else On(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Jt(t),o=!1}else Ze!==null&&(zu(Ze),Ze=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||vt.current&1?Et===0&&(Et=3):bc())),t.updateQueue!==null&&(t.flags|=4),Jt(t),null);case 4:return Un(),Su(e,t),e===null&&Ro(t.stateNode.containerInfo),Jt(t),null;case 10:return cc(t.type._context),Jt(t),null;case 17:return fe(t.type)&&pa(),Jt(t),null;case 19:if(pt(vt),o=t.memoizedState,o===null)return Jt(t),null;if(i=(t.flags&128)!==0,s=o.rendering,s===null)if(i)eo(o,!1);else{if(Et!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=Aa(e),s!==null){for(t.flags|=128,eo(o,!1),i=s.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=r,r=t.child;r!==null;)o=r,e=i,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,e=s.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ct(vt,vt.current&1|2),t.child}e=e.sibling}o.tail!==null&&St()>jn&&(t.flags|=128,i=!0,eo(o,!1),t.lanes=4194304)}else{if(!i)if(e=Aa(s),e!==null){if(t.flags|=128,i=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),eo(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!dt)return Jt(t),null}else 2*St()-o.renderingStartTime>jn&&r!==1073741824&&(t.flags|=128,i=!0,eo(o,!1),t.lanes=4194304);o.isBackwards?(s.sibling=t.child,t.child=s):(r=o.last,r!==null?r.sibling=s:t.child=s,o.last=s)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=St(),t.sibling=null,r=vt.current,ct(vt,i?r&1|2:r&1),t):(Jt(t),null);case 22:case 23:return Pc(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?xe&1073741824&&(Jt(t),t.subtreeFlags&6&&(t.flags|=8192)):Jt(t),null;case 24:return null;case 25:return null}throw Error(T(156,t.tag))}function _y(e,t){switch(sc(t),t.tag){case 1:return fe(t.type)&&pa(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Un(),pt(me),pt(Gt),_c(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return pc(t),null;case 13:if(pt(vt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(T(340));On()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return pt(vt),null;case 4:return Un(),null;case 10:return cc(t.type._context),null;case 22:case 23:return Pc(),null;case 24:return null;default:return null}}var ds=!1,Xt=!1,dy=typeof WeakSet=="function"?WeakSet:Set,E=null;function Vn(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(i){Ct(e,t,i)}else r.current=null}function Pu(e,t,r){try{r()}catch(i){Ct(e,t,i)}}var jh=!1;function vy(e,t){if(uu=ca,e=vp(),nc(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else t:{r=(r=e.ownerDocument)&&r.defaultView||window;var i=r.getSelection&&r.getSelection();if(i&&i.rangeCount!==0){r=i.anchorNode;var n=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break t}var s=0,a=-1,l=-1,c=0,h=0,m=e,f=null;e:for(;;){for(var p;m!==r||n!==0&&m.nodeType!==3||(a=s+n),m!==o||i!==0&&m.nodeType!==3||(l=s+i),m.nodeType===3&&(s+=m.nodeValue.length),(p=m.firstChild)!==null;)f=m,m=p;for(;;){if(m===e)break e;if(f===r&&++c===n&&(a=s),f===o&&++h===i&&(l=s),(p=m.nextSibling)!==null)break;m=f,f=m.parentNode}m=p}r=a===-1||l===-1?null:{start:a,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(cu={focusedElem:e,selectionRange:r},ca=!1,E=t;E!==null;)if(t=E,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,E=e;else for(;E!==null;){t=E;try{var _=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var d=_.memoizedProps,x=_.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?d:Ge(t.type,d),x);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var g=t.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(T(163))}}catch(A){Ct(t,t.return,A)}if(e=t.sibling,e!==null){e.return=t.return,E=e;break}E=t.return}return _=jh,jh=!1,_}function So(e,t,r){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var n=i=i.next;do{if((n.tag&e)===e){var o=n.destroy;n.destroy=void 0,o!==void 0&&Pu(t,r,o)}n=n.next}while(n!==i)}}function $a(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var i=r.create;r.destroy=i()}r=r.next}while(r!==t)}}function bu(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function f_(e){var t=e.alternate;t!==null&&(e.alternate=null,f_(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[yr],delete t[Oo],delete t[fu],delete t[Zv],delete t[ty])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function p_(e){return e.tag===5||e.tag===3||e.tag===4}function Wh(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||p_(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Mu(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=fa));else if(i!==4&&(e=e.child,e!==null))for(Mu(e,t,r),e=e.sibling;e!==null;)Mu(e,t,r),e=e.sibling}function Vu(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(Vu(e,t,r),e=e.sibling;e!==null;)Vu(e,t,r),e=e.sibling}var jt=null,Ke=!1;function qr(e,t,r){for(r=r.child;r!==null;)__(e,t,r),r=r.sibling}function __(e,t,r){if(gr&&typeof gr.onCommitFiberUnmount=="function")try{gr.onCommitFiberUnmount(Fa,r)}catch{}switch(r.tag){case 5:Xt||Vn(r,t);case 6:var i=jt,n=Ke;jt=null,qr(e,t,r),jt=i,Ke=n,jt!==null&&(Ke?(e=jt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):jt.removeChild(r.stateNode));break;case 18:jt!==null&&(Ke?(e=jt,r=r.stateNode,e.nodeType===8?fl(e.parentNode,r):e.nodeType===1&&fl(e,r),Fo(e)):fl(jt,r.stateNode));break;case 4:i=jt,n=Ke,jt=r.stateNode.containerInfo,Ke=!0,qr(e,t,r),jt=i,Ke=n;break;case 0:case 11:case 14:case 15:if(!Xt&&(i=r.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){n=i=i.next;do{var o=n,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Pu(r,t,s),n=n.next}while(n!==i)}qr(e,t,r);break;case 1:if(!Xt&&(Vn(r,t),i=r.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=r.memoizedProps,i.state=r.memoizedState,i.componentWillUnmount()}catch(a){Ct(r,t,a)}qr(e,t,r);break;case 21:qr(e,t,r);break;case 22:r.mode&1?(Xt=(i=Xt)||r.memoizedState!==null,qr(e,t,r),Xt=i):qr(e,t,r);break;default:qr(e,t,r)}}function Hh(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new dy),t.forEach(function(i){var n=Py.bind(null,e,i);r.has(i)||(r.add(i),i.then(n,n))})}}function He(e,t){var r=t.deletions;if(r!==null)for(var i=0;i<r.length;i++){var n=r[i];try{var o=e,s=t,a=s;t:for(;a!==null;){switch(a.tag){case 5:jt=a.stateNode,Ke=!1;break t;case 3:jt=a.stateNode.containerInfo,Ke=!0;break t;case 4:jt=a.stateNode.containerInfo,Ke=!0;break t}a=a.return}if(jt===null)throw Error(T(160));__(o,s,n),jt=null,Ke=!1;var l=n.alternate;l!==null&&(l.return=null),n.return=null}catch(c){Ct(n,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)d_(t,e),t=t.sibling}function d_(e,t){var r=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(He(t,e),ur(e),i&4){try{So(3,e,e.return),$a(3,e)}catch(d){Ct(e,e.return,d)}try{So(5,e,e.return)}catch(d){Ct(e,e.return,d)}}break;case 1:He(t,e),ur(e),i&512&&r!==null&&Vn(r,r.return);break;case 5:if(He(t,e),ur(e),i&512&&r!==null&&Vn(r,r.return),e.flags&32){var n=e.stateNode;try{ko(n,"")}catch(d){Ct(e,e.return,d)}}if(i&4&&(n=e.stateNode,n!=null)){var o=e.memoizedProps,s=r!==null?r.memoizedProps:o,a=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&Rf(n,o),Zl(a,s);var c=Zl(a,o);for(s=0;s<l.length;s+=2){var h=l[s],m=l[s+1];h==="style"?$f(n,m):h==="dangerouslySetInnerHTML"?qf(n,m):h==="children"?ko(n,m):Wu(n,h,m,c)}switch(a){case"input":Jl(n,o);break;case"textarea":Df(n,o);break;case"select":var f=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!o.multiple;var p=o.value;p!=null?In(n,!!o.multiple,p,!1):f!==!!o.multiple&&(o.defaultValue!=null?In(n,!!o.multiple,o.defaultValue,!0):In(n,!!o.multiple,o.multiple?[]:"",!1))}n[Oo]=o}catch(d){Ct(e,e.return,d)}}break;case 6:if(He(t,e),ur(e),i&4){if(e.stateNode===null)throw Error(T(162));n=e.stateNode,o=e.memoizedProps;try{n.nodeValue=o}catch(d){Ct(e,e.return,d)}}break;case 3:if(He(t,e),ur(e),i&4&&r!==null&&r.memoizedState.isDehydrated)try{Fo(t.containerInfo)}catch(d){Ct(e,e.return,d)}break;case 4:He(t,e),ur(e);break;case 13:He(t,e),ur(e),n=e.child,n.flags&8192&&(o=n.memoizedState!==null,n.stateNode.isHidden=o,!o||n.alternate!==null&&n.alternate.memoizedState!==null||(Cc=St())),i&4&&Hh(e);break;case 22:if(h=r!==null&&r.memoizedState!==null,e.mode&1?(Xt=(c=Xt)||h,He(t,e),Xt=c):He(t,e),ur(e),i&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!h&&e.mode&1)for(E=e,h=e.child;h!==null;){for(m=E=h;E!==null;){switch(f=E,p=f.child,f.tag){case 0:case 11:case 14:case 15:So(4,f,f.return);break;case 1:Vn(f,f.return);var _=f.stateNode;if(typeof _.componentWillUnmount=="function"){i=f,r=f.return;try{t=i,_.props=t.memoizedProps,_.state=t.memoizedState,_.componentWillUnmount()}catch(d){Ct(i,r,d)}}break;case 5:Vn(f,f.return);break;case 22:if(f.memoizedState!==null){Jh(m);continue}}p!==null?(p.return=f,E=p):Jh(m)}h=h.sibling}t:for(h=null,m=e;;){if(m.tag===5){if(h===null){h=m;try{n=m.stateNode,c?(o=n.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=m.stateNode,l=m.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Uf("display",s))}catch(d){Ct(e,e.return,d)}}}else if(m.tag===6){if(h===null)try{m.stateNode.nodeValue=c?"":m.memoizedProps}catch(d){Ct(e,e.return,d)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break t;for(;m.sibling===null;){if(m.return===null||m.return===e)break t;h===m&&(h=null),m=m.return}h===m&&(h=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:He(t,e),ur(e),i&4&&Hh(e);break;case 21:break;default:He(t,e),ur(e)}}function ur(e){var t=e.flags;if(t&2){try{t:{for(var r=e.return;r!==null;){if(p_(r)){var i=r;break t}r=r.return}throw Error(T(160))}switch(i.tag){case 5:var n=i.stateNode;i.flags&32&&(ko(n,""),i.flags&=-33);var o=Wh(e);Vu(e,o,n);break;case 3:case 4:var s=i.stateNode.containerInfo,a=Wh(e);Mu(e,a,s);break;default:throw Error(T(161))}}catch(l){Ct(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function yy(e,t,r){E=e,v_(e)}function v_(e,t,r){for(var i=(e.mode&1)!==0;E!==null;){var n=E,o=n.child;if(n.tag===22&&i){var s=n.memoizedState!==null||ds;if(!s){var a=n.alternate,l=a!==null&&a.memoizedState!==null||Xt;a=ds;var c=Xt;if(ds=s,(Xt=l)&&!c)for(E=n;E!==null;)s=E,l=s.child,s.tag===22&&s.memoizedState!==null?Xh(n):l!==null?(l.return=s,E=l):Xh(n);for(;o!==null;)E=o,v_(o),o=o.sibling;E=n,ds=a,Xt=c}Yh(e)}else n.subtreeFlags&8772&&o!==null?(o.return=n,E=o):Yh(e)}}function Yh(e){for(;E!==null;){var t=E;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Xt||$a(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!Xt)if(r===null)i.componentDidMount();else{var n=t.elementType===t.type?r.memoizedProps:Ge(t.type,r.memoizedProps);i.componentDidUpdate(n,r.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&kh(t,o,i);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}kh(t,s,r)}break;case 5:var a=t.stateNode;if(r===null&&t.flags&4){r=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var h=c.memoizedState;if(h!==null){var m=h.dehydrated;m!==null&&Fo(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(T(163))}Xt||t.flags&512&&bu(t)}catch(f){Ct(t,t.return,f)}}if(t===e){E=null;break}if(r=t.sibling,r!==null){r.return=t.return,E=r;break}E=t.return}}function Jh(e){for(;E!==null;){var t=E;if(t===e){E=null;break}var r=t.sibling;if(r!==null){r.return=t.return,E=r;break}E=t.return}}function Xh(e){for(;E!==null;){var t=E;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{$a(4,t)}catch(l){Ct(t,r,l)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var n=t.return;try{i.componentDidMount()}catch(l){Ct(t,n,l)}}var o=t.return;try{bu(t)}catch(l){Ct(t,o,l)}break;case 5:var s=t.return;try{bu(t)}catch(l){Ct(t,s,l)}}}catch(l){Ct(t,t.return,l)}if(t===e){E=null;break}var a=t.sibling;if(a!==null){a.return=t.return,E=a;break}E=t.return}}var gy=Math.ceil,Ca=Or.ReactCurrentDispatcher,wc=Or.ReactCurrentOwner,Ue=Or.ReactCurrentBatchConfig,rt=0,Ut=null,It=null,Wt=0,xe=0,Tn=di(0),Et=0,Ho=null,Ji=0,ja=0,Bc=0,Po=null,ce=null,Cc=0,jn=1/0,Tr=null,Sa=!1,Tu=null,li=null,vs=!1,ei=null,Pa=0,bo=0,ku=null,ra=-1,ia=0;function re(){return rt&6?St():ra!==-1?ra:ra=St()}function ui(e){return e.mode&1?rt&2&&Wt!==0?Wt&-Wt:ry.transition!==null?(ia===0&&(ia=ep()),ia):(e=st,e!==0||(e=window.event,e=e===void 0?16:lp(e.type)),e):1}function ir(e,t,r,i){if(50<bo)throw bo=0,ku=null,Error(T(185));Go(e,r,i),(!(rt&2)||e!==Ut)&&(e===Ut&&(!(rt&2)&&(ja|=r),Et===4&&Kr(e,Wt)),pe(e,i),r===1&&rt===0&&!(t.mode&1)&&(jn=St()+500,Oa&&vi()))}function pe(e,t){var r=e.callbackNode;rv(e,t);var i=ua(e,e===Ut?Wt:0);if(i===0)r!==null&&nh(r),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(r!=null&&nh(r),t===1)e.tag===0?ey(Qh.bind(null,e)):bp(Qh.bind(null,e)),Gv(function(){!(rt&6)&&vi()}),r=null;else{switch(rp(i)){case 1:r=Qu;break;case 4:r=Zf;break;case 16:r=la;break;case 536870912:r=tp;break;default:r=la}r=S_(r,y_.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function y_(e,t){if(ra=-1,ia=0,rt&6)throw Error(T(327));var r=e.callbackNode;if(Nn()&&e.callbackNode!==r)return null;var i=ua(e,e===Ut?Wt:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=ba(e,i);else{t=i;var n=rt;rt|=2;var o=x_();(Ut!==e||Wt!==t)&&(Tr=null,jn=St()+500,Oi(e,t));do try{wy();break}catch(a){g_(e,a)}while(!0);uc(),Ca.current=o,rt=n,It!==null?t=0:(Ut=null,Wt=0,t=Et)}if(t!==0){if(t===2&&(n=nu(e),n!==0&&(i=n,t=Iu(e,n))),t===1)throw r=Ho,Oi(e,0),Kr(e,i),pe(e,St()),r;if(t===6)Kr(e,i);else{if(n=e.current.alternate,!(i&30)&&!xy(n)&&(t=ba(e,i),t===2&&(o=nu(e),o!==0&&(i=o,t=Iu(e,o))),t===1))throw r=Ho,Oi(e,0),Kr(e,i),pe(e,St()),r;switch(e.finishedWork=n,e.finishedLanes=i,t){case 0:case 1:throw Error(T(345));case 2:zi(e,ce,Tr);break;case 3:if(Kr(e,i),(i&130023424)===i&&(t=Cc+500-St(),10<t)){if(ua(e,0)!==0)break;if(n=e.suspendedLanes,(n&i)!==i){re(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=mu(zi.bind(null,e,ce,Tr),t);break}zi(e,ce,Tr);break;case 4:if(Kr(e,i),(i&4194240)===i)break;for(t=e.eventTimes,n=-1;0<i;){var s=31-rr(i);o=1<<s,s=t[s],s>n&&(n=s),i&=~o}if(i=n,i=St()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*gy(i/1960))-i,10<i){e.timeoutHandle=mu(zi.bind(null,e,ce,Tr),i);break}zi(e,ce,Tr);break;case 5:zi(e,ce,Tr);break;default:throw Error(T(329))}}}return pe(e,St()),e.callbackNode===r?y_.bind(null,e):null}function Iu(e,t){var r=Po;return e.current.memoizedState.isDehydrated&&(Oi(e,t).flags|=256),e=ba(e,t),e!==2&&(t=ce,ce=r,t!==null&&zu(t)),e}function zu(e){ce===null?ce=e:ce.push.apply(ce,e)}function xy(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var i=0;i<r.length;i++){var n=r[i],o=n.getSnapshot;n=n.value;try{if(!ar(o(),n))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Kr(e,t){for(t&=~Bc,t&=~ja,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-rr(t),i=1<<r;e[r]=-1,t&=~i}}function Qh(e){if(rt&6)throw Error(T(327));Nn();var t=ua(e,0);if(!(t&1))return pe(e,St()),null;var r=ba(e,t);if(e.tag!==0&&r===2){var i=nu(e);i!==0&&(t=i,r=Iu(e,i))}if(r===1)throw r=Ho,Oi(e,0),Kr(e,t),pe(e,St()),r;if(r===6)throw Error(T(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,zi(e,ce,Tr),pe(e,St()),null}function Sc(e,t){var r=rt;rt|=1;try{return e(t)}finally{rt=r,rt===0&&(jn=St()+500,Oa&&vi())}}function Xi(e){ei!==null&&ei.tag===0&&!(rt&6)&&Nn();var t=rt;rt|=1;var r=Ue.transition,i=st;try{if(Ue.transition=null,st=1,e)return e()}finally{st=i,Ue.transition=r,rt=t,!(rt&6)&&vi()}}function Pc(){xe=Tn.current,pt(Tn)}function Oi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Qv(r)),It!==null)for(r=It.return;r!==null;){var i=r;switch(sc(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&pa();break;case 3:Un(),pt(me),pt(Gt),_c();break;case 5:pc(i);break;case 4:Un();break;case 13:pt(vt);break;case 19:pt(vt);break;case 10:cc(i.type._context);break;case 22:case 23:Pc()}r=r.return}if(Ut=e,It=e=ci(e.current,null),Wt=xe=t,Et=0,Ho=null,Bc=ja=Ji=0,ce=Po=null,Ni!==null){for(t=0;t<Ni.length;t++)if(r=Ni[t],i=r.interleaved,i!==null){r.interleaved=null;var n=i.next,o=r.pending;if(o!==null){var s=o.next;o.next=n,i.next=s}r.pending=i}Ni=null}return e}function g_(e,t){do{var r=It;try{if(uc(),Zs.current=Ba,wa){for(var i=gt.memoizedState;i!==null;){var n=i.queue;n!==null&&(n.pending=null),i=i.next}wa=!1}if(Yi=0,Dt=Ft=gt=null,Co=!1,$o=0,wc.current=null,r===null||r.return===null){Et=1,Ho=t,It=null;break}t:{var o=e,s=r.return,a=r,l=t;if(t=Wt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,h=a,m=h.tag;if(!(h.mode&1)&&(m===0||m===11||m===15)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=Nh(s);if(p!==null){p.flags&=-257,Rh(p,s,a,o,t),p.mode&1&&Eh(o,c,t),t=p,l=c;var _=t.updateQueue;if(_===null){var d=new Set;d.add(l),t.updateQueue=d}else _.add(l);break t}else{if(!(t&1)){Eh(o,c,t),bc();break t}l=Error(T(426))}}else if(dt&&a.mode&1){var x=Nh(s);if(x!==null){!(x.flags&65536)&&(x.flags|=256),Rh(x,s,a,o,t),ac($n(l,a));break t}}o=l=$n(l,a),Et!==4&&(Et=2),Po===null?Po=[o]:Po.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var v=r_(o,l,t);Th(o,v);break t;case 1:a=l;var y=o.type,g=o.stateNode;if(!(o.flags&128)&&(typeof y.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(li===null||!li.has(g)))){o.flags|=65536,t&=-t,o.lanes|=t;var A=i_(o,a,t);Th(o,A);break t}}o=o.return}while(o!==null)}w_(r)}catch(w){t=w,It===r&&r!==null&&(It=r=r.return);continue}break}while(!0)}function x_(){var e=Ca.current;return Ca.current=Ba,e===null?Ba:e}function bc(){(Et===0||Et===3||Et===2)&&(Et=4),Ut===null||!(Ji&268435455)&&!(ja&268435455)||Kr(Ut,Wt)}function ba(e,t){var r=rt;rt|=2;var i=x_();(Ut!==e||Wt!==t)&&(Tr=null,Oi(e,t));do try{Ay();break}catch(n){g_(e,n)}while(!0);if(uc(),rt=r,Ca.current=i,It!==null)throw Error(T(261));return Ut=null,Wt=0,Et}function Ay(){for(;It!==null;)A_(It)}function wy(){for(;It!==null&&!Yd();)A_(It)}function A_(e){var t=C_(e.alternate,e,xe);e.memoizedProps=e.pendingProps,t===null?w_(e):It=t,wc.current=null}function w_(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=_y(r,t),r!==null){r.flags&=32767,It=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Et=6,It=null;return}}else if(r=py(r,t,xe),r!==null){It=r;return}if(t=t.sibling,t!==null){It=t;return}It=t=e}while(t!==null);Et===0&&(Et=5)}function zi(e,t,r){var i=st,n=Ue.transition;try{Ue.transition=null,st=1,By(e,t,r,i)}finally{Ue.transition=n,st=i}return null}function By(e,t,r,i){do Nn();while(ei!==null);if(rt&6)throw Error(T(327));r=e.finishedWork;var n=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(T(177));e.callbackNode=null,e.callbackPriority=0;var o=r.lanes|r.childLanes;if(iv(e,o),e===Ut&&(It=Ut=null,Wt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||vs||(vs=!0,S_(la,function(){return Nn(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=Ue.transition,Ue.transition=null;var s=st;st=1;var a=rt;rt|=4,wc.current=null,vy(e,r),d_(r,e),$v(cu),ca=!!uu,cu=uu=null,e.current=r,yy(r),Jd(),rt=a,st=s,Ue.transition=o}else e.current=r;if(vs&&(vs=!1,ei=e,Pa=n),o=e.pendingLanes,o===0&&(li=null),Gd(r.stateNode),pe(e,St()),t!==null)for(i=e.onRecoverableError,r=0;r<t.length;r++)n=t[r],i(n.value,{componentStack:n.stack,digest:n.digest});if(Sa)throw Sa=!1,e=Tu,Tu=null,e;return Pa&1&&e.tag!==0&&Nn(),o=e.pendingLanes,o&1?e===ku?bo++:(bo=0,ku=e):bo=0,vi(),null}function Nn(){if(ei!==null){var e=rp(Pa),t=Ue.transition,r=st;try{if(Ue.transition=null,st=16>e?16:e,ei===null)var i=!1;else{if(e=ei,ei=null,Pa=0,rt&6)throw Error(T(331));var n=rt;for(rt|=4,E=e.current;E!==null;){var o=E,s=o.child;if(E.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(E=c;E!==null;){var h=E;switch(h.tag){case 0:case 11:case 15:So(8,h,o)}var m=h.child;if(m!==null)m.return=h,E=m;else for(;E!==null;){h=E;var f=h.sibling,p=h.return;if(f_(h),h===c){E=null;break}if(f!==null){f.return=p,E=f;break}E=p}}}var _=o.alternate;if(_!==null){var d=_.child;if(d!==null){_.child=null;do{var x=d.sibling;d.sibling=null,d=x}while(d!==null)}}E=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,E=s;else t:for(;E!==null;){if(o=E,o.flags&2048)switch(o.tag){case 0:case 11:case 15:So(9,o,o.return)}var v=o.sibling;if(v!==null){v.return=o.return,E=v;break t}E=o.return}}var y=e.current;for(E=y;E!==null;){s=E;var g=s.child;if(s.subtreeFlags&2064&&g!==null)g.return=s,E=g;else t:for(s=y;E!==null;){if(a=E,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:$a(9,a)}}catch(w){Ct(a,a.return,w)}if(a===s){E=null;break t}var A=a.sibling;if(A!==null){A.return=a.return,E=A;break t}E=a.return}}if(rt=n,vi(),gr&&typeof gr.onPostCommitFiberRoot=="function")try{gr.onPostCommitFiberRoot(Fa,e)}catch{}i=!0}return i}finally{st=r,Ue.transition=t}}return!1}function Gh(e,t,r){t=$n(r,t),t=r_(e,t,1),e=ai(e,t,1),t=re(),e!==null&&(Go(e,1,t),pe(e,t))}function Ct(e,t,r){if(e.tag===3)Gh(e,e,r);else for(;t!==null;){if(t.tag===3){Gh(t,e,r);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(li===null||!li.has(i))){e=$n(r,e),e=i_(t,e,1),t=ai(t,e,1),e=re(),t!==null&&(Go(t,1,e),pe(t,e));break}}t=t.return}}function Cy(e,t,r){var i=e.pingCache;i!==null&&i.delete(t),t=re(),e.pingedLanes|=e.suspendedLanes&r,Ut===e&&(Wt&r)===r&&(Et===4||Et===3&&(Wt&130023424)===Wt&&500>St()-Cc?Oi(e,0):Bc|=r),pe(e,t)}function B_(e,t){t===0&&(e.mode&1?(t=as,as<<=1,!(as&130023424)&&(as=4194304)):t=1);var r=re();e=Nr(e,t),e!==null&&(Go(e,t,r),pe(e,r))}function Sy(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),B_(e,r)}function Py(e,t){var r=0;switch(e.tag){case 13:var i=e.stateNode,n=e.memoizedState;n!==null&&(r=n.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(T(314))}i!==null&&i.delete(t),B_(e,r)}var C_;C_=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||me.current)he=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return he=!1,fy(e,t,r);he=!!(e.flags&131072)}else he=!1,dt&&t.flags&1048576&&Mp(t,va,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;ea(e,t),e=t.pendingProps;var n=Dn(t,Gt.current);En(t,r),n=vc(null,t,i,e,n,r);var o=yc();return t.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,fe(i)?(o=!0,_a(t)):o=!1,t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,mc(t),n.updater=Ua,t.stateNode=n,n._reactInternals=t,gu(t,i,e,r),t=wu(null,t,i,!0,o,r)):(t.tag=0,dt&&o&&oc(t),ee(null,t,n,r),t=t.child),t;case 16:i=t.elementType;t:{switch(ea(e,t),e=t.pendingProps,n=i._init,i=n(i._payload),t.type=i,n=t.tag=My(i),e=Ge(i,e),n){case 0:t=Au(null,t,i,e,r);break t;case 1:t=qh(null,t,i,e,r);break t;case 11:t=Dh(null,t,i,e,r);break t;case 14:t=Oh(null,t,i,Ge(i.type,e),r);break t}throw Error(T(306,i,""))}return t;case 0:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:Ge(i,n),Au(e,t,i,n,r);case 1:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:Ge(i,n),qh(e,t,i,n,r);case 3:t:{if(a_(t),e===null)throw Error(T(387));i=t.pendingProps,o=t.memoizedState,n=o.element,Lp(e,t),xa(t,i,null,r);var s=t.memoizedState;if(i=s.element,o.isDehydrated)if(o={element:i,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){n=$n(Error(T(423)),t),t=Uh(e,t,i,r,n);break t}else if(i!==n){n=$n(Error(T(424)),t),t=Uh(e,t,i,r,n);break t}else for(we=si(t.stateNode.containerInfo.firstChild),Be=t,dt=!0,Ze=null,r=Ip(t,null,i,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(On(),i===n){t=Rr(e,t,r);break t}ee(e,t,i,r)}t=t.child}return t;case 5:return Fp(t),e===null&&du(t),i=t.type,n=t.pendingProps,o=e!==null?e.memoizedProps:null,s=n.children,hu(i,n)?s=null:o!==null&&hu(i,o)&&(t.flags|=32),s_(e,t),ee(e,t,s,r),t.child;case 6:return e===null&&du(t),null;case 13:return l_(e,t,r);case 4:return fc(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=qn(t,null,i,r):ee(e,t,i,r),t.child;case 11:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:Ge(i,n),Dh(e,t,i,n,r);case 7:return ee(e,t,t.pendingProps,r),t.child;case 8:return ee(e,t,t.pendingProps.children,r),t.child;case 12:return ee(e,t,t.pendingProps.children,r),t.child;case 10:t:{if(i=t.type._context,n=t.pendingProps,o=t.memoizedProps,s=n.value,ct(ya,i._currentValue),i._currentValue=s,o!==null)if(ar(o.value,s)){if(o.children===n.children&&!me.current){t=Rr(e,t,r);break t}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(o.tag===1){l=Lr(-1,r&-r),l.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var h=c.pending;h===null?l.next=l:(l.next=h.next,h.next=l),c.pending=l}}o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),vu(o.return,r,t),a.lanes|=r;break}l=l.next}}else if(o.tag===10)s=o.type===t.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(T(341));s.lanes|=r,a=s.alternate,a!==null&&(a.lanes|=r),vu(s,r,t),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===t){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}ee(e,t,n.children,r),t=t.child}return t;case 9:return n=t.type,i=t.pendingProps.children,En(t,r),n=$e(n),i=i(n),t.flags|=1,ee(e,t,i,r),t.child;case 14:return i=t.type,n=Ge(i,t.pendingProps),n=Ge(i.type,n),Oh(e,t,i,n,r);case 15:return n_(e,t,t.type,t.pendingProps,r);case 17:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:Ge(i,n),ea(e,t),t.tag=1,fe(i)?(e=!0,_a(t)):e=!1,En(t,r),e_(t,i,n),gu(t,i,n,r),wu(null,t,i,!0,e,r);case 19:return u_(e,t,r);case 22:return o_(e,t,r)}throw Error(T(156,t.tag))};function S_(e,t){return Kf(e,t)}function by(e,t,r,i){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oe(e,t,r,i){return new by(e,t,r,i)}function Mc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function My(e){if(typeof e=="function")return Mc(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Yu)return 11;if(e===Ju)return 14}return 2}function ci(e,t){var r=e.alternate;return r===null?(r=Oe(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function na(e,t,r,i,n,o){var s=2;if(i=e,typeof e=="function")Mc(e)&&(s=1);else if(typeof e=="string")s=5;else t:switch(e){case xn:return qi(r.children,n,o,t);case Hu:s=8,n|=8;break;case $l:return e=Oe(12,r,t,n|2),e.elementType=$l,e.lanes=o,e;case jl:return e=Oe(13,r,t,n),e.elementType=jl,e.lanes=o,e;case Wl:return e=Oe(19,r,t,n),e.elementType=Wl,e.lanes=o,e;case Ff:return Wa(r,n,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case zf:s=10;break t;case Lf:s=9;break t;case Yu:s=11;break t;case Ju:s=14;break t;case Jr:s=16,i=null;break t}throw Error(T(130,e==null?e:typeof e,""))}return t=Oe(s,r,t,n),t.elementType=e,t.type=i,t.lanes=o,t}function qi(e,t,r,i){return e=Oe(7,e,i,t),e.lanes=r,e}function Wa(e,t,r,i){return e=Oe(22,e,i,t),e.elementType=Ff,e.lanes=r,e.stateNode={isHidden:!1},e}function Al(e,t,r){return e=Oe(6,e,null,t),e.lanes=r,e}function wl(e,t,r){return t=Oe(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Vy(e,t,r,i,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=rl(0),this.expirationTimes=rl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rl(0),this.identifierPrefix=i,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function Vc(e,t,r,i,n,o,s,a,l){return e=new Vy(e,t,r,a,l),t===1?(t=1,o===!0&&(t|=8)):t=0,o=Oe(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:i,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},mc(o),e}function Ty(e,t,r){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:gn,key:i==null?null:""+i,children:e,containerInfo:t,implementation:r}}function P_(e){if(!e)return mi;e=e._reactInternals;t:{if(Ki(e)!==e||e.tag!==1)throw Error(T(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break t;case 1:if(fe(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break t}}t=t.return}while(t!==null);throw Error(T(171))}if(e.tag===1){var r=e.type;if(fe(r))return Pp(e,r,t)}return t}function b_(e,t,r,i,n,o,s,a,l){return e=Vc(r,i,!0,e,n,o,s,a,l),e.context=P_(null),r=e.current,i=re(),n=ui(r),o=Lr(i,n),o.callback=t??null,ai(r,o,n),e.current.lanes=n,Go(e,n,i),pe(e,i),e}function Ha(e,t,r,i){var n=t.current,o=re(),s=ui(n);return r=P_(r),t.context===null?t.context=r:t.pendingContext=r,t=Lr(o,s),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=ai(n,t,s),e!==null&&(ir(e,n,s,o),Ks(e,n,s)),s}function Ma(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Kh(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Tc(e,t){Kh(e,t),(e=e.alternate)&&Kh(e,t)}function ky(){return null}var M_=typeof reportError=="function"?reportError:function(e){console.error(e)};function kc(e){this._internalRoot=e}Ya.prototype.render=kc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(T(409));Ha(e,t,null,null)};Ya.prototype.unmount=kc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Xi(function(){Ha(null,e,null,null)}),t[Er]=null}};function Ya(e){this._internalRoot=e}Ya.prototype.unstable_scheduleHydration=function(e){if(e){var t=op();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Gr.length&&t!==0&&t<Gr[r].priority;r++);Gr.splice(r,0,e),r===0&&ap(e)}};function Ic(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ja(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Zh(){}function Iy(e,t,r,i,n){if(n){if(typeof i=="function"){var o=i;i=function(){var c=Ma(s);o.call(c)}}var s=b_(t,i,e,0,null,!1,!1,"",Zh);return e._reactRootContainer=s,e[Er]=s.current,Ro(e.nodeType===8?e.parentNode:e),Xi(),s}for(;n=e.lastChild;)e.removeChild(n);if(typeof i=="function"){var a=i;i=function(){var c=Ma(l);a.call(c)}}var l=Vc(e,0,!1,null,null,!1,!1,"",Zh);return e._reactRootContainer=l,e[Er]=l.current,Ro(e.nodeType===8?e.parentNode:e),Xi(function(){Ha(t,l,r,i)}),l}function Xa(e,t,r,i,n){var o=r._reactRootContainer;if(o){var s=o;if(typeof n=="function"){var a=n;n=function(){var l=Ma(s);a.call(l)}}Ha(t,s,e,n)}else s=Iy(r,t,e,n,i);return Ma(s)}ip=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=_o(t.pendingLanes);r!==0&&(Gu(t,r|1),pe(t,St()),!(rt&6)&&(jn=St()+500,vi()))}break;case 13:Xi(function(){var i=Nr(e,1);if(i!==null){var n=re();ir(i,e,1,n)}}),Tc(e,1)}};Ku=function(e){if(e.tag===13){var t=Nr(e,134217728);if(t!==null){var r=re();ir(t,e,134217728,r)}Tc(e,134217728)}};np=function(e){if(e.tag===13){var t=ui(e),r=Nr(e,t);if(r!==null){var i=re();ir(r,e,t,i)}Tc(e,t)}};op=function(){return st};sp=function(e,t){var r=st;try{return st=e,t()}finally{st=r}};eu=function(e,t,r){switch(t){case"input":if(Jl(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var i=r[t];if(i!==e&&i.form===e.form){var n=Da(i);if(!n)throw Error(T(90));Nf(i),Jl(i,n)}}}break;case"textarea":Df(e,r);break;case"select":t=r.value,t!=null&&In(e,!!r.multiple,t,!1)}};Hf=Sc;Yf=Xi;var zy={usingClientEntryPoint:!1,Events:[Zo,Cn,Da,jf,Wf,Sc]},ro={findFiberByHostInstance:Ei,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ly={bundleType:ro.bundleType,version:ro.version,rendererPackageName:ro.rendererPackageName,rendererConfig:ro.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Or.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Qf(e),e===null?null:e.stateNode},findFiberByHostInstance:ro.findFiberByHostInstance||ky,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ys=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ys.isDisabled&&ys.supportsFiber)try{Fa=ys.inject(Ly),gr=ys}catch{}}Pe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zy;Pe.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ic(t))throw Error(T(200));return Ty(e,t,null,r)};Pe.createRoot=function(e,t){if(!Ic(e))throw Error(T(299));var r=!1,i="",n=M_;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(n=t.onRecoverableError)),t=Vc(e,1,!1,null,null,r,!1,i,n),e[Er]=t.current,Ro(e.nodeType===8?e.parentNode:e),new kc(t)};Pe.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(T(188)):(e=Object.keys(e).join(","),Error(T(268,e)));return e=Qf(t),e=e===null?null:e.stateNode,e};Pe.flushSync=function(e){return Xi(e)};Pe.hydrate=function(e,t,r){if(!Ja(t))throw Error(T(200));return Xa(null,e,t,!0,r)};Pe.hydrateRoot=function(e,t,r){if(!Ic(e))throw Error(T(405));var i=r!=null&&r.hydratedSources||null,n=!1,o="",s=M_;if(r!=null&&(r.unstable_strictMode===!0&&(n=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=b_(t,null,e,1,r??null,n,!1,o,s),e[Er]=t.current,Ro(e),i)for(e=0;e<i.length;e++)r=i[e],n=r._getVersion,n=n(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,n]:t.mutableSourceEagerHydrationData.push(r,n);return new Ya(t)};Pe.render=function(e,t,r){if(!Ja(t))throw Error(T(200));return Xa(null,e,t,!1,r)};Pe.unmountComponentAtNode=function(e){if(!Ja(e))throw Error(T(40));return e._reactRootContainer?(Xi(function(){Xa(null,null,e,!1,function(){e._reactRootContainer=null,e[Er]=null})}),!0):!1};Pe.unstable_batchedUpdates=Sc;Pe.unstable_renderSubtreeIntoContainer=function(e,t,r,i){if(!Ja(r))throw Error(T(200));if(e==null||e._reactInternals===void 0)throw Error(T(38));return Xa(e,t,r,!1,i)};Pe.version="18.3.1-next-f1338f8080-20240426";function V_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(V_)}catch(e){console.error(e)}}V_(),Vf.exports=Pe;var Fy=Vf.exports,T_,tm=Fy;T_=tm.createRoot,tm.hydrateRoot;const Ey=(e,t={})=>{const r=Ae.useRef(null);return Ae.useEffect(()=>{const i=r.current,n=i==null?void 0:i.getContext("webgl2");let o=0,s=0;const a=()=>{o++,n.clearColor(0,0,0,1),n.clearDepth(1),n.enable(n.DEPTH_TEST),n.depthFunc(n.LEQUAL),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),e(n,o),s=window.requestAnimationFrame(a)};return a(),()=>{window.cancelAnimationFrame(s)}},[e]),r},Ny=e=>{const{draw:t,fps:r,options:i,...n}=e,{context:o,...s}=i,a=Ey(t,{});return tr(bf,{children:tr("canvas",{ref:a,...n,...s,id:"canvas",width:"900",height:"500"})})};let Ry=class{constructor(t){this.settings=t}spawnActor(t,r){return t.setWorld(this),t.body=this.createPhysicsBody(t),t}despawnActor(t){t.body&&(t.body.destroyBoundingVolume(),t.body=null)}};class H{constructor(t,r){this.x=t,this.y=r}add(t){return new H(this.x+t.x,this.y+t.y)}subtract(t){return new H(this.x-t.x,this.y-t.y)}multiply(t){return new H(this.x*t,this.y*t)}clone(){return new H(this.x,this.y)}copy(t){this.x=t.x,this.y=t.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){const t=this.length();return t>0?this.multiply(1/t):this}equals(t){return this.x===t.x&&this.y===t.y}toString(){return`Vector2(${this.x}, ${this.y})`}}class k_{constructor(t){L(this,"children",[]);L(this,"parent",null);this.name=t,this.name=t,this.children=[]}getChildren(){return this.children}getChildrenOfType(t){return this.children.filter(r=>r instanceof t)}addChild(t){if(this.name===t.name)throw new Error("Cannot add actor as child of itself");this.children.find(r=>r.name==t.name)||(this.children.push(t),t.setParent(this))}removeChild(t){const r=this.children.indexOf(t);r!==-1&&(this.children.splice(r,1),t.setParent(null))}addChildren(t){for(const r of t)this.addChild(r)}findChildOfType(t,r){for(const i of this.children.filter(n=>n instanceof r)){if(i.name===t)return i;const n=i.findChildOfType(t,r);if(n)return n}return null}setParent(t){this.parent=t}getParent(){return this.parent}}class ri{constructor(){L(this,"elements");this.elements=new Float32Array(9),this.identity()}identity(){const t=this.elements;return t[0]=1,t[3]=0,t[6]=0,t[1]=0,t[4]=1,t[7]=0,t[2]=0,t[5]=0,t[8]=1,this}multiply(t){const r=this.elements,i=t.elements,n=new Float32Array(9),o=r[0],s=r[3],a=r[6],l=r[1],c=r[4],h=r[7],m=r[2],f=r[5],p=r[8],_=i[0],d=i[3],x=i[6],v=i[1],y=i[4],g=i[7],A=i[2],w=i[5],C=i[8];return n[0]=o*_+s*v+a*A,n[3]=o*d+s*y+a*w,n[6]=o*x+s*g+a*C,n[1]=l*_+c*v+h*A,n[4]=l*d+c*y+h*w,n[7]=l*x+c*g+h*C,n[2]=m*_+f*v+p*A,n[5]=m*d+f*y+p*w,n[8]=m*x+f*g+p*C,this.elements=n,this}translate(t){const r=this.elements;return r[6]+=t.x,r[7]+=t.y,this}scale(t){const r=this.elements;return r[0]*=t.x,r[1]*=t.x,r[2]*=t.x,r[3]*=t.y,r[4]*=t.y,r[5]*=t.y,this}rotate(t){const r=Math.cos(t),i=Math.sin(t),n=this.elements,o=n[0],s=n[3],a=n[1],l=n[4],c=n[2],h=n[5];return n[0]=o*r+s*-i,n[3]=o*i+s*r,n[1]=a*r+l*-i,n[4]=a*i+l*r,n[2]=c*r+h*-i,n[5]=c*i+h*r,this}clone(){const t=new ri;return t.elements.set(this.elements),t}copy(t){return this.elements.set(t.elements),this}toString(){const t=this.elements;return`|${t[0]} ${t[3]} ${t[6]}|
|${t[1]} ${t[4]} ${t[7]}|
|${t[2]} ${t[5]} ${t[8]}|`}static multiplyMatrices(t,r){return t.clone().multiply(r)}static translationMatrix(t,r){const i=new ri;return i.translate(new H(t,r)),i}static rotationMatrix(t){const r=new ri;return r.rotate(t),r}static scalingMatrix(t){const r=new ri;return r.scale(t),r}}class em{static clamp(t,r,i){return t>i?i:t<r?r:t}}class I_{constructor(){L(this,"actor");this.actor=null}_tick(t,r){this.tick(t,r)}setActor(t){this.actor=t}getActor(){return this.actor}}class Yo extends I_{constructor(){super(...arguments);L(this,"density",1);L(this,"friction",.5);L(this,"restitution",.2);L(this,"sensor",!1);L(this,"offset",new H(0,0));L(this,"dirty",!0)}getDensity(){return this.density}setDensity(r){if(r<=0||!Number.isFinite(r))throw new Error("Density must be a positive finite number");this.density!==r&&(this.density=r,this.markDirty())}getFriction(){return this.friction}setFriction(r){if(r<0||!Number.isFinite(r))throw new Error("Friction must be a non-negative finite number");this.friction!==r&&(this.friction=r,this.markDirty())}getRestitution(){return this.restitution}setRestitution(r){if(r<0||!Number.isFinite(r))throw new Error("Restitution must be a non-negative finite number");this.restitution!==r&&(this.restitution=r,this.markDirty())}isSensor(){return this.sensor}setSensor(r){this.sensor!==r&&(this.sensor=r,this.markDirty())}getOffset(){return this.offset.clone()}setOffset(r){this.offset.equals(r)||(this.offset.copy(r),this.markDirty())}isDirty(){return this.dirty}clearDirty(){this.dirty=!1}markDirty(){this.dirty=!0}tick(r,i){}onColliding(r){}onCollided(r){}}class at extends k_{constructor(r){super(r);L(this,"tickComponents",!0);L(this,"isPhysicsSimulated",!1);L(this,"shouldTick",!1);L(this,"tickGroup","default");L(this,"components");L(this,"possessedBy",null);L(this,"position");L(this,"rotation",0);L(this,"world",null);L(this,"body",null);L(this,"bodyType","static");L(this,"shouldReplicate",!1);L(this,"layer",0);L(this,"isRendering",!1);L(this,"isMarkedForDespawn");this.name=r,this.components=[],this.position=new H(0,0)}onDespawned(){}async onLoad(){}setIsRendering(r){this.isRendering!==r&&(r?this.onStartRendering():this.onStopRendering(),this.isRendering=r)}onStopRendering(){}onStartRendering(){}setWorld(r){this.world=r}getWorld(){return this.world}setIsPhysicsSimulated(r,i="static"){this.isPhysicsSimulated=r,this.bodyType=i,this.body&&(this.body.setBodyType(i),this.body.setIsActive(r))}setBodyType(r){this.bodyType=r,this.body&&this.body.setBodyType(r)}getBodyType(){return this.bodyType}getRotation(){return this.rotation}setRotation(r){this.rotation=r}getIsPhysicsSimulated(){return this.isPhysicsSimulated}getPosition(){const r=this.getParent();if(r&&r instanceof at){const i=r.getPosition();return new H(i.x+this.position.x,i.y+this.position.y)}return new H(this.position.x,this.position.y)}setPosition(r){this.position=new H(r.x,r.y)}addComponent(r){this.components.push(r)}getComponentsOfType(r){return this.components.filter(i=>i instanceof r)}getWorldBounds(){const r=this.getComponentsOfType(Yo);if(r.length===0)return null;const i={min:new H(1/0,1/0),max:new H(-1/0,-1/0)};console.log(r);for(const n of r){const o=n.getBounds();i.min.x=Math.min(i.min.x,o.min.x),i.min.y=Math.min(i.min.y,o.min.y),i.max.x=Math.max(i.max.x,o.max.x),i.max.y=Math.max(i.max.y,o.max.y)}return i}_tick(r,i){if(this.shouldTick){if(this.tickComponents)for(const n of this.components)n._tick(r,i);this.tick(r,i)}}onSpawned(){}onBeginPlay(){}tick(r,i){}}class Dy extends Yo{constructor(r){super();L(this,"radius");this.assertRadius(r),this.radius=r}getRadius(){return this.radius}setRadius(r){this.assertRadius(r),this.radius!==r&&(this.radius=r,this.markDirty())}getBounds(){const r=this.getOffset();return{min:{x:r.x-this.radius,y:r.y-this.radius},max:{x:r.x+this.radius,y:r.y+this.radius}}}createShapeDescriptor(){return{type:"circle",radius:this.radius,density:this.getDensity(),friction:this.getFriction(),restitution:this.getRestitution(),isSensor:this.isSensor(),offset:this.getOffset()}}assertRadius(r){if(r<=0||!Number.isFinite(r))throw new Error("Circle radius must be a positive finite number")}}class zc extends Yo{constructor(r){super();L(this,"points");if(r.length<3)throw new Error("Polygon collision components require at least three points");this.points=r.map(i=>new H(i.x,i.y))}getPoints(){return this.points.map(r=>r.clone())}setPoints(r){if(r.length<3)throw new Error("Polygon collision components require at least three points");const i=r.map(n=>new H(n.x,n.y));this.points.length===i.length&&this.points.every((n,o)=>n.equals(i[o]))||(this.points=i,this.markDirty())}getBounds(){const r=this.getOffset();let i=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY;for(const a of this.points){const l=a.x+r.x,c=a.y+r.y;l<i&&(i=l),c<n&&(n=c),l>o&&(o=l),c>s&&(s=c)}return{min:{x:i,y:n},max:{x:o,y:s}}}createShapeDescriptor(){return{type:"polygon",vertices:this.getPoints(),density:this.getDensity(),friction:this.getFriction(),restitution:this.getRestitution(),isSensor:this.isSensor(),offset:this.getOffset()}}}class z_{static isValidUrl(t){try{var r=new URL(t);return r.protocol==="http:"||r.protocol==="https:"}catch{return!1}}}let Oy=class{constructor(t,r,i,n=!1){this.callback=t,this.nextTick=r,this.delay=i,this.repeat=n}};class qy{constructor(t=0){L(this,"hasBeenCanceled",!1);this.id=t}}class Uy{constructor(){L(this,"timers",new Map)}setTimer(t,r,i=!1){const n=new qy(this.timers.size+1),o=Date.now();return this.timers.set(n,new Oy(t,o+r,r,i)),n}clearTimer(t){this.timers.delete(t),t.hasBeenCanceled=!0}tick(){const t=Date.now();var r=Array.from(this.timers.keys());r.forEach(i=>{i.hasBeenCanceled&&this.timers.delete(i)}),this.timers.forEach((i,n)=>{t>=i.nextTick&&!n.hasBeenCanceled&&(i.callback(),i.repeat?i.nextTick=t+i.delay:this.clearTimer(n))})}}class $y{constructor(t=10){L(this,"cellSize");L(this,"cells",new Map);L(this,"actorCell",new Map);this.cellSize=t}clear(){this.cells.clear(),this.actorCell.clear()}key(t,r){return t+","+r}worldToGrid(t){return{gx:Math.floor(t.x/this.cellSize),gy:Math.floor(t.y/this.cellSize)}}insert(t){const r=t.getPosition(),{gx:i,gy:n}=this.worldToGrid(r),o=this.key(i,n);let s=this.cells.get(o);s||(s=new Set,this.cells.set(o,s)),s.add(t),this.actorCell.set(t,o)}remove(t){const r=this.actorCell.get(t);if(!r)return;const i=this.cells.get(r);i&&(i.delete(t),i.size===0&&this.cells.delete(r)),this.actorCell.delete(t)}update(t){const r=t.getPosition(),{gx:i,gy:n}=this.worldToGrid(r),o=this.key(i,n),s=this.actorCell.get(t);if(s===o)return;if(s){const l=this.cells.get(s);l&&(l.delete(t),l.size===0&&this.cells.delete(s))}let a=this.cells.get(o);a||(a=new Set,this.cells.set(o,a)),a.add(t),this.actorCell.set(t,o)}queryAABB(t,r){const i=this.worldToGrid(t),n=this.worldToGrid(r),o=[];for(let s=i.gx;s<=n.gx;s++)for(let a=i.gy;a<=n.gy;a++){const l=this.cells.get(this.key(s,a));l&&l.forEach(c=>o.push(c))}return{actors:o}}getCellCount(){return this.cells.size}getActorCount(){return this.actorCell.size}}class jy{constructor(){L(this,"listeners",new Map)}on(t,r){var i;this.listeners.has(t)||this.listeners.set(t,[]),(i=this.listeners.get(t))==null||i.push(r)}emit(t,r){var i;(i=this.listeners.get(t))==null||i.forEach(n=>n(r))}}const L_=new Map,F_=new Map;function yi(){return function(e,t){return L_.set(e.name,e),e}}function Wy(e,...t){const r=L_.get(e);if(!r)throw new Error(`Unknown type: ${e}`);return new r(...t)}function E_(e){return function(t,r){return F_.set(e,new t),t}}function rm(e){return[...F_.entries()].filter(([t,r])=>e===t||e.prototype instanceof t).map(([t,r])=>r)}class Hy extends k_{}class Yy{constructor(t,r,i="singleplayer"){L(this,"afterRenderCallbacks",new Map);L(this,"currentCamera");L(this,"lastFrameTime",0);L(this,"lastTickTime",0);L(this,"fps",0);L(this,"deltaTime",0);L(this,"currentMap");L(this,"netTickRate",120);L(this,"clientRpcs",new Map);L(this,"serverRpcs",new Map);L(this,"timerManager",new Uy);L(this,"inputManager",new jy);L(this,"frameTimes",[]);L(this,"frameId",0);L(this,"rendererCache",new Map);L(this,"spatialGrid",new $y(10));L(this,"spatialEnabled",!0);L(this,"debugPhysics",!0);L(this,"players",[]);L(this,"controllers",[]);L(this,"rootObject",new Hy("root"));this.world=t,this.netEndpoint=r,this.networkMode=i,this.currentCamera=void 0,this.currentMap=void 0}onAfterRender(t){const r=Math.random().toString(36).substr(2,9);return this.afterRenderCallbacks.set(r,t),r}offAfterRender(t){this.afterRenderCallbacks.delete(t)}setCurrentCamera(t){this.currentCamera=t}getCurrentCamera(){return this.currentCamera}aabbCast(t,r=!0,i=!0,n){if(!this.world)return[];const o=n??at;return this.world.aabbCast(t,r,i,o)}rayCast(t,r,i=!0,n=!0,o){if(!this.world)return[];const s=o??at;return this.world.rayCast(t,r,i,n,s)}radialCast(t,r,i=!0,n=!0,o){if(!this.world)return[];const s=o??at;return this.world.radialCast(t,r,i,n,s)}getDebugPhysics(){return this.debugPhysics}getTimerManager(){return this.timerManager}bindClientRpc(t,r){this.clientRpcs.set(t,r)}bindServerRpc(t,r){this.serverRpcs.set(t,r)}callClientRpc(t,...r){const i=this.clientRpcs.get(t);return i?i(...r):null}startup(){var t,r;this.networkMode==="server"&&((t=this.netEndpoint)==null||t.connect((i,n)=>{console.log(`New connection: ${n.socket.remoteAddress}`)}),(r=this.netEndpoint)==null||r.onMessage("input",i=>{console.log("Received player input:",i)})),this.timerManager.setTimer(()=>{this.handleNetworkTick()},1e3/this.netTickRate,!0)}handleNetworkTick(){}shutdown(){var t;(t=this.netEndpoint)==null||t.disconnect()}callServerRpc(t,...r){const i=this.serverRpcs.get(t);return i?i(...r):null}getActorsFlattened(t){const r=[];for(const i of t.getChildrenOfType(at)){r.push(i);const n=this.getActorsFlattened(i);n.length!==0&&r.push(...n)}return r}tick(){const t=performance.now();if(this.lastTickTime===0&&(this.lastTickTime=t),this.deltaTime=(t-this.lastTickTime)/1e3,this.lastTickTime=t,this.tickTimerManager(this.deltaTime),this.tickActorsAndWorld(this.deltaTime),this.spatialEnabled){const r=this.rootObject.getChildrenOfType(at);for(const i of r)this.spatialGrid.update(i)}this.networkMode==="server"?this.serverTick(this.deltaTime):this.networkMode==="client"?this.clientTick(this.deltaTime):this.singlePlayerTick(this.deltaTime)}getFlattenedActors(){const t=[];for(const r of this.rootObject.getChildrenOfType(at)){t.push(r);const i=this.getActorsFlattened(r);i.length!==0&&t.push(...i)}return t}render(t){this.frameId++;const r=this.getFlattenedActors(),i=r.sort((s,a)=>s.layer-a.layer),n=this.currentCamera;let o;if(n){const s=t.canvas.width||1,a=t.canvas.height||1,l=a===0?1:s/a;n.getViewProjectionMatrix(l),o=n.getFrustum()}for(const s of i)!o||this.world.checkWithinBounds(s,o)?(s.setIsRendering(!0),this.renderActor(s,t)):s.setIsRendering(!1);if(this.debugPhysics&&this.currentCamera){const s=t.isEnabled(t.DEPTH_TEST);t.disable(t.DEPTH_TEST);for(const a of r)this.renderActorDebug(a,t);s&&t.enable(t.DEPTH_TEST)}}renderActor(t,r){const i=Object.getPrototypeOf(t).constructor;let n=this.rendererCache.get(i);n||(n=rm(i),this.rendererCache.set(i,n));for(const o of n)o.render(t,this.currentCamera,r,this.debugPhysics)}renderActorDebug(t,r,i){const n=Object.getPrototypeOf(t).constructor;let o=this.rendererCache.get(n);o||(o=rm(n),this.rendererCache.set(n,o));for(const s of o)typeof s.renderDebug=="function"&&s.renderDebug(t,this.currentCamera,r);if(!i)for(const s of t.getChildrenOfType(at))this.renderActorDebug(s,r)}getFPS(){return this.fps}finishFrame(){const r=performance.now();if(this.lastFrameTime===0)this.lastFrameTime=r;else{const i=r-this.lastFrameTime;this.lastFrameTime=r,this.frameTimes.push(i),this.frameTimes.length>240&&this.frameTimes.shift();const o=this.frameTimes.reduce((s,a)=>s+a,0)/this.frameTimes.length;o>0&&(this.fps=1e3/o)}for(const i of this.afterRenderCallbacks.values())i()}singlePlayerTick(t){}clientTick(t){const r=this.getActorsFlattened(this.rootObject);for(const i of r)i.isMarkedForDespawn&&this.despawnActor(i)}despawnActor(t){var r,i;for(const n of t.getChildrenOfType(at))this.despawnActor(n);t.onDespawned(),(r=t.getParent())==null||r.removeChild(t),(i=this.world)==null||i.despawnActor(t)}serverTick(t){}tickTimerManager(t){this.timerManager.tick()}getActorsCount(){return this.getActorsFlattened(this.rootObject).length}tickActorsAndWorld(t){var o;const r=this.getActorsFlattened(this.rootObject),i=r.filter(s=>s.shouldTick)||[];i.filter(s=>s.tickGroup==="default").forEach(s=>s._tick(this.deltaTime,this.networkMode)),(o=this.world)==null||o._tick(1/120),i.filter(s=>s.tickGroup==="post-physics").forEach(s=>s._tick(this.deltaTime,this.networkMode));const n=r.filter(s=>s.shouldReplicate)||[];if(this.networkMode==="server")for(const s of n);this.networkMode}async loadLevelObject(t){if(!t)throw new Error("Invalid level object");this.currentMap=t,this.rootObject.addChildren(t.getActors());const r=this.rootObject.getChildrenOfType(at);for(const i of r)console.log("Loading actor:",i.name),await i.onLoad();await this.spawnLevelActors()}async loadLevel(t){if(!t||t.length===0)throw new Error("Invalid level path");if(z_.isValidUrl(t))return;if(!this.currentMap)throw new Error("No level loaded");const r=this.rootObject.getChildrenOfType(at);for(const i of r)console.log("Loading actor:",i.name),await i.onLoad();await this.spawnLevelActors()}async spawnActor(t,r,i){if(!this.world)throw new Error("No world loaded");r?r.addChild(t):this.rootObject.addChild(t),i!==void 0&&t.setPosition(i),this.world.spawnActor(t,t.getPosition());const n=t.getChildrenOfType(at);for(const o of n)await this.spawnActor(o,t);t.onSpawned(),this.spatialEnabled&&this.spatialGrid.insert(t)}async spawnLevelActors(){const t=this.rootObject.getChildrenOfType(at);for(const r of t)await this.spawnActor(r),r.onSpawned()}}class Jy{constructor(t,r){L(this,"actor");L(this,"world");L(this,"bodyType","dynamic");this.world=t,this.actor=r,this.bodyType="dynamic"}}class Xy{}class Qy{constructor(){L(this,"objects",[])}findActor(t){for(const r of this.objects.filter(i=>i instanceof at)){if(r.name===t)return r;const i=r.findChildOfType(t,at);if(i)return i}return null}getWorldSize(){let t=0,r=0;return new H(t,r)}addActor(t){this.findActor(t.name)||this.objects.push(t)}addActors(t){for(const r of t)this.findActor(r.name)||this.objects.push(r)}getActors(){return this.objects.filter(t=>t instanceof at)}getChildActors(t){const r=[];for(const i of t.getChildrenOfType(at))r.push(i),r.push(...this.getChildActors(i));return r}}class Gy{constructor(){L(this,"vertices",new Float32Array);L(this,"indices",new Uint16Array);L(this,"uvs",new Float32Array)}}class Ky extends Gy{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.indices=new Uint16Array([0,1,2,1,3,2]),this.uvs=new Float32Array([0,0,1,0,0,1,1,1])}rotate(t){const r=Math.cos(t),i=Math.sin(t);for(let n=0;n<this.vertices.length;n+=2){const o=this.vertices[n],s=this.vertices[n+1];this.vertices[n]=o*r-s*i,this.vertices[n+1]=o*i+s*r}}scale(t,r){throw new Error("Method not implemented.")}translate(t,r){throw new Error("Method not implemented.")}clone(){throw new Error("Method not implemented.")}getVertexCount(){return this.vertices.length/2}}class Zy extends I_{constructor(t){super(),this.mesh=t}tick(t,r){throw new Error("Method not implemented.")}getMesh(){return this.mesh}}class N_{}class tg{compile(t,r){const i=this.getSource(),n=t.createShader(t.VERTEX_SHADER);if(!n)throw new Error("Failed to create shader");t.shaderSource(n,i),t.compileShader(n);const o=t.getShaderInfoLog(n);return o&&console.error("Error compiling shader:",o),t.attachShader(r,n),n}}class eg{compile(t,r){const i=this.getSource(),n=t.createShader(t.FRAGMENT_SHADER);if(!n)throw new Error("Failed to create shader");t.shaderSource(n,i),t.compileShader(n);const o=t.getShaderInfoLog(n);return o&&console.error("Error compiling shader:",o),t.attachShader(r,n),n}}class rg extends tg{getAttributes(){return{a_position:0}}getUniforms(){return{u_viewProjection:null,u_translation:null,u_size:null,u_rotation:null}}getSource(){return`#version 300 es
        precision highp float;
        layout(location=0) in vec2 a_position;           // quad vertex (-1..1)
        uniform mat3 u_viewProjection;                   // camera VP
        uniform vec2 u_translation;                      // world position
        uniform float u_size;                            // half size
        uniform float u_rotation;                        // rotation in radians
        void main() {
            float c = cos(u_rotation);
            float s = sin(u_rotation);
            vec2 rotated = vec2(
                a_position.x * c - a_position.y * s,
                a_position.x * s + a_position.y * c
            );
            vec2 worldPos = rotated * u_size + u_translation;
            vec3 clip = u_viewProjection * vec3(worldPos, 1.0);
            gl_Position = vec4(clip.xy, 0.0, 1.0);
        }`}}class ig extends eg{getSource(){return`#version 300 es
        precision mediump float;
        uniform vec4 u_color;
        out vec4 outColor;
        void main() {
                outColor = u_color;
        }`}getUniforms(){return{}}}var ng=Object.getOwnPropertyDescriptor,og=(e,t,r,i)=>{for(var n=i>1?void 0:i?ng(t,r):t,o=e.length-1,s;o>=0;o--)(s=e[o])&&(n=s(n)||n);return n};let im=class extends N_{constructor(){super(...arguments),this.vertexShader=new rg,this.fragmentShader=new ig,this.shaderProgram=null,this.positionBuffer=null,this.locations={},this.resourcesInitialized=!1,this.fallbackQuad=new Ky,this.meshCache=new WeakMap,this.debugVAO=null}ensureResources(e){if(this.resourcesInitialized)return;if(this.shaderProgram=e.createProgram(),!this.shaderProgram)throw new Error("Failed to create shader program");if(this.vertexShader.compile(e,this.shaderProgram),this.fragmentShader.compile(e,this.shaderProgram),e.linkProgram(this.shaderProgram),!e.getProgramParameter(this.shaderProgram,e.LINK_STATUS)){const r=e.getProgramInfoLog(this.shaderProgram);console.error("Error linking program:",r)}if(this.positionBuffer=e.createBuffer(),e.useProgram(this.shaderProgram),this.locations.viewProj=e.getUniformLocation(this.shaderProgram,"u_viewProjection"),this.locations.translation=e.getUniformLocation(this.shaderProgram,"u_translation"),this.locations.size=e.getUniformLocation(this.shaderProgram,"u_size"),this.locations.rotation=e.getUniformLocation(this.shaderProgram,"u_rotation"),this.locations.color=e.getUniformLocation(this.shaderProgram,"u_color"),this.debugVAO=e.createVertexArray(),!this.debugVAO)throw new Error("Failed to create debug VAO");e.bindVertexArray(this.debugVAO),e.bindBuffer(e.ARRAY_BUFFER,this.positionBuffer),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindVertexArray(null),this.resourcesInitialized=!0}bindMesh(e,t){const r=this.meshCache.get(t);if(r)return r.vao?e.bindVertexArray(r.vao):(e.bindBuffer(e.ARRAY_BUFFER,r.vbo),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,2,e.FLOAT,!1,0,0),r.ibo&&r.indexCount>0?e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r.ibo):e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),{indexed:r.indexCount>0,count:r.indexCount>0?r.indexCount:r.vertexCount};const i=e.createBuffer();if(!i)throw new Error("Failed to create VBO");e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,t.vertices,e.STATIC_DRAW);let n=null;if(t.indices.length>0){if(n=e.createBuffer(),!n)throw new Error("Failed to create IBO");e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n),e.bufferData(e.ELEMENT_ARRAY_BUFFER,t.indices,e.STATIC_DRAW)}const o=e.createVertexArray();if(!o)throw new Error("Failed to create VAO");e.bindVertexArray(o),e.bindBuffer(e.ARRAY_BUFFER,i),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,2,e.FLOAT,!1,0,0),n&&t.indices.length>0?e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n):e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindVertexArray(null);const s=t.getVertexCount?t.getVertexCount():t.vertices.length/2,a=t.indices.length;return this.meshCache.set(t,{vbo:i,ibo:n,vao:o,vertexCount:s,indexCount:a}),e.bindVertexArray(o),{indexed:a>0,count:a>0?a:s}}render(e,t,r,i){if(!t||(this.ensureResources(r),!this.shaderProgram||!this.positionBuffer))return;const n=e.getComponentsOfType(Zy)[0],o=(n==null?void 0:n.getMesh())??this.fallbackQuad,s=this.bindMesh(r,o),a=r.canvas.width/r.canvas.height,l=t.getViewProjectionMatrix(a).elements,c=e.getPosition(),h=1,m=e.getRotation();r.useProgram(this.shaderProgram),this.setShaderProperties(r,l,c,h,m),s.indexed?r.drawElements(r.TRIANGLES,s.count,r.UNSIGNED_SHORT,0):r.drawArrays(r.TRIANGLE_STRIP,0,s.count)}setShaderProperties(e,t,r,i,n){this.locations.viewProj&&e.uniformMatrix3fv(this.locations.viewProj,!1,t),this.locations.translation&&e.uniform2f(this.locations.translation,r.x,r.y),this.locations.size&&e.uniform1f(this.locations.size,i),this.locations.rotation&&e.uniform1f(this.locations.rotation,n),this.locations.color&&e.uniform4f(this.locations.color,1,0,0,1)}renderDebug(e,t,r){var s,a;if(!this.resourcesInitialized||!this.shaderProgram||!this.positionBuffer||!this.debugVAO||!t||!e.body)return;const i=(a=(s=e.body).getBoundingVolumes)==null?void 0:a.call(s);if(!i||i.length===0)return;const n=r.canvas.width/r.canvas.height,o=t.getViewProjectionMatrix(n).elements;r.useProgram(this.shaderProgram),this.locations.viewProj&&r.uniformMatrix3fv(this.locations.viewProj,!1,o),this.locations.translation&&r.uniform2f(this.locations.translation,0,0),this.locations.size&&r.uniform1f(this.locations.size,1),this.locations.rotation&&r.uniform1f(this.locations.rotation,0),this.locations.color&&r.uniform4f(this.locations.color,0,.5,1,1),r.bindVertexArray(this.debugVAO);for(const l of i){const c=l.getWorldVertices();if(!c||c.length===0)continue;const h=new Float32Array(c.length*2);for(let m=0;m<c.length;m++)h[m*2]=c[m].x,h[m*2+1]=c[m].y;r.bindBuffer(r.ARRAY_BUFFER,this.positionBuffer),r.bufferData(r.ARRAY_BUFFER,h,r.DYNAMIC_DRAW),r.vertexAttribPointer(0,2,r.FLOAT,!1,0,0),r.drawArrays(r.LINE_LOOP,0,c.length)}r.bindVertexArray(null),this.locations.color&&r.uniform4f(this.locations.color,1,0,0,1)}};im=og([E_(at)],im);const sg=({title:e})=>tr("header",{id:"header",children:tr("h1",{children:e})}),R_=Ae.createContext(null),ag=()=>{const e=Cd.useContext(R_),[t,r]=Ae.useState(0);return Ae.useEffect(()=>{const i=e.onAfterRender(()=>{r(e.getFPS())});return()=>e.offAfterRender(i)},[e]),tr(bf,{children:Mf("p",{children:["FPS: ",t.toFixed(0),", Actors: ",e==null?void 0:e.getActorsCount()]})})};/**
 * Planck.js v1.4.2
 * @license The MIT license
 * @copyright Copyright (c) 2025 Erin Catto, Ali Shakiba
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Lu=function(e,t){return Lu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])},Lu(e,t)};function Zt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Lu(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Kt=function(){return Kt=Object.assign||function(t){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},Kt.apply(this,arguments)},Me=function(e,t){(e===null||typeof e>"u")&&(e={});var r=Kt({},e);for(var i in t)t.hasOwnProperty(i)&&typeof e[i]>"u"&&(r[i]=t[i]);if(typeof Object.getOwnPropertySymbols=="function")for(var n=Object.getOwnPropertySymbols(t),o=0;o<n.length;o++){var s=n[o];t.propertyIsEnumerable(s)&&typeof e[s]>"u"&&(r[s]=t[s])}return r},lg=Math.random,ie=1e-9,ug=Number.isFinite;function cg(e){return e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e+1}function hg(e){return e>0&&(e&e-1)===0}function D_(e,t,r){return typeof t>"u"?(r=1,t=0):typeof r>"u"&&(r=t,t=0),r>t?(e=(e-t)%(r-t),e+(e<0?r:t)):(e=(e-r)%(t-r),e+(e<=0?t:r))}function qt(e,t,r){return e<t?t:e>r?r:e}function mg(e,t){return typeof e>"u"?(t=1,e=0):typeof t>"u"&&(t=e,e=0),e===t?e:lg()*(t-e)+e}var Zi=Object.create(Math);Zi.EPSILON=ie;Zi.isFinite=ug;Zi.nextPowerOfTwo=cg;Zi.isPowerOfTwo=hg;Zi.mod=D_;Zi.clamp=qt;Zi.random=mg;var nm=Math.abs,Bl=Math.sqrt,om=Math.max,sm=Math.min,u=function(){function e(t,r){if(!(this instanceof e))return new e(t,r);typeof t>"u"?(this.x=0,this.y=0):typeof t=="object"?(this.x=t.x,this.y=t.y):(this.x=t,this.y=r)}return e.prototype._serialize=function(){return{x:this.x,y:this.y}},e._deserialize=function(t){var r=Object.create(e.prototype);return r.x=t.x,r.y=t.y,r},e.zero=function(){var t=Object.create(e.prototype);return t.x=0,t.y=0,t},e.neo=function(t,r){var i=Object.create(e.prototype);return i.x=t,i.y=r,i},e.clone=function(t){return e.neo(t.x,t.y)},e.prototype.toString=function(){return JSON.stringify(this)},e.isValid=function(t){return t===null||typeof t>"u"?!1:Number.isFinite(t.x)&&Number.isFinite(t.y)},e.assert=function(t){},e.prototype.clone=function(){return e.clone(this)},e.prototype.setZero=function(){return this.x=0,this.y=0,this},e.prototype.set=function(t,r){return typeof t=="object"?(this.x=t.x,this.y=t.y):(this.x=t,this.y=r),this},e.prototype.setNum=function(t,r){return this.x=t,this.y=r,this},e.prototype.setVec2=function(t){return this.x=t.x,this.y=t.y,this},e.prototype.wSet=function(t,r,i,n){return typeof i<"u"||typeof n<"u"?this.setCombine(t,r,i,n):this.setMul(t,r)},e.prototype.setCombine=function(t,r,i,n){var o=t*r.x+i*n.x,s=t*r.y+i*n.y;return this.x=o,this.y=s,this},e.prototype.setMul=function(t,r){var i=t*r.x,n=t*r.y;return this.x=i,this.y=n,this},e.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},e.prototype.wAdd=function(t,r,i,n){return typeof i<"u"||typeof n<"u"?this.addCombine(t,r,i,n):this.addMul(t,r)},e.prototype.addCombine=function(t,r,i,n){var o=t*r.x+i*n.x,s=t*r.y+i*n.y;return this.x+=o,this.y+=s,this},e.prototype.addMul=function(t,r){var i=t*r.x,n=t*r.y;return this.x+=i,this.y+=n,this},e.prototype.wSub=function(t,r,i,n){return typeof i<"u"||typeof n<"u"?this.subCombine(t,r,i,n):this.subMul(t,r)},e.prototype.subCombine=function(t,r,i,n){var o=t*r.x+i*n.x,s=t*r.y+i*n.y;return this.x-=o,this.y-=s,this},e.prototype.subMul=function(t,r){var i=t*r.x,n=t*r.y;return this.x-=i,this.y-=n,this},e.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},e.prototype.mul=function(t){return this.x*=t,this.y*=t,this},e.prototype.length=function(){return e.lengthOf(this)},e.prototype.lengthSquared=function(){return e.lengthSquared(this)},e.prototype.normalize=function(){var t=this.length();if(t<ie)return 0;var r=1/t;return this.x*=r,this.y*=r,t},e.normalize=function(t){var r=e.lengthOf(t);if(r<ie)return e.zero();var i=1/r;return e.neo(t.x*i,t.y*i)},e.lengthOf=function(t){return Bl(t.x*t.x+t.y*t.y)},e.lengthSquared=function(t){return t.x*t.x+t.y*t.y},e.distance=function(t,r){var i=t.x-r.x,n=t.y-r.y;return Bl(i*i+n*n)},e.distanceSquared=function(t,r){var i=t.x-r.x,n=t.y-r.y;return i*i+n*n},e.areEqual=function(t,r){return t===r||typeof r=="object"&&r!==null&&t.x===r.x&&t.y===r.y},e.skew=function(t){return e.neo(-t.y,t.x)},e.dot=function(t,r){return t.x*r.x+t.y*r.y},e.cross=function(t,r){return typeof r=="number"?e.neo(r*t.y,-r*t.x):typeof t=="number"?e.neo(-t*r.y,t*r.x):t.x*r.y-t.y*r.x},e.crossVec2Vec2=function(t,r){return t.x*r.y-t.y*r.x},e.crossVec2Num=function(t,r){return e.neo(r*t.y,-r*t.x)},e.crossNumVec2=function(t,r){return e.neo(-t*r.y,t*r.x)},e.addCross=function(t,r,i){if(typeof i=="number")return e.neo(i*r.y+t.x,-i*r.x+t.y);if(typeof r=="number")return e.neo(-r*i.y+t.x,r*i.x+t.y)},e.addCrossVec2Num=function(t,r,i){return e.neo(i*r.y+t.x,-i*r.x+t.y)},e.addCrossNumVec2=function(t,r,i){return e.neo(-r*i.y+t.x,r*i.x+t.y)},e.add=function(t,r){return e.neo(t.x+r.x,t.y+r.y)},e.wAdd=function(t,r,i,n){return typeof i<"u"||typeof n<"u"?e.combine(t,r,i,n):e.mulNumVec2(t,r)},e.combine=function(t,r,i,n){return e.zero().setCombine(t,r,i,n)},e.sub=function(t,r){return e.neo(t.x-r.x,t.y-r.y)},e.mul=function(t,r){if(typeof t=="object")return e.neo(t.x*r,t.y*r);if(typeof r=="object")return e.neo(t*r.x,t*r.y)},e.mulVec2Num=function(t,r){return e.neo(t.x*r,t.y*r)},e.mulNumVec2=function(t,r){return e.neo(t*r.x,t*r.y)},e.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this},e.neg=function(t){return e.neo(-t.x,-t.y)},e.abs=function(t){return e.neo(nm(t.x),nm(t.y))},e.mid=function(t,r){return e.neo((t.x+r.x)*.5,(t.y+r.y)*.5)},e.upper=function(t,r){return e.neo(om(t.x,r.x),om(t.y,r.y))},e.lower=function(t,r){return e.neo(sm(t.x,r.x),sm(t.y,r.y))},e.prototype.clamp=function(t){var r=this.x*this.x+this.y*this.y;if(r>t*t){var i=t/Bl(r);this.x*=i,this.y*=i}return this},e.clamp=function(t,r){var i=e.neo(t.x,t.y);return i.clamp(r),i},e.clampVec2=function(t,r,i){return{x:qt(t.x,r==null?void 0:r.x,i==null?void 0:i.x),y:qt(t.y,r==null?void 0:r.y,i==null?void 0:i.y)}},e.scaleFn=function(t,r){return function(i){return e.neo(i.x*t,i.y*r)}},e.translateFn=function(t,r){return function(i){return e.neo(i.x+t,i.y+r)}},e}(),Te=Math.max,ke=Math.min,Rt=function(){function e(t,r){if(!(this instanceof e))return new e(t,r);this.lowerBound=u.zero(),this.upperBound=u.zero(),typeof t=="object"&&this.lowerBound.setVec2(t),typeof r=="object"?this.upperBound.setVec2(r):typeof t=="object"&&this.upperBound.setVec2(t)}return e.prototype.isValid=function(){return e.isValid(this)},e.isValid=function(t){return t===null||typeof t>"u"?!1:u.isValid(t.lowerBound)&&u.isValid(t.upperBound)&&u.sub(t.upperBound,t.lowerBound).lengthSquared()>=0},e.assert=function(t){},e.prototype.getCenter=function(){return u.neo((this.lowerBound.x+this.upperBound.x)*.5,(this.lowerBound.y+this.upperBound.y)*.5)},e.prototype.getExtents=function(){return u.neo((this.upperBound.x-this.lowerBound.x)*.5,(this.upperBound.y-this.lowerBound.y)*.5)},e.prototype.getPerimeter=function(){return 2*(this.upperBound.x-this.lowerBound.x+this.upperBound.y-this.lowerBound.y)},e.prototype.combine=function(t,r){r=r||this;var i=t.lowerBound,n=t.upperBound,o=r.lowerBound,s=r.upperBound,a=ke(i.x,o.x),l=ke(i.y,o.y),c=Te(s.x,n.x),h=Te(s.y,n.y);this.lowerBound.setNum(a,l),this.upperBound.setNum(c,h)},e.prototype.combinePoints=function(t,r){this.lowerBound.setNum(ke(t.x,r.x),ke(t.y,r.y)),this.upperBound.setNum(Te(t.x,r.x),Te(t.y,r.y))},e.prototype.set=function(t){this.lowerBound.setNum(t.lowerBound.x,t.lowerBound.y),this.upperBound.setNum(t.upperBound.x,t.upperBound.y)},e.prototype.contains=function(t){var r=!0;return r=r&&this.lowerBound.x<=t.lowerBound.x,r=r&&this.lowerBound.y<=t.lowerBound.y,r=r&&t.upperBound.x<=this.upperBound.x,r=r&&t.upperBound.y<=this.upperBound.y,r},e.prototype.extend=function(t){return e.extend(this,t),this},e.extend=function(t,r){return t.lowerBound.x-=r,t.lowerBound.y-=r,t.upperBound.x+=r,t.upperBound.y+=r,t},e.testOverlap=function(t,r){var i=r.lowerBound.x-t.upperBound.x,n=t.lowerBound.x-r.upperBound.x,o=r.lowerBound.y-t.upperBound.y,s=t.lowerBound.y-r.upperBound.y;return!(i>0||o>0||n>0||s>0)},e.areEqual=function(t,r){return u.areEqual(t.lowerBound,r.lowerBound)&&u.areEqual(t.upperBound,r.upperBound)},e.diff=function(t,r){var i=Te(0,ke(t.upperBound.x,r.upperBound.x)-Te(r.lowerBound.x,t.lowerBound.x)),n=Te(0,ke(t.upperBound.y,r.upperBound.y)-Te(r.lowerBound.y,t.lowerBound.y)),o=t.upperBound.x-t.lowerBound.x,s=t.upperBound.y-t.lowerBound.y,a=r.upperBound.x-r.lowerBound.x,l=r.upperBound.y-r.lowerBound.y;return o*s+a*l-i*n},e.prototype.rayCast=function(t,r){var i=-1/0,n=1/0,o=r.p1,s=u.sub(r.p2,r.p1),a=u.abs(s),l=u.zero();if(a.x<ie){if(o.x<this.lowerBound.x||this.upperBound.x<o.x)return!1}else{var c=1/s.x,h=(this.lowerBound.x-o.x)*c,m=(this.upperBound.x-o.x)*c,f=-1;if(h>m){var p=h;h=m,m=p,f=1}if(h>i&&(l.setZero(),l.x=f,i=h),n=ke(n,m),i>n)return!1}if(a.y<ie){if(o.y<this.lowerBound.y||this.upperBound.y<o.y)return!1}else{var c=1/s.y,h=(this.lowerBound.y-o.y)*c,m=(this.upperBound.y-o.y)*c,f=-1;if(h>m){var p=h;h=m,m=p,f=1}if(h>i&&(l.setZero(),l.y=f,i=h),n=ke(n,m),i>n)return!1}return i<0||r.maxFraction<i?!1:(t.fraction=i,t.normal=l,!0)},e.prototype.toString=function(){return JSON.stringify(this)},e.combinePoints=function(t,r,i){return t.lowerBound.x=ke(r.x,i.x),t.lowerBound.y=ke(r.y,i.y),t.upperBound.x=Te(r.x,i.x),t.upperBound.y=Te(r.y,i.y),t},e.combinedPerimeter=function(t,r){var i=ke(t.lowerBound.x,r.lowerBound.x),n=ke(t.lowerBound.y,r.lowerBound.y),o=Te(t.upperBound.x,r.upperBound.x),s=Te(t.upperBound.y,r.upperBound.y);return 2*(o-i+s-n)},e}(),gs=Math.PI,Y=function(){function e(){}return Object.defineProperty(e,"polygonRadius",{get:function(){return 2*e.linearSlop},enumerable:!1,configurable:!0}),e.lengthUnitsPerMeter=1,e.maxManifoldPoints=2,e.maxPolygonVertices=12,e.aabbExtension=.1,e.aabbMultiplier=2,e.linearSlop=.005,e.angularSlop=2/180*gs,e.maxSubSteps=8,e.maxTOIContacts=32,e.maxTOIIterations=20,e.maxDistanceIterations=20,e.velocityThreshold=1,e.maxLinearCorrection=.2,e.maxAngularCorrection=8/180*gs,e.maxTranslation=2,e.maxRotation=.5*gs,e.baumgarte=.2,e.toiBaugarte=.75,e.timeToSleep=.5,e.linearSleepTolerance=.01,e.angularSleepTolerance=2/180*gs,e}(),z=function(){function e(){}return Object.defineProperty(e,"maxManifoldPoints",{get:function(){return Y.maxManifoldPoints},enumerable:!1,configurable:!0}),Object.defineProperty(e,"maxPolygonVertices",{get:function(){return Y.maxPolygonVertices},enumerable:!1,configurable:!0}),Object.defineProperty(e,"aabbExtension",{get:function(){return Y.aabbExtension*Y.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(e,"aabbMultiplier",{get:function(){return Y.aabbMultiplier},enumerable:!1,configurable:!0}),Object.defineProperty(e,"linearSlop",{get:function(){return Y.linearSlop*Y.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(e,"linearSlopSquared",{get:function(){return Y.linearSlop*Y.lengthUnitsPerMeter*Y.linearSlop*Y.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(e,"angularSlop",{get:function(){return Y.angularSlop},enumerable:!1,configurable:!0}),Object.defineProperty(e,"polygonRadius",{get:function(){return 2*Y.linearSlop},enumerable:!1,configurable:!0}),Object.defineProperty(e,"maxSubSteps",{get:function(){return Y.maxSubSteps},enumerable:!1,configurable:!0}),Object.defineProperty(e,"maxTOIContacts",{get:function(){return Y.maxTOIContacts},enumerable:!1,configurable:!0}),Object.defineProperty(e,"maxTOIIterations",{get:function(){return Y.maxTOIIterations},enumerable:!1,configurable:!0}),Object.defineProperty(e,"maxDistanceIterations",{get:function(){return Y.maxDistanceIterations},enumerable:!1,configurable:!0}),Object.defineProperty(e,"velocityThreshold",{get:function(){return Y.velocityThreshold*Y.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(e,"maxLinearCorrection",{get:function(){return Y.maxLinearCorrection*Y.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(e,"maxAngularCorrection",{get:function(){return Y.maxAngularCorrection},enumerable:!1,configurable:!0}),Object.defineProperty(e,"maxTranslation",{get:function(){return Y.maxTranslation*Y.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(e,"maxTranslationSquared",{get:function(){return Y.maxTranslation*Y.lengthUnitsPerMeter*Y.maxTranslation*Y.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(e,"maxRotation",{get:function(){return Y.maxRotation},enumerable:!1,configurable:!0}),Object.defineProperty(e,"maxRotationSquared",{get:function(){return Y.maxRotation*Y.maxRotation},enumerable:!1,configurable:!0}),Object.defineProperty(e,"baumgarte",{get:function(){return Y.baumgarte},enumerable:!1,configurable:!0}),Object.defineProperty(e,"toiBaugarte",{get:function(){return Y.toiBaugarte},enumerable:!1,configurable:!0}),Object.defineProperty(e,"timeToSleep",{get:function(){return Y.timeToSleep},enumerable:!1,configurable:!0}),Object.defineProperty(e,"linearSleepTolerance",{get:function(){return Y.linearSleepTolerance*Y.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(e,"linearSleepToleranceSqr",{get:function(){return Y.linearSleepTolerance*Y.lengthUnitsPerMeter*Y.linearSleepTolerance*Y.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(e,"angularSleepTolerance",{get:function(){return Y.angularSleepTolerance},enumerable:!1,configurable:!0}),Object.defineProperty(e,"angularSleepToleranceSqr",{get:function(){return Y.angularSleepTolerance*Y.angularSleepTolerance},enumerable:!1,configurable:!0}),e}(),Mo=function(){function e(t){this._list=[],this._max=1/0,this._hasCreateFn=!1,this._createCount=0,this._hasAllocateFn=!1,this._allocateCount=0,this._hasReleaseFn=!1,this._releaseCount=0,this._hasDisposeFn=!1,this._disposeCount=0,this._list=[],this._max=t.max||this._max,this._createFn=t.create,this._hasCreateFn=typeof this._createFn=="function",this._allocateFn=t.allocate,this._hasAllocateFn=typeof this._allocateFn=="function",this._releaseFn=t.release,this._hasReleaseFn=typeof this._releaseFn=="function",this._disposeFn=t.dispose,this._hasDisposeFn=typeof this._disposeFn=="function"}return e.prototype.max=function(t){return typeof t=="number"?(this._max=t,this):this._max},e.prototype.size=function(){return this._list.length},e.prototype.allocate=function(){var t;return this._list.length>0?t=this._list.shift():(this._createCount++,this._hasCreateFn?t=this._createFn():t={}),this._allocateCount++,this._hasAllocateFn&&this._allocateFn(t),t},e.prototype.release=function(t){this._list.length<this._max?(this._releaseCount++,this._hasReleaseFn&&this._releaseFn(t),this._list.push(t)):(this._disposeCount++,this._hasDisposeFn&&(t=this._disposeFn(t)))},e.prototype.toString=function(){return" +"+this._createCount+" >"+this._allocateCount+" <"+this._releaseCount+" -"+this._disposeCount+" ="+this._list.length+"/"+this._max},e}(),am=Math.abs,de=Math.max,fg=function(){function e(t){this.aabb=new Rt,this.userData=null,this.parent=null,this.child1=null,this.child2=null,this.height=-1,this.id=t}return e.prototype.toString=function(){return this.id+": "+this.userData},e.prototype.isLeaf=function(){return this.child1==null},e}(),lm=new Mo({create:function(){return new fg},release:function(e){e.userData=null,e.parent=null,e.child1=null,e.child2=null,e.height=-1,e.id=void 0}}),pg=function(){function e(){this.inputPool=new Mo({create:function(){return{}},release:function(t){}}),this.stackPool=new Mo({create:function(){return[]},release:function(t){t.length=0}}),this.iteratorPool=new Mo({create:function(){return new _g},release:function(t){t.close()}}),this.m_root=null,this.m_nodes={},this.m_lastProxyId=0}return e.prototype.getUserData=function(t){var r=this.m_nodes[t];return r.userData},e.prototype.getFatAABB=function(t){var r=this.m_nodes[t];return r.aabb},e.prototype.allocateNode=function(){var t=lm.allocate();return t.id=++this.m_lastProxyId,this.m_nodes[t.id]=t,t},e.prototype.freeNode=function(t){delete this.m_nodes[t.id],lm.release(t)},e.prototype.createProxy=function(t,r){var i=this.allocateNode();return i.aabb.set(t),Rt.extend(i.aabb,z.aabbExtension),i.userData=r,i.height=0,this.insertLeaf(i),i.id},e.prototype.destroyProxy=function(t){var r=this.m_nodes[t];this.removeLeaf(r),this.freeNode(r)},e.prototype.moveProxy=function(t,r,i){var n=this.m_nodes[t];return n.aabb.contains(r)?!1:(this.removeLeaf(n),n.aabb.set(r),r=n.aabb,Rt.extend(r,z.aabbExtension),i.x<0?r.lowerBound.x+=i.x*z.aabbMultiplier:r.upperBound.x+=i.x*z.aabbMultiplier,i.y<0?r.lowerBound.y+=i.y*z.aabbMultiplier:r.upperBound.y+=i.y*z.aabbMultiplier,this.insertLeaf(n),!0)},e.prototype.insertLeaf=function(t){if(this.m_root==null){this.m_root=t,this.m_root.parent=null;return}for(var r=t.aabb,i=this.m_root;!i.isLeaf();){var n=i.child1,o=i.child2,s=i.aabb.getPerimeter(),a=Rt.combinedPerimeter(i.aabb,r),l=2*a,c=2*(a-s),h=Rt.combinedPerimeter(r,n.aabb),m=h+c;if(!n.isLeaf()){var f=n.aabb.getPerimeter();m-=f}var p=Rt.combinedPerimeter(r,o.aabb),_=p+c;if(!o.isLeaf()){var f=o.aabb.getPerimeter();_-=f}if(l<m&&l<_)break;m<_?i=n:i=o}var d=i,x=d.parent,v=this.allocateNode();for(v.parent=x,v.userData=null,v.aabb.combine(r,d.aabb),v.height=d.height+1,x!=null?(x.child1===d?x.child1=v:x.child2=v,v.child1=d,v.child2=t,d.parent=v,t.parent=v):(v.child1=d,v.child2=t,d.parent=v,t.parent=v,this.m_root=v),i=t.parent;i!=null;){i=this.balance(i);var n=i.child1,o=i.child2;i.height=1+de(n.height,o.height),i.aabb.combine(n.aabb,o.aabb),i=i.parent}},e.prototype.removeLeaf=function(t){if(t===this.m_root){this.m_root=null;return}var r=t.parent,i=r.parent,n;if(r.child1===t?n=r.child2:n=r.child1,i!=null){i.child1===r?i.child1=n:i.child2=n,n.parent=i,this.freeNode(r);for(var o=i;o!=null;){o=this.balance(o);var s=o.child1,a=o.child2;o.aabb.combine(s.aabb,a.aabb),o.height=1+de(s.height,a.height),o=o.parent}}else this.m_root=n,n.parent=null,this.freeNode(r)},e.prototype.balance=function(t){var r=t;if(r.isLeaf()||r.height<2)return t;var i=r.child1,n=r.child2,o=n.height-i.height;if(o>1){var s=n.child1,a=n.child2;return n.child1=r,n.parent=r.parent,r.parent=n,n.parent!=null?n.parent.child1===t?n.parent.child1=n:n.parent.child2=n:this.m_root=n,s.height>a.height?(n.child2=s,r.child2=a,a.parent=r,r.aabb.combine(i.aabb,a.aabb),n.aabb.combine(r.aabb,s.aabb),r.height=1+de(i.height,a.height),n.height=1+de(r.height,s.height)):(n.child2=a,r.child2=s,s.parent=r,r.aabb.combine(i.aabb,s.aabb),n.aabb.combine(r.aabb,a.aabb),r.height=1+de(i.height,s.height),n.height=1+de(r.height,a.height)),n}if(o<-1){var l=i.child1,c=i.child2;return i.child1=r,i.parent=r.parent,r.parent=i,i.parent!=null?i.parent.child1===r?i.parent.child1=i:i.parent.child2=i:this.m_root=i,l.height>c.height?(i.child2=l,r.child1=c,c.parent=r,r.aabb.combine(n.aabb,c.aabb),i.aabb.combine(r.aabb,l.aabb),r.height=1+de(n.height,c.height),i.height=1+de(r.height,l.height)):(i.child2=c,r.child1=l,l.parent=r,r.aabb.combine(n.aabb,l.aabb),i.aabb.combine(r.aabb,c.aabb),r.height=1+de(n.height,l.height),i.height=1+de(r.height,c.height)),i}return r},e.prototype.getHeight=function(){return this.m_root==null?0:this.m_root.height},e.prototype.getAreaRatio=function(){if(this.m_root==null)return 0;for(var t=this.m_root,r=t.aabb.getPerimeter(),i=0,n,o=this.iteratorPool.allocate().preorder(this.m_root);n=o.next();)n.height<0||(i+=n.aabb.getPerimeter());return this.iteratorPool.release(o),i/r},e.prototype.computeHeight=function(t){var r;if(typeof t<"u"?r=this.m_nodes[t]:r=this.m_root,r.isLeaf())return 0;var i=this.computeHeight(r.child1.id),n=this.computeHeight(r.child2.id);return 1+de(i,n)},e.prototype.validateStructure=function(t){if(t!=null){this.m_root;var r=t.child1,i=t.child2;t.isLeaf()||(this.validateStructure(r),this.validateStructure(i))}},e.prototype.validateMetrics=function(t){if(t!=null){var r=t.child1,i=t.child2;t.isLeaf()||(this.validateMetrics(r),this.validateMetrics(i))}},e.prototype.validate=function(){},e.prototype.getMaxBalance=function(){for(var t=0,r,i=this.iteratorPool.allocate().preorder(this.m_root);r=i.next();)if(!(r.height<=1)){var n=am(r.child2.height-r.child1.height);t=de(t,n)}return this.iteratorPool.release(i),t},e.prototype.rebuildBottomUp=function(){for(var t=[],r=0,i,n=this.iteratorPool.allocate().preorder(this.m_root);i=n.next();)i.height<0||(i.isLeaf()?(i.parent=null,t[r]=i,++r):this.freeNode(i));for(this.iteratorPool.release(n);r>1;){for(var o=1/0,s=-1,a=-1,l=0;l<r;++l)for(var c=t[l].aabb,h=l+1;h<r;++h){var m=t[h].aabb,f=Rt.combinedPerimeter(c,m);f<o&&(s=l,a=h,o=f)}var p=t[s],_=t[a],d=this.allocateNode();d.child1=p,d.child2=_,d.height=1+de(p.height,_.height),d.aabb.combine(p.aabb,_.aabb),d.parent=null,p.parent=d,_.parent=d,t[a]=t[r-1],t[s]=d,--r}this.m_root=t[0]},e.prototype.shiftOrigin=function(t){for(var r,i=this.iteratorPool.allocate().preorder(this.m_root);r=i.next();){var n=r.aabb;n.lowerBound.x-=t.x,n.lowerBound.y-=t.y,n.upperBound.x-=t.x,n.upperBound.y-=t.y}this.iteratorPool.release(i)},e.prototype.query=function(t,r){var i=this.stackPool.allocate();for(i.push(this.m_root);i.length>0;){var n=i.pop();if(n!=null&&Rt.testOverlap(n.aabb,t))if(n.isLeaf()){var o=r(n.id);if(o===!1)return}else i.push(n.child1),i.push(n.child2)}this.stackPool.release(i)},e.prototype.rayCast=function(t,r){var i=t.p1,n=t.p2,o=u.sub(n,i);o.normalize();var s=u.crossNumVec2(1,o),a=u.abs(s),l=t.maxFraction,c=new Rt,h=u.combine(1-l,i,l,n);c.combinePoints(i,h);var m=this.stackPool.allocate(),f=this.inputPool.allocate();for(m.push(this.m_root);m.length>0;){var p=m.pop();if(p!=null&&Rt.testOverlap(p.aabb,c)!==!1){var _=p.aabb.getCenter(),d=p.aabb.getExtents(),x=am(u.dot(s,u.sub(i,_)))-u.dot(a,d);if(!(x>0))if(p.isLeaf()){f.p1=u.clone(t.p1),f.p2=u.clone(t.p2),f.maxFraction=l;var v=r(f,p.id);if(v===0)break;v>0&&(l=v,h=u.combine(1-l,i,l,n),c.combinePoints(i,h))}else m.push(p.child1),m.push(p.child2)}}this.stackPool.release(m),this.inputPool.release(f)},e}(),_g=function(){function e(){this.parents=[],this.states=[]}return e.prototype.preorder=function(t){return this.parents.length=0,this.parents.push(t),this.states.length=0,this.states.push(0),this},e.prototype.next=function(){for(;this.parents.length>0;){var t=this.parents.length-1,r=this.parents[t];if(this.states[t]===0)return this.states[t]=1,r;if(this.states[t]===1&&(this.states[t]=2,r.child1))return this.parents.push(r.child1),this.states.push(1),r.child1;if(this.states[t]===2&&(this.states[t]=3,r.child2))return this.parents.push(r.child2),this.states.push(1),r.child2;this.parents.pop(),this.states.pop()}},e.prototype.close=function(){this.parents.length=0},e}(),dg=Math.max,vg=Math.min,yg=function(){function e(){var t=this;this.m_tree=new pg,this.m_moveBuffer=[],this.query=function(r,i){t.m_tree.query(r,i)},this.queryCallback=function(r){if(r===t.m_queryProxyId)return!0;var i=vg(r,t.m_queryProxyId),n=dg(r,t.m_queryProxyId),o=t.m_tree.getUserData(i),s=t.m_tree.getUserData(n);return t.m_callback(o,s),!0}}return e.prototype.getUserData=function(t){return this.m_tree.getUserData(t)},e.prototype.testOverlap=function(t,r){var i=this.m_tree.getFatAABB(t),n=this.m_tree.getFatAABB(r);return Rt.testOverlap(i,n)},e.prototype.getFatAABB=function(t){return this.m_tree.getFatAABB(t)},e.prototype.getProxyCount=function(){return this.m_moveBuffer.length},e.prototype.getTreeHeight=function(){return this.m_tree.getHeight()},e.prototype.getTreeBalance=function(){return this.m_tree.getMaxBalance()},e.prototype.getTreeQuality=function(){return this.m_tree.getAreaRatio()},e.prototype.rayCast=function(t,r){this.m_tree.rayCast(t,r)},e.prototype.shiftOrigin=function(t){this.m_tree.shiftOrigin(t)},e.prototype.createProxy=function(t,r){var i=this.m_tree.createProxy(t,r);return this.bufferMove(i),i},e.prototype.destroyProxy=function(t){this.unbufferMove(t),this.m_tree.destroyProxy(t)},e.prototype.moveProxy=function(t,r,i){var n=this.m_tree.moveProxy(t,r,i);n&&this.bufferMove(t)},e.prototype.touchProxy=function(t){this.bufferMove(t)},e.prototype.bufferMove=function(t){this.m_moveBuffer.push(t)},e.prototype.unbufferMove=function(t){for(var r=0;r<this.m_moveBuffer.length;++r)this.m_moveBuffer[r]===t&&(this.m_moveBuffer[r]=null)},e.prototype.updatePairs=function(t){for(this.m_callback=t;this.m_moveBuffer.length>0;)if(this.m_queryProxyId=this.m_moveBuffer.pop(),this.m_queryProxyId!==null){var r=this.m_tree.getFatAABB(this.m_queryProxyId);this.m_tree.query(r,this.queryCallback)}},e}(),O_=Math.sin,q_=Math.cos,Lc=Math.sqrt;function b(e,t){return{x:e,y:t}}function gg(e){return{s:O_(e),c:q_(e)}}function Ot(e,t,r){return e.x=t,e.y=r,e}function B(e,t){return e.x=t.x,e.y=t.y,e}function R(e){return e.x=0,e.y=0,e}function Jo(e){return e.x=-e.x,e.y=-e.y,e}function Ee(e,t){return e.x+=t.x,e.y+=t.y,e}function xg(e,t,r){return e.x=t.x+r.x,e.y=t.x+r.y,e}function Vr(e,t){return e.x-=t.x,e.y-=t.y,e}function $(e,t,r){return e.x=t.x-r.x,e.y=t.y-r.y,e}function um(e,t){return e.x*=t,e.y*=t,e}function D(e,t,r){return e.x=t*r.x,e.y=t*r.y,e}function er(e,t,r){return e.x+=t*r.x,e.y+=t*r.y,e}function yo(e,t,r){return e.x-=t*r.x,e.y-=t*r.y,e}function ft(e,t,r,i,n){return e.x=t*r.x+i*n.x,e.y=t*r.y+i*n.y,e}function dr(e,t,r,i,n,o,s){return e.x=t*r.x+i*n.x+o*s.x,e.y=t*r.y+i*n.y+o*s.y,e}function Ag(e){var t=Lc(e.x*e.x+e.y*e.y);if(t!==0){var r=1/t;e.x*=r,e.y*=r}return t}function nr(e){var t=Lc(e.x*e.x+e.y*e.y);if(t>0){var r=1/t;e.x*=r,e.y*=r}return e}function Ui(e,t,r){var i=r*t.y,n=-r*t.x;return e.x=i,e.y=n,e}function ge(e,t,r){var i=-t*r.y,n=t*r.x;return e.x=i,e.y=n,e}function J(e,t){return e.x*t.y-e.y*t.x}function V(e,t){return e.x*t.x+e.y*t.y}function $i(e){return e.x*e.x+e.y*e.y}function U_(e,t){var r=e.x-t.x,i=e.y-t.y;return Lc(r*r+i*i)}function ji(e,t){var r=e.x-t.x,i=e.y-t.y;return r*r+i*i}function wg(e,t){return e.c=q_(t),e.s=O_(t),e}function qe(e,t,r){return e.x=t.c*r.x-t.s*r.y,e.y=t.s*r.x+t.c*r.y,e}function kn(e,t,r){var i=t.c*r.x+t.s*r.y,n=-t.s*r.x+t.c*r.y;return e.x=i,e.y=n,e}function Bg(e,t,r,i){var n=t.c*i.x+t.s*i.y,o=-t.s*i.x+t.c*i.y,s=r.c*n-r.s*o,a=r.s*n+r.c*o;return e.x=s,e.y=a,e}function tn(e,t,r){return{p:b(e,t),q:gg(r)}}function Va(e,t){return e.p.x=t.p.x,e.p.y=t.p.y,e.q.s=t.q.s,e.q.c=t.q.c,e}function U(e,t,r){var i=t.q.c*r.x-t.q.s*r.y+t.p.x,n=t.q.s*r.x+t.q.c*r.y+t.p.y;return e.x=i,e.y=n,e}function Fc(e,t,r){var i=r.x-t.p.x,n=r.y-t.p.y,o=t.q.c*i+t.q.s*n,s=-t.q.s*i+t.q.c*n;return e.x=o,e.y=s,e}function $_(e,t,r,i){var n=t.q.c*i.x-t.q.s*i.y+t.p.x,o=t.q.s*i.x+t.q.c*i.y+t.p.y,s=n-r.p.x,a=o-r.p.y,l=r.q.c*s+r.q.s*a,c=-r.q.s*s+r.q.c*a;return e.x=l,e.y=c,e}function j_(e,t,r){var i=t.q.c*r.q.c+t.q.s*r.q.s,n=t.q.c*r.q.s-t.q.s*r.q.c,o=t.q.c*(r.p.x-t.p.x)+t.q.s*(r.p.y-t.p.y),s=-t.q.s*(r.p.x-t.p.x)+t.q.c*(r.p.y-t.p.y);return e.q.c=i,e.q.s=n,e.p.x=o,e.p.y=s,e}var cm=Math.sin,hm=Math.cos,Cg=Math.atan2,M=function(){function e(t){if(!(this instanceof e))return new e(t);typeof t=="number"?this.setAngle(t):typeof t=="object"?this.setRot(t):this.setIdentity()}return e.neo=function(t){var r=Object.create(e.prototype);return r.setAngle(t),r},e.clone=function(t){var r=Object.create(e.prototype);return r.s=t.s,r.c=t.c,r},e.identity=function(){var t=Object.create(e.prototype);return t.s=0,t.c=1,t},e.isValid=function(t){return t===null||typeof t>"u"?!1:Number.isFinite(t.s)&&Number.isFinite(t.c)},e.assert=function(t){},e.prototype.setIdentity=function(){this.s=0,this.c=1},e.prototype.set=function(t){typeof t=="object"?(this.s=t.s,this.c=t.c):(this.s=cm(t),this.c=hm(t))},e.prototype.setRot=function(t){this.s=t.s,this.c=t.c},e.prototype.setAngle=function(t){this.s=cm(t),this.c=hm(t)},e.prototype.getAngle=function(){return Cg(this.s,this.c)},e.prototype.getXAxis=function(){return u.neo(this.c,this.s)},e.prototype.getYAxis=function(){return u.neo(-this.s,this.c)},e.mul=function(t,r){if("c"in r&&"s"in r){var i=e.identity();return i.s=t.s*r.c+t.c*r.s,i.c=t.c*r.c-t.s*r.s,i}else if("x"in r&&"y"in r)return u.neo(t.c*r.x-t.s*r.y,t.s*r.x+t.c*r.y)},e.mulRot=function(t,r){var i=e.identity();return i.s=t.s*r.c+t.c*r.s,i.c=t.c*r.c-t.s*r.s,i},e.mulVec2=function(t,r){return u.neo(t.c*r.x-t.s*r.y,t.s*r.x+t.c*r.y)},e.mulSub=function(t,r,i){var n=t.c*(r.x-i.x)-t.s*(r.y-i.y),o=t.s*(r.x-i.x)+t.c*(r.y-i.y);return u.neo(n,o)},e.mulT=function(t,r){if("c"in r&&"s"in r){var i=e.identity();return i.s=t.c*r.s-t.s*r.c,i.c=t.c*r.c+t.s*r.s,i}else if("x"in r&&"y"in r)return u.neo(t.c*r.x+t.s*r.y,-t.s*r.x+t.c*r.y)},e.mulTRot=function(t,r){var i=e.identity();return i.s=t.c*r.s-t.s*r.c,i.c=t.c*r.c+t.s*r.s,i},e.mulTVec2=function(t,r){return u.neo(t.c*r.x+t.s*r.y,-t.s*r.x+t.c*r.y)},e}(),Sg=Math.atan2,mm=Math.PI,Ai=b(0,0),Wn=function(){function e(){this.localCenter=u.zero(),this.c=u.zero(),this.a=0,this.alpha0=0,this.c0=u.zero(),this.a0=0}return e.prototype.recycle=function(){R(this.localCenter),R(this.c),this.a=0,this.alpha0=0,R(this.c0),this.a0=0},e.prototype.setTransform=function(t){U(Ai,t,this.localCenter),B(this.c,Ai),B(this.c0,Ai),this.a=this.a0=Sg(t.q.s,t.q.c)},e.prototype.setLocalCenter=function(t,r){B(this.localCenter,t),U(Ai,r,this.localCenter),B(this.c,Ai),B(this.c0,Ai)},e.prototype.getTransform=function(t,r){r===void 0&&(r=0),wg(t.q,(1-r)*this.a0+r*this.a),ft(t.p,1-r,this.c0,r,this.c),Vr(t.p,qe(Ai,t.q,this.localCenter))},e.prototype.advance=function(t){var r=(t-this.alpha0)/(1-this.alpha0);ft(this.c0,r,this.c,1-r,this.c0),this.a0=r*this.a+(1-r)*this.a0,this.alpha0=t},e.prototype.forward=function(){this.a0=this.a,B(this.c0,this.c)},e.prototype.normalize=function(){var t=D_(this.a0,-mm,+mm);this.a-=this.a0-t,this.a0=t},e.prototype.set=function(t){B(this.localCenter,t.localCenter),B(this.c,t.c),this.a=t.a,this.alpha0=t.alpha0,B(this.c0,t.c0),this.a0=t.a0},e}(),or=function(){function e(t,r){if(!(this instanceof e))return new e(t,r);this.p=u.zero(),this.q=M.identity(),typeof t<"u"&&this.p.setVec2(t),typeof r<"u"&&this.q.setAngle(r)}return e.clone=function(t){var r=Object.create(e.prototype);return r.p=u.clone(t.p),r.q=M.clone(t.q),r},e.neo=function(t,r){var i=Object.create(e.prototype);return i.p=u.clone(t),i.q=M.clone(r),i},e.identity=function(){var t=Object.create(e.prototype);return t.p=u.zero(),t.q=M.identity(),t},e.prototype.setIdentity=function(){this.p.setZero(),this.q.setIdentity()},e.prototype.set=function(t,r){typeof r>"u"?(this.p.set(t.p),this.q.set(t.q)):(this.p.set(t),this.q.set(r))},e.prototype.setNum=function(t,r){this.p.setVec2(t),this.q.setAngle(r)},e.prototype.setTransform=function(t){this.p.setVec2(t.p),this.q.setRot(t.q)},e.isValid=function(t){return t===null||typeof t>"u"?!1:u.isValid(t.p)&&M.isValid(t.q)},e.assert=function(t){},e.mul=function(t,r){if(Array.isArray(r)){for(var i=[],n=0;n<r.length;n++)i[n]=e.mul(t,r[n]);return i}else{if("x"in r&&"y"in r)return e.mulVec2(t,r);if("p"in r&&"q"in r)return e.mulXf(t,r)}},e.mulAll=function(t,r){for(var i=[],n=0;n<r.length;n++)i[n]=e.mul(t,r[n]);return i},e.mulFn=function(t){return function(r){return e.mul(t,r)}},e.mulVec2=function(t,r){var i=t.q.c*r.x-t.q.s*r.y+t.p.x,n=t.q.s*r.x+t.q.c*r.y+t.p.y;return u.neo(i,n)},e.mulXf=function(t,r){var i=e.identity();return i.q=M.mulRot(t.q,r.q),i.p=u.add(M.mulVec2(t.q,r.p),t.p),i},e.mulT=function(t,r){if("x"in r&&"y"in r)return e.mulTVec2(t,r);if("p"in r&&"q"in r)return e.mulTXf(t,r)},e.mulTVec2=function(t,r){var i=r.x-t.p.x,n=r.y-t.p.y,o=t.q.c*i+t.q.s*n,s=-t.q.s*i+t.q.c*n;return u.neo(o,s)},e.mulTXf=function(t,r){var i=e.identity();return i.q.setRot(M.mulTRot(t.q,r.q)),i.p.setVec2(M.mulTVec2(t.q,u.sub(r.p,t.p))),i},e}(),Pg=function(){function e(){this.v=u.zero(),this.w=0}return e}(),W_=Math.sin,H_=Math.cos,bg=function(){function e(){this.c=u.zero(),this.a=0}return e.prototype.getTransform=function(t,r){return t.q.c=H_(this.a),t.q.s=W_(this.a),t.p.x=this.c.x-(t.q.c*r.x-t.q.s*r.y),t.p.y=this.c.y-(t.q.s*r.x+t.q.c*r.y),t},e}();function xs(e,t,r,i){return e.q.c=H_(i),e.q.s=W_(i),e.p.x=r.x-(e.q.c*t.x-e.q.s*t.y),e.p.y=r.y-(e.q.s*t.x+e.q.c*t.y),e}var en=function(){function e(){this.style={},this.appData={}}return e.isValid=function(t){return t===null||typeof t>"u"?!1:typeof t.m_type=="string"&&typeof t.m_radius=="number"},e}(),fm=new Rt,pm=new Rt,_m=b(0,0),Mg={userData:null,friction:.2,restitution:0,density:0,isSensor:!1,filterGroupIndex:0,filterCategoryBits:1,filterMaskBits:65535},dm=function(){function e(t,r){this.aabb=new Rt,this.fixture=t,this.childIndex=r}return e}(),Ta=function(){function e(t,r,i){this.style={},this.appData={},r.shape?(i=r,r=r.shape):typeof i=="number"&&(i={density:i}),i=Me(i,Mg),this.m_body=t,this.m_friction=i.friction,this.m_restitution=i.restitution,this.m_density=i.density,this.m_isSensor=i.isSensor,this.m_filterGroupIndex=i.filterGroupIndex,this.m_filterCategoryBits=i.filterCategoryBits,this.m_filterMaskBits=i.filterMaskBits,this.m_shape=r,this.m_next=null,this.m_proxies=[],this.m_proxyCount=0;for(var n=this.m_shape.getChildCount(),o=0;o<n;++o)this.m_proxies[o]=new dm(this,o);this.m_userData=i.userData,typeof i.style=="object"&&i.style!==null&&(this.style=i.style)}return e.prototype._reset=function(){var t=this.getBody(),r=t.m_world.m_broadPhase;this.destroyProxies(r),this.m_shape._reset&&this.m_shape._reset();for(var i=this.m_shape.getChildCount(),n=0;n<i;++n)this.m_proxies[n]=new dm(this,n);this.createProxies(r,t.m_xf),t.resetMassData()},e.prototype._serialize=function(){return{friction:this.m_friction,restitution:this.m_restitution,density:this.m_density,isSensor:this.m_isSensor,filterGroupIndex:this.m_filterGroupIndex,filterCategoryBits:this.m_filterCategoryBits,filterMaskBits:this.m_filterMaskBits,shape:this.m_shape}},e._deserialize=function(t,r,i){var n=i(en,t.shape),o=n&&new e(r,n,t);return o},e.prototype.getType=function(){return this.m_shape.m_type},e.prototype.getShape=function(){return this.m_shape},e.prototype.isSensor=function(){return this.m_isSensor},e.prototype.setSensor=function(t){t!=this.m_isSensor&&(this.m_body.setAwake(!0),this.m_isSensor=t)},e.prototype.getUserData=function(){return this.m_userData},e.prototype.setUserData=function(t){this.m_userData=t},e.prototype.getBody=function(){return this.m_body},e.prototype.getNext=function(){return this.m_next},e.prototype.getDensity=function(){return this.m_density},e.prototype.setDensity=function(t){this.m_density=t},e.prototype.getFriction=function(){return this.m_friction},e.prototype.setFriction=function(t){this.m_friction=t},e.prototype.getRestitution=function(){return this.m_restitution},e.prototype.setRestitution=function(t){this.m_restitution=t},e.prototype.testPoint=function(t){return this.m_shape.testPoint(this.m_body.getTransform(),t)},e.prototype.rayCast=function(t,r,i){return this.m_shape.rayCast(t,r,this.m_body.getTransform(),i)},e.prototype.getMassData=function(t){this.m_shape.computeMass(t,this.m_density)},e.prototype.getAABB=function(t){return this.m_proxies[t].aabb},e.prototype.createProxies=function(t,r){this.m_proxyCount=this.m_shape.getChildCount();for(var i=0;i<this.m_proxyCount;++i){var n=this.m_proxies[i];this.m_shape.computeAABB(n.aabb,r,i),n.proxyId=t.createProxy(n.aabb,n)}},e.prototype.destroyProxies=function(t){for(var r=0;r<this.m_proxyCount;++r){var i=this.m_proxies[r];t.destroyProxy(i.proxyId),i.proxyId=null}this.m_proxyCount=0},e.prototype.synchronize=function(t,r,i){for(var n=0;n<this.m_proxyCount;++n){var o=this.m_proxies[n];this.m_shape.computeAABB(fm,r,o.childIndex),this.m_shape.computeAABB(pm,i,o.childIndex),o.aabb.combine(fm,pm),$(_m,i.p,r.p),t.moveProxy(o.proxyId,o.aabb,_m)}},e.prototype.setFilterData=function(t){this.m_filterGroupIndex=t.groupIndex,this.m_filterCategoryBits=t.categoryBits,this.m_filterMaskBits=t.maskBits,this.refilter()},e.prototype.getFilterGroupIndex=function(){return this.m_filterGroupIndex},e.prototype.setFilterGroupIndex=function(t){this.m_filterGroupIndex=t,this.refilter()},e.prototype.getFilterCategoryBits=function(){return this.m_filterCategoryBits},e.prototype.setFilterCategoryBits=function(t){this.m_filterCategoryBits=t,this.refilter()},e.prototype.getFilterMaskBits=function(){return this.m_filterMaskBits},e.prototype.setFilterMaskBits=function(t){this.m_filterMaskBits=t,this.refilter()},e.prototype.refilter=function(){if(this.m_body!=null){for(var t=this.m_body.getContactList();t;){var r=t.contact,i=r.getFixtureA(),n=r.getFixtureB();(i==this||n==this)&&r.flagForFiltering(),t=t.next}var o=this.m_body.getWorld();if(o!=null)for(var s=o.m_broadPhase,a=0;a<this.m_proxyCount;++a)s.touchProxy(this.m_proxies[a].proxyId)}},e.prototype.shouldCollide=function(t){if(t.m_filterGroupIndex===this.m_filterGroupIndex&&t.m_filterGroupIndex!==0)return t.m_filterGroupIndex>0;var r=(t.m_filterMaskBits&this.m_filterCategoryBits)!==0,i=(t.m_filterCategoryBits&this.m_filterMaskBits)!==0,n=r&&i;return n},e}(),yn="static",vm="kinematic",Ye="dynamic",As=b(0,0),wi=b(0,0),ws=b(0,0),Bs=b(0,0),ym=tn(0,0,0),Vg={type:yn,position:u.zero(),angle:0,linearVelocity:u.zero(),angularVelocity:0,linearDamping:0,angularDamping:0,fixedRotation:!1,bullet:!1,gravityScale:1,allowSleep:!0,awake:!0,active:!0,userData:null},it=function(){function e(t,r){this.style={},this.appData={},r=Me(r,Vg),this.m_world=t,this.m_awakeFlag=r.awake,this.m_autoSleepFlag=r.allowSleep,this.m_bulletFlag=r.bullet,this.m_fixedRotationFlag=r.fixedRotation,this.m_activeFlag=r.active,this.m_islandFlag=!1,this.m_toiFlag=!1,this.m_userData=r.userData,this.m_type=r.type,this.m_type==Ye?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_xf=or.identity(),this.m_xf.p.setVec2(r.position),this.m_xf.q.setAngle(r.angle),this.m_sweep=new Wn,this.m_sweep.setTransform(this.m_xf),this.c_velocity=new Pg,this.c_position=new bg,this.m_force=u.zero(),this.m_torque=0,this.m_linearVelocity=u.clone(r.linearVelocity),this.m_angularVelocity=r.angularVelocity,this.m_linearDamping=r.linearDamping,this.m_angularDamping=r.angularDamping,this.m_gravityScale=r.gravityScale,this.m_sleepTime=0,this.m_jointList=null,this.m_contactList=null,this.m_fixtureList=null,this.m_prev=null,this.m_next=null,this.m_destroyed=!1,typeof r.style=="object"&&r.style!==null&&(this.style=r.style)}return e.prototype._serialize=function(){for(var t=[],r=this.m_fixtureList;r;r=r.m_next)t.push(r);return{type:this.m_type,bullet:this.m_bulletFlag,position:this.m_xf.p,angle:this.m_xf.q.getAngle(),linearVelocity:this.m_linearVelocity,angularVelocity:this.m_angularVelocity,fixtures:t}},e._deserialize=function(t,r,i){var n=new e(r,t);if(t.fixtures)for(var o=t.fixtures.length-1;o>=0;o--){var s=i(Ta,t.fixtures[o],n);n._addFixture(s)}return n},e.prototype.isWorldLocked=function(){return!!(this.m_world&&this.m_world.isLocked())},e.prototype.getWorld=function(){return this.m_world},e.prototype.getNext=function(){return this.m_next},e.prototype.setUserData=function(t){this.m_userData=t},e.prototype.getUserData=function(){return this.m_userData},e.prototype.getFixtureList=function(){return this.m_fixtureList},e.prototype.getJointList=function(){return this.m_jointList},e.prototype.getContactList=function(){return this.m_contactList},e.prototype.isStatic=function(){return this.m_type==yn},e.prototype.isDynamic=function(){return this.m_type==Ye},e.prototype.isKinematic=function(){return this.m_type==vm},e.prototype.setStatic=function(){return this.setType(yn),this},e.prototype.setDynamic=function(){return this.setType(Ye),this},e.prototype.setKinematic=function(){return this.setType(vm),this},e.prototype.getType=function(){return this.m_type},e.prototype.setType=function(t){if(this.isWorldLocked()!=!0&&this.m_type!=t){this.m_type=t,this.resetMassData(),this.m_type==yn&&(this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_sweep.forward(),this.synchronizeFixtures()),this.setAwake(!0),this.m_force.setZero(),this.m_torque=0;for(var r=this.m_contactList;r;){var i=r;r=r.next,this.m_world.destroyContact(i.contact)}this.m_contactList=null;for(var n=this.m_world.m_broadPhase,o=this.m_fixtureList;o;o=o.m_next)for(var s=0;s<o.m_proxyCount;++s)n.touchProxy(o.m_proxies[s].proxyId)}},e.prototype.isBullet=function(){return this.m_bulletFlag},e.prototype.setBullet=function(t){this.m_bulletFlag=!!t},e.prototype.isSleepingAllowed=function(){return this.m_autoSleepFlag},e.prototype.setSleepingAllowed=function(t){this.m_autoSleepFlag=!!t,this.m_autoSleepFlag==!1&&this.setAwake(!0)},e.prototype.isAwake=function(){return this.m_awakeFlag},e.prototype.setAwake=function(t){t?(this.m_awakeFlag=!0,this.m_sleepTime=0):(this.m_awakeFlag=!1,this.m_sleepTime=0,this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_force.setZero(),this.m_torque=0)},e.prototype.isActive=function(){return this.m_activeFlag},e.prototype.setActive=function(t){if(t!=this.m_activeFlag)if(this.m_activeFlag=!!t,this.m_activeFlag){for(var r=this.m_world.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.createProxies(r,this.m_xf);this.m_world.m_newFixture=!0}else{for(var r=this.m_world.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.destroyProxies(r);for(var n=this.m_contactList;n;){var o=n;n=n.next,this.m_world.destroyContact(o.contact)}this.m_contactList=null}},e.prototype.isFixedRotation=function(){return this.m_fixedRotationFlag},e.prototype.setFixedRotation=function(t){this.m_fixedRotationFlag!=t&&(this.m_fixedRotationFlag=!!t,this.m_angularVelocity=0,this.resetMassData())},e.prototype.getTransform=function(){return this.m_xf},e.prototype.setTransform=function(t,r){if(this.isWorldLocked()!=!0){typeof r=="number"?this.m_xf.setNum(t,r):this.m_xf.setTransform(t),this.m_sweep.setTransform(this.m_xf);for(var i=this.m_world.m_broadPhase,n=this.m_fixtureList;n;n=n.m_next)n.synchronize(i,this.m_xf,this.m_xf);this.setAwake(!0)}},e.prototype.synchronizeTransform=function(){this.m_sweep.getTransform(this.m_xf,1)},e.prototype.synchronizeFixtures=function(){this.m_sweep.getTransform(ym,0);for(var t=this.m_world.m_broadPhase,r=this.m_fixtureList;r;r=r.m_next)r.synchronize(t,ym,this.m_xf)},e.prototype.advance=function(t){this.m_sweep.advance(t),B(this.m_sweep.c,this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.m_sweep.getTransform(this.m_xf,1)},e.prototype.getPosition=function(){return this.m_xf.p},e.prototype.setPosition=function(t){this.setTransform(t,this.m_sweep.a)},e.prototype.getAngle=function(){return this.m_sweep.a},e.prototype.setAngle=function(t){this.setTransform(this.m_xf.p,t)},e.prototype.getWorldCenter=function(){return this.m_sweep.c},e.prototype.getLocalCenter=function(){return this.m_sweep.localCenter},e.prototype.getLinearVelocity=function(){return this.m_linearVelocity},e.prototype.getLinearVelocityFromWorldPoint=function(t){var r=u.sub(t,this.m_sweep.c);return u.add(this.m_linearVelocity,u.crossNumVec2(this.m_angularVelocity,r))},e.prototype.getLinearVelocityFromLocalPoint=function(t){return this.getLinearVelocityFromWorldPoint(this.getWorldPoint(t))},e.prototype.setLinearVelocity=function(t){this.m_type!=yn&&(u.dot(t,t)>0&&this.setAwake(!0),this.m_linearVelocity.setVec2(t))},e.prototype.getAngularVelocity=function(){return this.m_angularVelocity},e.prototype.setAngularVelocity=function(t){this.m_type!=yn&&(t*t>0&&this.setAwake(!0),this.m_angularVelocity=t)},e.prototype.getLinearDamping=function(){return this.m_linearDamping},e.prototype.setLinearDamping=function(t){this.m_linearDamping=t},e.prototype.getAngularDamping=function(){return this.m_angularDamping},e.prototype.setAngularDamping=function(t){this.m_angularDamping=t},e.prototype.getGravityScale=function(){return this.m_gravityScale},e.prototype.setGravityScale=function(t){this.m_gravityScale=t},e.prototype.getMass=function(){return this.m_mass},e.prototype.getInertia=function(){return this.m_I+this.m_mass*u.dot(this.m_sweep.localCenter,this.m_sweep.localCenter)},e.prototype.getMassData=function(t){t.mass=this.m_mass,t.I=this.getInertia(),B(t.center,this.m_sweep.localCenter)},e.prototype.resetMassData=function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,R(this.m_sweep.localCenter),this.isStatic()||this.isKinematic()){B(this.m_sweep.c0,this.m_xf.p),B(this.m_sweep.c,this.m_xf.p),this.m_sweep.a0=this.m_sweep.a;return}R(wi);for(var t=this.m_fixtureList;t;t=t.m_next)if(t.m_density!=0){var r={mass:0,center:b(0,0),I:0};t.getMassData(r),this.m_mass+=r.mass,er(wi,r.mass,r.center),this.m_I+=r.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,D(wi,this.m_invMass,wi)):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&this.m_fixedRotationFlag==!1?(this.m_I-=this.m_mass*V(wi,wi),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0),B(As,this.m_sweep.c),this.m_sweep.setLocalCenter(wi,this.m_xf),$(ws,this.m_sweep.c,As),ge(Bs,this.m_angularVelocity,ws),Ee(this.m_linearVelocity,Bs)},e.prototype.setMassData=function(t){this.isWorldLocked()!=!0&&this.m_type==Ye&&(this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=t.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,t.I>0&&this.m_fixedRotationFlag==!1&&(this.m_I=t.I-this.m_mass*V(t.center,t.center),this.m_invI=1/this.m_I),B(As,this.m_sweep.c),this.m_sweep.setLocalCenter(t.center,this.m_xf),$(ws,this.m_sweep.c,As),ge(Bs,this.m_angularVelocity,ws),Ee(this.m_linearVelocity,Bs))},e.prototype.applyForce=function(t,r,i){i===void 0&&(i=!0),this.m_type==Ye&&(i&&this.m_awakeFlag==!1&&this.setAwake(!0),this.m_awakeFlag&&(this.m_force.add(t),this.m_torque+=u.crossVec2Vec2(u.sub(r,this.m_sweep.c),t)))},e.prototype.applyForceToCenter=function(t,r){r===void 0&&(r=!0),this.m_type==Ye&&(r&&this.m_awakeFlag==!1&&this.setAwake(!0),this.m_awakeFlag&&this.m_force.add(t))},e.prototype.applyTorque=function(t,r){r===void 0&&(r=!0),this.m_type==Ye&&(r&&this.m_awakeFlag==!1&&this.setAwake(!0),this.m_awakeFlag&&(this.m_torque+=t))},e.prototype.applyLinearImpulse=function(t,r,i){i===void 0&&(i=!0),this.m_type==Ye&&(i&&this.m_awakeFlag==!1&&this.setAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.addMul(this.m_invMass,t),this.m_angularVelocity+=this.m_invI*u.crossVec2Vec2(u.sub(r,this.m_sweep.c),t)))},e.prototype.applyAngularImpulse=function(t,r){r===void 0&&(r=!0),this.m_type==Ye&&(r&&this.m_awakeFlag==!1&&this.setAwake(!0),this.m_awakeFlag&&(this.m_angularVelocity+=this.m_invI*t))},e.prototype.shouldCollide=function(t){if(this.m_type!=Ye&&t.m_type!=Ye)return!1;for(var r=this.m_jointList;r;r=r.next)if(r.other==t&&r.joint.m_collideConnected==!1)return!1;return!0},e.prototype._addFixture=function(t){if(this.isWorldLocked()==!0)return null;if(this.m_activeFlag){var r=this.m_world.m_broadPhase;t.createProxies(r,this.m_xf)}return t.m_next=this.m_fixtureList,this.m_fixtureList=t,t.m_density>0&&this.resetMassData(),this.m_world.m_newFixture=!0,t},e.prototype.createFixture=function(t,r){if(this.isWorldLocked()==!0)return null;var i=new Ta(this,t,r);return this._addFixture(i),i},e.prototype.destroyFixture=function(t){if(this.isWorldLocked()!=!0){if(this.m_fixtureList===t)this.m_fixtureList=t.m_next;else for(var r=this.m_fixtureList;r!=null;){if(r.m_next===t){r.m_next=t.m_next;break}r=r.m_next}for(var i=this.m_contactList;i;){var n=i.contact;i=i.next;var o=n.getFixtureA(),s=n.getFixtureB();(t==o||t==s)&&this.m_world.destroyContact(n)}if(this.m_activeFlag){var a=this.m_world.m_broadPhase;t.destroyProxies(a)}t.m_body=null,t.m_next=null,this.m_world.publish("remove-fixture",t),this.resetMassData()}},e.prototype.getWorldPoint=function(t){return or.mulVec2(this.m_xf,t)},e.prototype.getWorldVector=function(t){return M.mulVec2(this.m_xf.q,t)},e.prototype.getLocalPoint=function(t){return or.mulTVec2(this.m_xf,t)},e.prototype.getLocalVector=function(t){return M.mulTVec2(this.m_xf.q,t)},e.STATIC="static",e.KINEMATIC="kinematic",e.DYNAMIC="dynamic",e}(),gm=function(){function e(){this.other=null,this.joint=null,this.prev=null,this.next=null}return e}(),Qt=function(){function e(t,r,i){this.m_type="unknown-joint",this.m_prev=null,this.m_next=null,this.m_edgeA=new gm,this.m_edgeB=new gm,this.m_islandFlag=!1,this.style={},this.appData={},r="bodyA"in t?t.bodyA:r,i="bodyB"in t?t.bodyB:i,this.m_bodyA=r,this.m_bodyB=i,this.m_collideConnected=!!t.collideConnected,this.m_userData=t.userData,typeof t.style=="object"&&t.style!==null&&(this.style=t.style)}return e.prototype.isActive=function(){return this.m_bodyA.isActive()&&this.m_bodyB.isActive()},e.prototype.getType=function(){return this.m_type},e.prototype.getBodyA=function(){return this.m_bodyA},e.prototype.getBodyB=function(){return this.m_bodyB},e.prototype.getNext=function(){return this.m_next},e.prototype.getUserData=function(){return this.m_userData},e.prototype.setUserData=function(t){this.m_userData=t},e.prototype.getCollideConnected=function(){return this.m_collideConnected},e.prototype.shiftOrigin=function(t){},e.prototype._resetAnchors=function(t){return this._reset(t)},e}(),_t={gjkCalls:0,gjkIters:0,gjkMaxIters:0,toiTime:0,toiMaxTime:0,toiCalls:0,toiIters:0,toiMaxIters:0,toiRootIters:0,toiMaxRootIters:0},Tg=function(){return Date.now()},kg=function(e){return Date.now()-e};const xm={now:Tg,diff:kg};var Ig=Math.max,Cs=b(0,0),Ss=b(0,0),ve=b(0,0),Ps=b(0,0),Cl=b(0,0),zg=b(0,0),Lg=b(0,0);_t.gjkCalls=0;_t.gjkIters=0;_t.gjkMaxIters=0;var Ec=function(){function e(){this.proxyA=new Qi,this.proxyB=new Qi,this.transformA=or.identity(),this.transformB=or.identity(),this.useRadii=!1}return e.prototype.recycle=function(){this.proxyA.recycle(),this.proxyB.recycle(),this.transformA.setIdentity(),this.transformB.setIdentity(),this.useRadii=!1},e}(),Nc=function(){function e(){this.pointA=b(0,0),this.pointB=b(0,0),this.distance=0,this.iterations=0}return e.prototype.recycle=function(){R(this.pointA),R(this.pointB),this.distance=0,this.iterations=0},e}(),Rc=function(){function e(){this.metric=0,this.indexA=[],this.indexB=[],this.count=0}return e.prototype.recycle=function(){this.metric=0,this.indexA.length=0,this.indexB.length=0,this.count=0},e}(),rn=function(e,t,r){++_t.gjkCalls;var i=r.proxyA,n=r.proxyB,o=r.transformA,s=r.transformB;Je.recycle(),Je.readCache(t,i,o,n,s);for(var a=Je.m_v,l=z.maxDistanceIterations,c=[],h=[],m=0,f=0;f<l;){m=Je.m_count;for(var p=0;p<m;++p)c[p]=a[p].indexA,h[p]=a[p].indexB;if(Je.solve(),Je.m_count===3)break;var _=Je.getSearchDirection();if($i(_)<ie*ie)break;var d=a[Je.m_count];d.indexA=i.getSupport(kn(Cs,o.q,D(Cs,-1,_))),U(d.wA,o,i.getVertex(d.indexA)),d.indexB=n.getSupport(kn(Cs,s.q,_)),U(d.wB,s,n.getVertex(d.indexB)),$(d.w,d.wB,d.wA),++f,++_t.gjkIters;for(var x=!1,p=0;p<m;++p)if(d.indexA===c[p]&&d.indexB===h[p]){x=!0;break}if(x)break;++Je.m_count}if(_t.gjkMaxIters=Ig(_t.gjkMaxIters,f),Je.getWitnessPoints(e.pointA,e.pointB),e.distance=U_(e.pointA,e.pointB),e.iterations=f,Je.writeCache(t),r.useRadii){var v=i.m_radius,y=n.m_radius;if(e.distance>v+y&&e.distance>ie)e.distance-=v+y,$(Ss,e.pointB,e.pointA),nr(Ss),er(e.pointA,v,Ss),yo(e.pointB,y,Ss);else{var g=$(Cs,e.pointA,e.pointB);B(e.pointA,g),B(e.pointB,g),e.distance=0}}},Qi=function(){function e(){this.m_vertices=[],this.m_count=0,this.m_radius=0}return e.prototype.recycle=function(){this.m_vertices.length=0,this.m_count=0,this.m_radius=0},e.prototype.getVertexCount=function(){return this.m_count},e.prototype.getVertex=function(t){return this.m_vertices[t]},e.prototype.getSupport=function(t){for(var r=-1,i=-1/0,n=0;n<this.m_count;++n){var o=V(this.m_vertices[n],t);o>i&&(r=n,i=o)}return r},e.prototype.getSupportVertex=function(t){return this.m_vertices[this.getSupport(t)]},e.prototype.set=function(t,r){t.computeDistanceProxy(this,r)},e.prototype.setVertices=function(t,r,i){this.m_vertices=t,this.m_count=r,this.m_radius=i},e}(),Sl=function(){function e(){this.wA=b(0,0),this.indexA=0,this.wB=b(0,0),this.indexB=0,this.w=b(0,0),this.a=0}return e.prototype.recycle=function(){this.indexA=0,this.indexB=0,R(this.wA),R(this.wB),R(this.w),this.a=0},e.prototype.set=function(t){this.indexA=t.indexA,this.indexB=t.indexB,B(this.wA,t.wA),B(this.wB,t.wB),B(this.w,t.w),this.a=t.a},e}(),bs=b(0,0),io=b(0,0),Fg=function(){function e(){this.m_v1=new Sl,this.m_v2=new Sl,this.m_v3=new Sl,this.m_v=[this.m_v1,this.m_v2,this.m_v3]}return e.prototype.recycle=function(){this.m_v1.recycle(),this.m_v2.recycle(),this.m_v3.recycle(),this.m_count=0},e.prototype.toString=function(){return this.m_count===3?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y,this.m_v2.a,this.m_v2.wA.x,this.m_v2.wA.y,this.m_v2.wB.x,this.m_v2.wB.y,this.m_v3.a,this.m_v3.wA.x,this.m_v3.wA.y,this.m_v3.wB.x,this.m_v3.wB.y].toString():this.m_count===2?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y,this.m_v2.a,this.m_v2.wA.x,this.m_v2.wA.y,this.m_v2.wB.x,this.m_v2.wB.y].toString():this.m_count===1?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y].toString():"+"+this.m_count},e.prototype.readCache=function(t,r,i,n,o){this.m_count=t.count;for(var s=0;s<this.m_count;++s){var a=this.m_v[s];a.indexA=t.indexA[s],a.indexB=t.indexB[s];var l=r.getVertex(a.indexA),c=n.getVertex(a.indexB);U(a.wA,i,l),U(a.wB,o,c),$(a.w,a.wB,a.wA),a.a=0}if(this.m_count>1){var h=t.metric,m=this.getMetric();(m<.5*h||2*h<m||m<ie)&&(this.m_count=0)}if(this.m_count===0){var a=this.m_v[0];a.indexA=0,a.indexB=0;var l=r.getVertex(0),c=n.getVertex(0);U(a.wA,i,l),U(a.wB,o,c),$(a.w,a.wB,a.wA),a.a=1,this.m_count=1}},e.prototype.writeCache=function(t){t.metric=this.getMetric(),t.count=this.m_count;for(var r=0;r<this.m_count;++r)t.indexA[r]=this.m_v[r].indexA,t.indexB[r]=this.m_v[r].indexB},e.prototype.getSearchDirection=function(){var t=this.m_v1,r=this.m_v2;switch(this.m_count){case 1:return Ot(bs,-t.w.x,-t.w.y);case 2:{$(ve,r.w,t.w);var i=-J(ve,t.w);return i>0?Ot(bs,-ve.y,ve.x):Ot(bs,ve.y,-ve.x)}default:return R(bs)}},e.prototype.getClosestPoint=function(){var t=this.m_v1,r=this.m_v2;switch(this.m_count){case 0:return R(io);case 1:return B(io,t.w);case 2:return ft(io,t.a,t.w,r.a,r.w);case 3:return R(io);default:return R(io)}},e.prototype.getWitnessPoints=function(t,r){var i=this.m_v1,n=this.m_v2,o=this.m_v3;switch(this.m_count){case 0:break;case 1:B(t,i.wA),B(r,i.wB);break;case 2:ft(t,i.a,i.wA,n.a,n.wA),ft(r,i.a,i.wB,n.a,n.wB);break;case 3:dr(t,i.a,i.wA,n.a,n.wA,o.a,o.wA),B(r,t);break}},e.prototype.getMetric=function(){switch(this.m_count){case 0:return 0;case 1:return 0;case 2:return U_(this.m_v1.w,this.m_v2.w);case 3:return J($(zg,this.m_v2.w,this.m_v1.w),$(Lg,this.m_v3.w,this.m_v1.w));default:return 0}},e.prototype.solve=function(){switch(this.m_count){case 1:break;case 2:this.solve2();break;case 3:this.solve3();break}},e.prototype.solve2=function(){var t=this.m_v1.w,r=this.m_v2.w;$(ve,r,t);var i=-V(t,ve);if(i<=0){this.m_v1.a=1,this.m_count=1;return}var n=V(r,ve);if(n<=0){this.m_v2.a=1,this.m_count=1,this.m_v1.set(this.m_v2);return}var o=1/(n+i);this.m_v1.a=n*o,this.m_v2.a=i*o,this.m_count=2},e.prototype.solve3=function(){var t=this.m_v1.w,r=this.m_v2.w,i=this.m_v3.w;$(ve,r,t);var n=V(t,ve),o=V(r,ve),s=o,a=-n;$(Ps,i,t);var l=V(t,Ps),c=V(i,Ps),h=c,m=-l;$(Cl,i,r);var f=V(r,Cl),p=V(i,Cl),_=p,d=-f,x=J(ve,Ps),v=x*J(r,i),y=x*J(i,t),g=x*J(t,r);if(a<=0&&m<=0){this.m_v1.a=1,this.m_count=1;return}if(s>0&&a>0&&g<=0){var A=1/(s+a);this.m_v1.a=s*A,this.m_v2.a=a*A,this.m_count=2;return}if(h>0&&m>0&&y<=0){var w=1/(h+m);this.m_v1.a=h*w,this.m_v3.a=m*w,this.m_count=2,this.m_v2.set(this.m_v3);return}if(s<=0&&d<=0){this.m_v2.a=1,this.m_count=1,this.m_v1.set(this.m_v2);return}if(h<=0&&_<=0){this.m_v3.a=1,this.m_count=1,this.m_v1.set(this.m_v3);return}if(_>0&&d>0&&v<=0){var C=1/(_+d);this.m_v2.a=_*C,this.m_v3.a=d*C,this.m_count=2,this.m_v1.set(this.m_v3);return}var S=1/(v+y+g);this.m_v1.a=v*S,this.m_v2.a=y*S,this.m_v3.a=g*S,this.m_count=3},e}(),Je=new Fg,Bi=new Ec,Am=new Rc,Pl=new Nc,Y_=function(e,t,r,i,n,o){return Bi.recycle(),Bi.proxyA.set(e,t),Bi.proxyB.set(r,i),Va(Bi.transformA,n),Va(Bi.transformB,o),Bi.useRadii=!0,Pl.recycle(),Am.recycle(),rn(Pl,Am,Bi),Pl.distance<10*ie};rn.testOverlap=Y_;rn.Input=Ec;rn.Output=Nc;rn.Proxy=Qi;rn.Cache=Rc;(function(){function e(){this.proxyA=new Qi,this.proxyB=new Qi,this.transformA=or.identity(),this.transformB=or.identity(),this.translationB=u.zero()}return e.prototype.recycle=function(){this.proxyA.recycle(),this.proxyB.recycle(),this.transformA.setIdentity(),this.transformB.setIdentity(),R(this.translationB)},e})();var Eg=Math.abs,Ms=Math.max,J_=function(){function e(){this.proxyA=new Qi,this.proxyB=new Qi,this.sweepA=new Wn,this.sweepB=new Wn}return e.prototype.recycle=function(){this.proxyA.recycle(),this.proxyB.recycle(),this.sweepA.recycle(),this.sweepB.recycle(),this.tMax=-1},e}(),Ne;(function(e){e[e.e_unset=-1]="e_unset",e[e.e_unknown=0]="e_unknown",e[e.e_failed=1]="e_failed",e[e.e_overlapped=2]="e_overlapped",e[e.e_touching=3]="e_touching",e[e.e_separated=4]="e_separated"})(Ne||(Ne={}));var X_=function(){function e(){this.state=Ne.e_unset,this.t=-1}return e.prototype.recycle=function(){this.state=Ne.e_unset,this.t=-1},e}();_t.toiTime=0;_t.toiMaxTime=0;_t.toiCalls=0;_t.toiIters=0;_t.toiMaxIters=0;_t.toiRootIters=0;_t.toiMaxRootIters=0;var on=new Ec,bl=new Nc,Ml=new Rc,ae=tn(0,0,0),le=tn(0,0,0),no=b(0,0),cr=b(0,0),Ie=b(0,0),se=b(0,0),Vs=b(0,0),Ts=b(0,0),ks=b(0,0),Is=b(0,0),Dc=function(e,t){var r=xm.now();++_t.toiCalls,e.state=Ne.e_unknown,e.t=t.tMax;var i=t.proxyA,n=t.proxyB,o=t.sweepA,s=t.sweepB;o.normalize(),s.normalize();var a=t.tMax,l=i.m_radius+n.m_radius,c=Ms(z.linearSlop,l-3*z.linearSlop),h=.25*z.linearSlop,m=0,f=z.maxTOIIterations,p=0;for(Ml.recycle(),on.proxyA.setVertices(i.m_vertices,i.m_count,i.m_radius),on.proxyB.setVertices(n.m_vertices,n.m_count,n.m_radius),on.useRadii=!1;;){if(o.getTransform(ae,m),s.getTransform(le,m),Va(on.transformA,ae),Va(on.transformB,le),rn(bl,Ml,on),bl.distance<=0){e.state=Ne.e_overlapped,e.t=0;break}if(bl.distance<c+h){e.state=Ne.e_touching,e.t=m;break}oo.initialize(Ml,i,o,n,s,m);for(var _=!1,d=a,x=0;;){var v=oo.findMinSeparation(d);if(v>c+h){e.state=Ne.e_separated,e.t=a,_=!0;break}if(v>c-h){m=d;break}var y=oo.evaluate(m);if(y<c-h){e.state=Ne.e_failed,e.t=m,_=!0;break}if(y<=c+h){e.state=Ne.e_touching,e.t=m,_=!0;break}for(var g=0,A=m,w=d;;){var C=void 0;g&1?C=A+(c-y)*(w-A)/(v-y):C=.5*(A+w),++g,++_t.toiRootIters;var S=oo.evaluate(C);if(Eg(S-c)<h){d=C;break}if(S>c?(A=C,y=S):(w=C,v=S),g===50)break}if(_t.toiMaxRootIters=Ms(_t.toiMaxRootIters,g),++x,x===z.maxPolygonVertices)break}if(++p,++_t.toiIters,_)break;if(p===f){e.state=Ne.e_failed,e.t=m;break}}_t.toiMaxIters=Ms(_t.toiMaxIters,p);var P=xm.diff(r);_t.toiMaxTime=Ms(_t.toiMaxTime,P),_t.toiTime+=P,oo.recycle()},vr;(function(e){e[e.e_unset=-1]="e_unset",e[e.e_points=1]="e_points",e[e.e_faceA=2]="e_faceA",e[e.e_faceB=3]="e_faceB"})(vr||(vr={}));var Ng=function(){function e(){this.m_proxyA=null,this.m_proxyB=null,this.m_sweepA=null,this.m_sweepB=null,this.m_type=vr.e_unset,this.m_localPoint=b(0,0),this.m_axis=b(0,0),this.indexA=-1,this.indexB=-1}return e.prototype.recycle=function(){this.m_proxyA=null,this.m_proxyB=null,this.m_sweepA=null,this.m_sweepB=null,this.m_type=vr.e_unset,R(this.m_localPoint),R(this.m_axis),this.indexA=-1,this.indexB=-1},e.prototype.initialize=function(t,r,i,n,o,s){var a=t.count;if(this.m_proxyA=r,this.m_proxyB=n,this.m_sweepA=i,this.m_sweepB=o,this.m_sweepA.getTransform(ae,s),this.m_sweepB.getTransform(le,s),a===1){this.m_type=vr.e_points;var l=this.m_proxyA.getVertex(t.indexA[0]),c=this.m_proxyB.getVertex(t.indexB[0]);U(cr,ae,l),U(Ie,le,c),$(this.m_axis,Ie,cr);var h=Ag(this.m_axis);return h}else if(t.indexA[0]===t.indexA[1]){this.m_type=vr.e_faceB;var m=n.getVertex(t.indexB[0]),f=n.getVertex(t.indexB[1]);Ui(this.m_axis,$(no,f,m),1),nr(this.m_axis),qe(se,le.q,this.m_axis),ft(this.m_localPoint,.5,m,.5,f),U(Ie,le,this.m_localPoint);var p=r.getVertex(t.indexA[0]),_=or.mulVec2(ae,p),h=V(_,se)-V(Ie,se);return h<0&&(Jo(this.m_axis),h=-h),h}else{this.m_type=vr.e_faceA;var d=this.m_proxyA.getVertex(t.indexA[0]),x=this.m_proxyA.getVertex(t.indexA[1]);Ui(this.m_axis,$(no,x,d),1),nr(this.m_axis),qe(se,ae.q,this.m_axis),ft(this.m_localPoint,.5,d,.5,x),U(cr,ae,this.m_localPoint);var v=this.m_proxyB.getVertex(t.indexB[0]);U(Ie,le,v);var h=V(Ie,se)-V(cr,se);return h<0&&(Jo(this.m_axis),h=-h),h}},e.prototype.compute=function(t,r){switch(this.m_sweepA.getTransform(ae,r),this.m_sweepB.getTransform(le,r),this.m_type){case vr.e_points:{t&&(kn(Vs,ae.q,this.m_axis),kn(Ts,le.q,D(no,-1,this.m_axis)),this.indexA=this.m_proxyA.getSupport(Vs),this.indexB=this.m_proxyB.getSupport(Ts)),B(ks,this.m_proxyA.getVertex(this.indexA)),B(Is,this.m_proxyB.getVertex(this.indexB)),U(cr,ae,ks),U(Ie,le,Is);var i=V(Ie,this.m_axis)-V(cr,this.m_axis);return i}case vr.e_faceA:{qe(se,ae.q,this.m_axis),U(cr,ae,this.m_localPoint),t&&(kn(Ts,le.q,D(no,-1,se)),this.indexA=-1,this.indexB=this.m_proxyB.getSupport(Ts)),B(Is,this.m_proxyB.getVertex(this.indexB)),U(Ie,le,Is);var i=V(Ie,se)-V(cr,se);return i}case vr.e_faceB:{qe(se,le.q,this.m_axis),U(Ie,le,this.m_localPoint),t&&(kn(Vs,ae.q,D(no,-1,se)),this.indexB=-1,this.indexA=this.m_proxyA.getSupport(Vs)),B(ks,this.m_proxyA.getVertex(this.indexA)),U(cr,ae,ks);var i=V(cr,se)-V(Ie,se);return i}default:return t&&(this.indexA=-1,this.indexB=-1),0}},e.prototype.findMinSeparation=function(t){return this.compute(!0,t)},e.prototype.evaluate=function(t){return this.compute(!1,t)},e}(),oo=new Ng;Dc.Input=J_;Dc.Output=X_;var wm=Math.abs,Bm=Math.sqrt,zs=Math.min,Oc=function(){function e(){this.dt=0,this.inv_dt=0,this.velocityIterations=0,this.positionIterations=0,this.warmStarting=!1,this.blockSolve=!0,this.inv_dt0=0,this.dtRatio=1}return e.prototype.reset=function(t){this.dt>0&&(this.inv_dt0=this.inv_dt),this.dt=t,this.inv_dt=t==0?0:1/t,this.dtRatio=t*this.inv_dt0},e}(),sn=new Oc,wr=b(0,0),$t=b(0,0),Ls=b(0,0),an=new J_,Vl=new X_,Cm=new Wn,Sm=new Wn,Pm=new Wn,Rg=function(){function e(t){this.contact=t,this.normals=[],this.tangents=[]}return e.prototype.recycle=function(){this.normals.length=0,this.tangents.length=0},Object.defineProperty(e.prototype,"normalImpulses",{get:function(){var t=this.contact,r=this.normals;r.length=0;for(var i=0;i<t.v_points.length;++i)r.push(t.v_points[i].normalImpulse);return r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tangentImpulses",{get:function(){var t=this.contact,r=this.tangents;r.length=0;for(var i=0;i<t.v_points.length;++i)r.push(t.v_points[i].tangentImpulse);return r},enumerable:!1,configurable:!0}),e}(),Q_=function(){function e(t){this.m_world=t,this.m_stack=[],this.m_bodies=[],this.m_contacts=[],this.m_joints=[]}return e.prototype.clear=function(){this.m_stack.length=0,this.m_bodies.length=0,this.m_contacts.length=0,this.m_joints.length=0},e.prototype.addBody=function(t){this.m_bodies.push(t)},e.prototype.addContact=function(t){this.m_contacts.push(t)},e.prototype.addJoint=function(t){this.m_joints.push(t)},e.prototype.solveWorld=function(t){for(var r=this.m_world,i=r.m_bodyList;i;i=i.m_next)i.m_islandFlag=!1;for(var n=r.m_contactList;n;n=n.m_next)n.m_islandFlag=!1;for(var o=r.m_jointList;o;o=o.m_next)o.m_islandFlag=!1;for(var s=this.m_stack,a=r.m_bodyList;a;a=a.m_next)if(!a.m_islandFlag&&!(a.isAwake()==!1||a.isActive()==!1)&&!a.isStatic()){for(this.clear(),s.push(a),a.m_islandFlag=!0;s.length>0;){var i=s.pop();if(this.addBody(i),i.m_awakeFlag=!0,!i.isStatic()){for(var l=i.m_contactList;l;l=l.next){var c=l.contact;if(!c.m_islandFlag&&!(c.isEnabled()==!1||c.isTouching()==!1)){var h=c.m_fixtureA.m_isSensor,m=c.m_fixtureB.m_isSensor;if(!(h||m)){this.addContact(c),c.m_islandFlag=!0;var f=l.other;f.m_islandFlag||(s.push(f),f.m_islandFlag=!0)}}}for(var p=i.m_jointList;p;p=p.next)if(p.joint.m_islandFlag!=!0){var f=p.other;f.isActive()!=!1&&(this.addJoint(p.joint),p.joint.m_islandFlag=!0,!f.m_islandFlag&&(s.push(f),f.m_islandFlag=!0))}}}this.solveIsland(t);for(var _=0;_<this.m_bodies.length;++_){var i=this.m_bodies[_];i.isStatic()&&(i.m_islandFlag=!1)}}},e.prototype.solveIsland=function(t){for(var r=this.m_world,i=r.m_gravity,n=r.m_allowSleep,o=t.dt,s=0;s<this.m_bodies.length;++s){var a=this.m_bodies[s];B(wr,a.m_sweep.c);var l=a.m_sweep.a;B($t,a.m_linearVelocity);var c=a.m_angularVelocity;B(a.m_sweep.c0,a.m_sweep.c),a.m_sweep.a0=a.m_sweep.a,a.isDynamic()&&(er($t,o*a.m_gravityScale,i),er($t,o*a.m_invMass,a.m_force),c+=o*a.m_invI*a.m_torque,D($t,1/(1+o*a.m_linearDamping),$t),c*=1/(1+o*a.m_angularDamping)),B(a.c_position.c,wr),a.c_position.a=l,B(a.c_velocity.v,$t),a.c_velocity.w=c}for(var s=0;s<this.m_contacts.length;++s){var h=this.m_contacts[s];h.initConstraint(t)}for(var s=0;s<this.m_contacts.length;++s){var h=this.m_contacts[s];h.initVelocityConstraint(t)}if(t.warmStarting)for(var s=0;s<this.m_contacts.length;++s){var h=this.m_contacts[s];h.warmStartConstraint(t)}for(var s=0;s<this.m_joints.length;++s){var m=this.m_joints[s];m.initVelocityConstraints(t)}for(var s=0;s<t.velocityIterations;++s){for(var f=0;f<this.m_joints.length;++f){var m=this.m_joints[f];m.solveVelocityConstraints(t)}for(var f=0;f<this.m_contacts.length;++f){var h=this.m_contacts[f];h.solveVelocityConstraint(t)}}for(var s=0;s<this.m_contacts.length;++s){var h=this.m_contacts[s];h.storeConstraintImpulses(t)}for(var s=0;s<this.m_bodies.length;++s){var a=this.m_bodies[s];B(wr,a.c_position.c);var l=a.c_position.a;B($t,a.c_velocity.v);var c=a.c_velocity.w;D(Ls,o,$t);var p=$i(Ls);if(p>z.maxTranslationSquared){var _=z.maxTranslation/Bm(p);um($t,_)}var d=o*c;if(d*d>z.maxRotationSquared){var _=z.maxRotation/wm(d);c*=_}er(wr,o,$t),l+=o*c,B(a.c_position.c,wr),a.c_position.a=l,B(a.c_velocity.v,$t),a.c_velocity.w=c}for(var x=!1,s=0;s<t.positionIterations;++s){for(var v=0,f=0;f<this.m_contacts.length;++f){var h=this.m_contacts[f],y=h.solvePositionConstraint(t);v=zs(v,y)}for(var g=v>=-3*z.linearSlop,A=!0,f=0;f<this.m_joints.length;++f){var m=this.m_joints[f],w=m.solvePositionConstraints(t);A=A&&w}if(g&&A){x=!0;break}}for(var s=0;s<this.m_bodies.length;++s){var a=this.m_bodies[s];B(a.m_sweep.c,a.c_position.c),a.m_sweep.a=a.c_position.a,B(a.m_linearVelocity,a.c_velocity.v),a.m_angularVelocity=a.c_velocity.w,a.synchronizeTransform()}if(this.postSolveIsland(),n){for(var C=1/0,S=z.linearSleepToleranceSqr,P=z.angularSleepToleranceSqr,s=0;s<this.m_bodies.length;++s){var a=this.m_bodies[s];a.isStatic()||(a.m_autoSleepFlag==!1||a.m_angularVelocity*a.m_angularVelocity>P||$i(a.m_linearVelocity)>S?(a.m_sleepTime=0,C=0):(a.m_sleepTime+=o,C=zs(C,a.m_sleepTime)))}if(C>=z.timeToSleep&&x)for(var s=0;s<this.m_bodies.length;++s){var a=this.m_bodies[s];a.setAwake(!1)}}},e.prototype.solveWorldTOI=function(t){var r=this.m_world;if(r.m_stepComplete){for(var i=r.m_bodyList;i;i=i.m_next)i.m_islandFlag=!1,i.m_sweep.alpha0=0;for(var n=r.m_contactList;n;n=n.m_next)n.m_toiFlag=!1,n.m_islandFlag=!1,n.m_toiCount=0,n.m_toi=1}for(;;){for(var o=null,s=1,a=r.m_contactList;a;a=a.m_next)if(a.isEnabled()!=!1&&!(a.m_toiCount>z.maxSubSteps)){var l=1;if(a.m_toiFlag)l=a.m_toi;else{var c=a.getFixtureA(),h=a.getFixtureB();if(c.isSensor()||h.isSensor())continue;var m=c.getBody(),f=h.getBody(),p=m.isAwake()&&!m.isStatic(),_=f.isAwake()&&!f.isStatic();if(p==!1&&_==!1)continue;var d=m.isBullet()||!m.isDynamic(),x=f.isBullet()||!f.isDynamic();if(d==!1&&x==!1)continue;var v=m.m_sweep.alpha0;m.m_sweep.alpha0<f.m_sweep.alpha0?(v=f.m_sweep.alpha0,m.m_sweep.advance(v)):f.m_sweep.alpha0<m.m_sweep.alpha0&&(v=m.m_sweep.alpha0,f.m_sweep.advance(v));var y=a.getChildIndexA(),g=a.getChildIndexB();an.proxyA.set(c.getShape(),y),an.proxyB.set(h.getShape(),g),an.sweepA.set(m.m_sweep),an.sweepB.set(f.m_sweep),an.tMax=1,Dc(Vl,an);var A=Vl.t;Vl.state==Ne.e_touching?l=zs(v+(1-v)*A,1):l=1,a.m_toi=l,a.m_toiFlag=!0}l<s&&(o=a,s=l)}if(o==null||1-10*ie<s){r.m_stepComplete=!0;break}var w=o.getFixtureA(),C=o.getFixtureB(),S=w.getBody(),P=C.getBody();if(Sm.set(S.m_sweep),Pm.set(P.m_sweep),S.advance(s),P.advance(s),o.update(r),o.m_toiFlag=!1,++o.m_toiCount,o.isEnabled()==!1||o.isTouching()==!1){o.setEnabled(!1),S.m_sweep.set(Sm),P.m_sweep.set(Pm),S.synchronizeTransform(),P.synchronizeTransform();continue}S.setAwake(!0),P.setAwake(!0),this.clear(),this.addBody(S),this.addBody(P),this.addContact(o),S.m_islandFlag=!0,P.m_islandFlag=!0,o.m_islandFlag=!0;for(var F=[S,P],I=0;I<F.length;++I){var O=F[I];if(O.isDynamic())for(var X=O.m_contactList;X;X=X.next){var Q=X.contact;if(!Q.m_islandFlag){var K=X.other;if(!(K.isDynamic()&&!O.isBullet()&&!K.isBullet())){var Nt=Q.m_fixtureA.m_isSensor,ht=Q.m_fixtureB.m_isSensor;if(!(Nt||ht)){if(Cm.set(K.m_sweep),K.m_islandFlag==!1&&K.advance(s),Q.update(r),Q.isEnabled()==!1||Q.isTouching()==!1){K.m_sweep.set(Cm),K.synchronizeTransform();continue}Q.m_islandFlag=!0,this.addContact(Q),!K.m_islandFlag&&(K.m_islandFlag=!0,K.isStatic()||K.setAwake(!0),this.addBody(K))}}}}}sn.reset((1-s)*t.dt),sn.dtRatio=1,sn.positionIterations=20,sn.velocityIterations=t.velocityIterations,sn.warmStarting=!1,this.solveIslandTOI(sn,S,P);for(var I=0;I<this.m_bodies.length;++I){var O=this.m_bodies[I];if(O.m_islandFlag=!1,!!O.isDynamic()){O.synchronizeFixtures();for(var X=O.m_contactList;X;X=X.next)X.contact.m_toiFlag=!1,X.contact.m_islandFlag=!1}}if(r.findNewContacts(),r.m_subStepping){r.m_stepComplete=!1;break}}},e.prototype.solveIslandTOI=function(t,r,i){for(var h=0;h<this.m_bodies.length;++h){var n=this.m_bodies[h];B(n.c_position.c,n.m_sweep.c),n.c_position.a=n.m_sweep.a,B(n.c_velocity.v,n.m_linearVelocity),n.c_velocity.w=n.m_angularVelocity}for(var h=0;h<this.m_contacts.length;++h){var o=this.m_contacts[h];o.initConstraint(t)}for(var h=0;h<t.positionIterations;++h){for(var s=0,a=0;a<this.m_contacts.length;++a){var o=this.m_contacts[a],l=o.solvePositionConstraintTOI(t,r,i);s=zs(s,l)}var c=s>=-1.5*z.linearSlop;if(c)break}var h;B(r.m_sweep.c0,r.c_position.c),r.m_sweep.a0=r.c_position.a,B(i.m_sweep.c0,i.c_position.c),i.m_sweep.a0=i.c_position.a;for(var h=0;h<this.m_contacts.length;++h){var o=this.m_contacts[h];o.initVelocityConstraint(t)}for(var h=0;h<t.velocityIterations;++h)for(var a=0;a<this.m_contacts.length;++a){var o=this.m_contacts[a];o.solveVelocityConstraint(t)}for(var m=t.dt,h=0;h<this.m_bodies.length;++h){var n=this.m_bodies[h];B(wr,n.c_position.c);var f=n.c_position.a;B($t,n.c_velocity.v);var p=n.c_velocity.w;D(Ls,m,$t);var _=$i(Ls);if(_>z.maxTranslationSquared){var d=z.maxTranslation/Bm(_);um($t,d)}var x=m*p;if(x*x>z.maxRotationSquared){var d=z.maxRotation/wm(x);p*=d}er(wr,m,$t),f+=m*p,B(n.c_position.c,wr),n.c_position.a=f,B(n.c_velocity.v,$t),n.c_velocity.w=p,B(n.m_sweep.c,wr),n.m_sweep.a=f,B(n.m_linearVelocity,$t),n.m_angularVelocity=p,n.synchronizeTransform()}this.postSolveIsland()},e.prototype.postSolveIsland=function(){for(var t=0;t<this.m_contacts.length;++t){var r=this.m_contacts[t];this.m_world.postSolve(r,r.m_impulse)}},e}();Q_.TimeStep=Oc;var sr=function(){function e(t,r,i,n){typeof t=="object"&&t!==null?(this.ex=u.clone(t),this.ey=u.clone(r)):typeof t=="number"?(this.ex=u.neo(t,i),this.ey=u.neo(r,n)):(this.ex=u.zero(),this.ey=u.zero())}return e.prototype.toString=function(){return JSON.stringify(this)},e.isValid=function(t){return t===null||typeof t>"u"?!1:u.isValid(t.ex)&&u.isValid(t.ey)},e.assert=function(t){},e.prototype.set=function(t,r,i,n){typeof t=="number"&&typeof r=="number"&&typeof i=="number"&&typeof n=="number"?(this.ex.setNum(t,i),this.ey.setNum(r,n)):typeof t=="object"&&typeof r=="object"?(this.ex.setVec2(t),this.ey.setVec2(r)):typeof t=="object"&&(this.ex.setVec2(t.ex),this.ey.setVec2(t.ey))},e.prototype.setIdentity=function(){this.ex.x=1,this.ey.x=0,this.ex.y=0,this.ey.y=1},e.prototype.setZero=function(){this.ex.x=0,this.ey.x=0,this.ex.y=0,this.ey.y=0},e.prototype.getInverse=function(){var t=this.ex.x,r=this.ey.x,i=this.ex.y,n=this.ey.y,o=t*n-r*i;o!==0&&(o=1/o);var s=new e;return s.ex.x=o*n,s.ey.x=-o*r,s.ex.y=-o*i,s.ey.y=o*t,s},e.prototype.solve=function(t){var r=this.ex.x,i=this.ey.x,n=this.ex.y,o=this.ey.y,s=r*o-i*n;s!==0&&(s=1/s);var a=u.zero();return a.x=s*(o*t.x-i*t.y),a.y=s*(r*t.y-n*t.x),a},e.mul=function(t,r){if(r&&"x"in r&&"y"in r){var i=t.ex.x*r.x+t.ey.x*r.y,n=t.ex.y*r.x+t.ey.y*r.y;return u.neo(i,n)}else if(r&&"ex"in r&&"ey"in r){var o=t.ex.x*r.ex.x+t.ey.x*r.ex.y,s=t.ex.x*r.ey.x+t.ey.x*r.ey.y,a=t.ex.y*r.ex.x+t.ey.y*r.ex.y,l=t.ex.y*r.ey.x+t.ey.y*r.ey.y;return new e(o,s,a,l)}},e.mulVec2=function(t,r){var i=t.ex.x*r.x+t.ey.x*r.y,n=t.ex.y*r.x+t.ey.y*r.y;return u.neo(i,n)},e.mulMat22=function(t,r){var i=t.ex.x*r.ex.x+t.ey.x*r.ex.y,n=t.ex.x*r.ey.x+t.ey.x*r.ey.y,o=t.ex.y*r.ex.x+t.ey.y*r.ex.y,s=t.ex.y*r.ey.x+t.ey.y*r.ey.y;return new e(i,n,o,s)},e.mulT=function(t,r){if(r&&"x"in r&&"y"in r)return u.neo(u.dot(r,t.ex),u.dot(r,t.ey));if(r&&"ex"in r&&"ey"in r){var i=u.neo(u.dot(t.ex,r.ex),u.dot(t.ey,r.ex)),n=u.neo(u.dot(t.ex,r.ey),u.dot(t.ey,r.ey));return new e(i,n)}},e.mulTVec2=function(t,r){return u.neo(u.dot(r,t.ex),u.dot(r,t.ey))},e.mulTMat22=function(t,r){var i=u.neo(u.dot(t.ex,r.ex),u.dot(t.ey,r.ex)),n=u.neo(u.dot(t.ex,r.ey),u.dot(t.ey,r.ey));return new e(i,n)},e.abs=function(t){return new e(u.abs(t.ex),u.abs(t.ey))},e.add=function(t,r){return new e(u.add(t.ex,r.ex),u.add(t.ey,r.ey))},e}(),Dg=Math.sqrt,Tl=b(0,0),kl=b(0,0),so=b(0,0),Br=b(0,0),Cr=b(0,0),Il=b(0,0),Fs=b(0,0),Ur=b(0,0),yt;(function(e){e[e.e_unset=-1]="e_unset",e[e.e_circles=0]="e_circles",e[e.e_faceA=1]="e_faceA",e[e.e_faceB=2]="e_faceB"})(yt||(yt={}));var Z;(function(e){e[e.e_unset=-1]="e_unset",e[e.e_vertex=0]="e_vertex",e[e.e_face=1]="e_face"})(Z||(Z={}));var Di;(function(e){e[e.nullState=0]="nullState",e[e.addState=1]="addState",e[e.persistState=2]="persistState",e[e.removeState=3]="removeState"})(Di||(Di={}));var Se=function(){function e(){this.v=b(0,0),this.id=new K_}return e.prototype.set=function(t){B(this.v,t.v),this.id.set(t.id)},e.prototype.recycle=function(){R(this.v),this.id.recycle()},e}(),G_=function(){function e(){this.localNormal=b(0,0),this.localPoint=b(0,0),this.points=[new bm,new bm],this.pointCount=0}return e.prototype.set=function(t){this.type=t.type,B(this.localNormal,t.localNormal),B(this.localPoint,t.localPoint),this.pointCount=t.pointCount,this.points[0].set(t.points[0]),this.points[1].set(t.points[1])},e.prototype.recycle=function(){this.type=yt.e_unset,R(this.localNormal),R(this.localPoint),this.pointCount=0,this.points[0].recycle(),this.points[1].recycle()},e.prototype.getWorldManifold=function(t,r,i,n,o){if(this.pointCount==0)return t;t=t||new Z_,t.pointCount=this.pointCount;var s=t.normal,a=t.points,l=t.separations;switch(this.type){case yt.e_circles:{Ot(s,1,0);var c=this.points[0];U(Tl,r,this.localPoint),U(kl,n,c.localPoint),$(Il,kl,Tl);var h=$i(Il);if(h>ie*ie){var m=Dg(h);D(s,1/m,Il)}ft(Br,1,Tl,i,s),ft(Cr,1,kl,-o,s),ft(a[0],.5,Br,.5,Cr),l[0]=V($(so,Cr,Br),s);break}case yt.e_faceA:{qe(s,r.q,this.localNormal),U(Fs,r,this.localPoint);for(var f=0;f<this.pointCount;++f){var c=this.points[f];U(Ur,n,c.localPoint),ft(Br,1,Ur,i-V($(so,Ur,Fs),s),s),ft(Cr,1,Ur,-o,s),ft(a[f],.5,Br,.5,Cr),l[f]=V($(so,Cr,Br),s)}break}case yt.e_faceB:{qe(s,n.q,this.localNormal),U(Fs,n,this.localPoint);for(var f=0;f<this.pointCount;++f){var c=this.points[f];U(Ur,r,c.localPoint),ft(Cr,1,Ur,o-V($(so,Ur,Fs),s),s),ft(Br,1,Ur,-i,s),ft(a[f],.5,Br,.5,Cr),l[f]=V($(so,Br,Cr),s)}Jo(s);break}}return t},e.clipSegmentToLine=Xo,e.ClipVertex=Se,e.getPointStates=Og,e.PointState=Di,e}(),bm=function(){function e(){this.localPoint=b(0,0),this.normalImpulse=0,this.tangentImpulse=0,this.id=new K_}return e.prototype.set=function(t){B(this.localPoint,t.localPoint),this.normalImpulse=t.normalImpulse,this.tangentImpulse=t.tangentImpulse,this.id.set(t.id)},e.prototype.recycle=function(){R(this.localPoint),this.normalImpulse=0,this.tangentImpulse=0,this.id.recycle()},e}(),K_=function(){function e(){this.key=-1,this.indexA=-1,this.indexB=-1,this.typeA=Z.e_unset,this.typeB=Z.e_unset}return e.prototype.setFeatures=function(t,r,i,n){this.indexA=t,this.indexB=i,this.typeA=r,this.typeB=n,this.key=this.indexA+this.indexB*4+this.typeA*16+this.typeB*64},e.prototype.set=function(t){this.indexA=t.indexA,this.indexB=t.indexB,this.typeA=t.typeA,this.typeB=t.typeB,this.key=this.indexA+this.indexB*4+this.typeA*16+this.typeB*64},e.prototype.swapFeatures=function(){var t=this.indexA,r=this.indexB,i=this.typeA,n=this.typeB;this.indexA=r,this.indexB=t,this.typeA=n,this.typeB=i,this.key=this.indexA+this.indexB*4+this.typeA*16+this.typeB*64},e.prototype.recycle=function(){this.indexA=0,this.indexB=0,this.typeA=Z.e_unset,this.typeB=Z.e_unset,this.key=-1},e}(),Z_=function(){function e(){this.normal=b(0,0),this.points=[b(0,0),b(0,0)],this.separations=[0,0],this.pointCount=0}return e.prototype.recycle=function(){R(this.normal),R(this.points[0]),R(this.points[1]),this.separations[0]=0,this.separations[1]=0,this.pointCount=0},e}();function Og(e,t,r,i){for(var n=0;n<r.pointCount;++n){var o=r.points[n].id;e[n]=Di.removeState;for(var s=0;s<i.pointCount;++s)if(i.points[s].id.key===o.key){e[n]=Di.persistState;break}}for(var n=0;n<i.pointCount;++n){var o=i.points[n].id;t[n]=Di.addState;for(var s=0;s<r.pointCount;++s)if(r.points[s].id.key===o.key){t[n]=Di.persistState;break}}}function Xo(e,t,r,i,n){var o=0,s=V(r,t[0].v)-i,a=V(r,t[1].v)-i;if(s<=0&&e[o++].set(t[0]),a<=0&&e[o++].set(t[1]),s*a<0){var l=s/(s-a);ft(e[o].v,1-l,t[0].v,l,t[1].v),e[o].id.setFeatures(n,Z.e_vertex,t[0].id.indexB,Z.e_face),++o}return o}var qg=Math.sqrt,Ug=Math.max,$g=Math.min,Mm=new Mo({create:function(){return new Ar},release:function(e){e.recycle()}}),ln=new G_,Es=new Z_,Vm=function(){function e(t){this.prev=null,this.next=null,this.other=null,this.contact=t}return e.prototype.recycle=function(){this.prev=null,this.next=null,this.other=null},e}();function Tm(e,t){return qg(e*t)}function km(e,t){return e>t?e:t}var Ci=[],Im=function(){function e(){this.rA=b(0,0),this.rB=b(0,0),this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.velocityBias=0}return e.prototype.recycle=function(){R(this.rA),R(this.rB),this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.velocityBias=0},e}(),Sr=b(0,0),wt=b(0,0),Pr=b(0,0),Bt=b(0,0),$r=b(0,0),Si=tn(0,0,0),Pi=tn(0,0,0),Ns=b(0,0),Rs=b(0,0),un=b(0,0),Ds=b(0,0),zl=b(0,0),Ll=b(0,0),Pt=b(0,0),nt=b(0,0),ao=b(0,0),ze=b(0,0),cn=b(0,0),hn=b(0,0),ye=b(0,0),br=b(0,0),ut=b(0,0),Le=b(0,0),bt=b(0,0),Mt=b(0,0),hr=b(0,0),Ar=function(){function e(){this.m_nodeA=new Vm(this),this.m_nodeB=new Vm(this),this.m_fixtureA=null,this.m_fixtureB=null,this.m_indexA=-1,this.m_indexB=-1,this.m_evaluateFcn=null,this.m_manifold=new G_,this.m_prev=null,this.m_next=null,this.m_toi=1,this.m_toiCount=0,this.m_toiFlag=!1,this.m_friction=0,this.m_restitution=0,this.m_tangentSpeed=0,this.m_enabledFlag=!0,this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.m_impulse=new Rg(this),this.v_points=[new Im,new Im],this.v_normal=b(0,0),this.v_normalMass=new sr,this.v_K=new sr,this.v_pointCount=0,this.v_tangentSpeed=0,this.v_friction=0,this.v_restitution=0,this.v_invMassA=0,this.v_invMassB=0,this.v_invIA=0,this.v_invIB=0,this.p_localPoints=[b(0,0),b(0,0)],this.p_localNormal=b(0,0),this.p_localPoint=b(0,0),this.p_localCenterA=b(0,0),this.p_localCenterB=b(0,0),this.p_type=yt.e_unset,this.p_radiusA=0,this.p_radiusB=0,this.p_pointCount=0,this.p_invMassA=0,this.p_invMassB=0,this.p_invIA=0,this.p_invIB=0}return e.prototype.initialize=function(t,r,i,n,o){this.m_fixtureA=t,this.m_fixtureB=i,this.m_indexA=r,this.m_indexB=n,this.m_evaluateFcn=o,this.m_friction=Tm(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction),this.m_restitution=km(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)},e.prototype.recycle=function(){this.m_nodeA.recycle(),this.m_nodeB.recycle(),this.m_fixtureA=null,this.m_fixtureB=null,this.m_indexA=-1,this.m_indexB=-1,this.m_evaluateFcn=null,this.m_manifold.recycle(),this.m_prev=null,this.m_next=null,this.m_toi=1,this.m_toiCount=0,this.m_toiFlag=!1,this.m_friction=0,this.m_restitution=0,this.m_tangentSpeed=0,this.m_enabledFlag=!0,this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.m_impulse.recycle();for(var t=0,r=this.v_points;t<r.length;t++){var i=r[t];i.recycle()}R(this.v_normal),this.v_normalMass.setZero(),this.v_K.setZero(),this.v_pointCount=0,this.v_tangentSpeed=0,this.v_friction=0,this.v_restitution=0,this.v_invMassA=0,this.v_invMassB=0,this.v_invIA=0,this.v_invIB=0;for(var n=0,o=this.p_localPoints;n<o.length;n++){var s=o[n];R(s)}R(this.p_localNormal),R(this.p_localPoint),R(this.p_localCenterA),R(this.p_localCenterB),this.p_type=yt.e_unset,this.p_radiusA=0,this.p_radiusB=0,this.p_pointCount=0,this.p_invMassA=0,this.p_invMassB=0,this.p_invIA=0,this.p_invIB=0},e.prototype.initConstraint=function(t){var r=this.m_fixtureA,i=this.m_fixtureB;if(!(r===null||i===null)){var n=r.m_body,o=i.m_body;if(!(n===null||o===null)){var s=r.m_shape,a=i.m_shape;if(!(s===null||a===null)){var l=this.m_manifold,c=l.pointCount;this.v_invMassA=n.m_invMass,this.v_invMassB=o.m_invMass,this.v_invIA=n.m_invI,this.v_invIB=o.m_invI,this.v_friction=this.m_friction,this.v_restitution=this.m_restitution,this.v_tangentSpeed=this.m_tangentSpeed,this.v_pointCount=c,this.v_K.setZero(),this.v_normalMass.setZero(),this.p_invMassA=n.m_invMass,this.p_invMassB=o.m_invMass,this.p_invIA=n.m_invI,this.p_invIB=o.m_invI,B(this.p_localCenterA,n.m_sweep.localCenter),B(this.p_localCenterB,o.m_sweep.localCenter),this.p_radiusA=s.m_radius,this.p_radiusB=a.m_radius,this.p_type=l.type,B(this.p_localNormal,l.localNormal),B(this.p_localPoint,l.localPoint),this.p_pointCount=c;for(var h=0;h<z.maxManifoldPoints;++h)this.v_points[h].recycle(),R(this.p_localPoints[h]);for(var h=0;h<c;++h){var m=l.points[h],f=this.v_points[h];t.warmStarting&&(f.normalImpulse=t.dtRatio*m.normalImpulse,f.tangentImpulse=t.dtRatio*m.tangentImpulse),B(this.p_localPoints[h],m.localPoint)}}}}},e.prototype.getManifold=function(){return this.m_manifold},e.prototype.getWorldManifold=function(t){var r=this.m_fixtureA,i=this.m_fixtureB;if(!(r===null||i===null)){var n=r.m_body,o=i.m_body;if(!(n===null||o===null)){var s=r.m_shape,a=i.m_shape;if(!(s===null||a===null))return this.m_manifold.getWorldManifold(t,n.getTransform(),s.m_radius,o.getTransform(),a.m_radius)}}},e.prototype.setEnabled=function(t){this.m_enabledFlag=!!t},e.prototype.isEnabled=function(){return this.m_enabledFlag},e.prototype.isTouching=function(){return this.m_touchingFlag},e.prototype.getNext=function(){return this.m_next},e.prototype.getFixtureA=function(){return this.m_fixtureA},e.prototype.getFixtureB=function(){return this.m_fixtureB},e.prototype.getChildIndexA=function(){return this.m_indexA},e.prototype.getChildIndexB=function(){return this.m_indexB},e.prototype.flagForFiltering=function(){this.m_filterFlag=!0},e.prototype.setFriction=function(t){this.m_friction=t},e.prototype.getFriction=function(){return this.m_friction},e.prototype.resetFriction=function(){var t=this.m_fixtureA,r=this.m_fixtureB;t===null||r===null||(this.m_friction=Tm(t.m_friction,r.m_friction))},e.prototype.setRestitution=function(t){this.m_restitution=t},e.prototype.getRestitution=function(){return this.m_restitution},e.prototype.resetRestitution=function(){var t=this.m_fixtureA,r=this.m_fixtureB;t===null||r===null||(this.m_restitution=km(t.m_restitution,r.m_restitution))},e.prototype.setTangentSpeed=function(t){this.m_tangentSpeed=t},e.prototype.getTangentSpeed=function(){return this.m_tangentSpeed},e.prototype.evaluate=function(t,r,i){var n=this.m_fixtureA,o=this.m_fixtureB;n===null||o===null||this.m_evaluateFcn(t,r,n,this.m_indexA,i,o,this.m_indexB)},e.prototype.update=function(t){var r=this.m_fixtureA,i=this.m_fixtureB;if(!(r===null||i===null)){var n=r.m_body,o=i.m_body;if(!(n===null||o===null)){var s=r.m_shape,a=i.m_shape;if(!(s===null||a===null)){this.m_enabledFlag=!0;var l=!1,c=this.m_touchingFlag,h=r.m_isSensor,m=i.m_isSensor,f=h||m,p=n.m_xf,_=o.m_xf;if(f)l=Y_(s,this.m_indexA,a,this.m_indexB,p,_),this.m_manifold.pointCount=0;else{ln.recycle(),ln.set(this.m_manifold),this.m_manifold.recycle(),this.evaluate(this.m_manifold,p,_),l=this.m_manifold.pointCount>0;for(var d=0;d<this.m_manifold.pointCount;++d){var x=this.m_manifold.points[d];x.normalImpulse=0,x.tangentImpulse=0;for(var v=0;v<ln.pointCount;++v){var y=ln.points[v];if(y.id.key===x.id.key){x.normalImpulse=y.normalImpulse,x.tangentImpulse=y.tangentImpulse;break}}}l!==c&&(n.setAwake(!0),o.setAwake(!0))}this.m_touchingFlag=l;var g=typeof t=="object"&&t!==null;!c&&l&&g&&t.beginContact(this),c&&!l&&g&&t.endContact(this),!f&&l&&g&&ln&&t.preSolve(this,ln)}}}},e.prototype.solvePositionConstraint=function(t){return this._solvePositionConstraint(t,null,null)},e.prototype.solvePositionConstraintTOI=function(t,r,i){return this._solvePositionConstraint(t,r,i)},e.prototype._solvePositionConstraint=function(t,r,i){var n=r!==null&&i!==null,o=0,s=this.m_fixtureA,a=this.m_fixtureB;if(s===null||a===null)return o;var l=s.m_body,c=a.m_body;if(l===null||c===null)return o;var h=l.c_position,m=c.c_position,f=this.p_localCenterA,p=this.p_localCenterB,_=0,d=0;(!n||l===r||l===i)&&(_=this.p_invMassA,d=this.p_invIA);var x=0,v=0;(!n||c===r||c===i)&&(x=this.p_invMassB,v=this.p_invIB),B(Sr,h.c);var y=h.a;B(Pr,m.c);for(var g=m.a,A=0;A<this.p_pointCount;++A){xs(Si,f,Sr,y),xs(Pi,p,Pr,g);var w=void 0;switch(this.p_type){case yt.e_circles:{U(Ns,Si,this.p_localPoint),U(Rs,Pi,this.p_localPoints[0]),$(nt,Rs,Ns),nr(nt),ft(ao,.5,Ns,.5,Rs),w=V(Rs,nt)-V(Ns,nt)-this.p_radiusA-this.p_radiusB;break}case yt.e_faceA:{qe(nt,Si.q,this.p_localNormal),U(Ds,Si,this.p_localPoint),U(un,Pi,this.p_localPoints[A]),w=V(un,nt)-V(Ds,nt)-this.p_radiusA-this.p_radiusB,B(ao,un);break}case yt.e_faceB:{qe(nt,Pi.q,this.p_localNormal),U(Ds,Pi,this.p_localPoint),U(un,Si,this.p_localPoints[A]),w=V(un,nt)-V(Ds,nt)-this.p_radiusA-this.p_radiusB,B(ao,un),Jo(nt);break}default:return o}$(zl,ao,Sr),$(Ll,ao,Pr),o=$g(o,w);var C=n?z.toiBaugarte:z.baumgarte,S=z.linearSlop,P=z.maxLinearCorrection,F=qt(C*(w+S),-P,0),I=J(zl,nt),O=J(Ll,nt),X=_+x+d*I*I+v*O*O,Q=X>0?-F/X:0;D(Pt,Q,nt),yo(Sr,_,Pt),y-=d*J(zl,Pt),er(Pr,x,Pt),g+=v*J(Ll,Pt)}return B(h.c,Sr),h.a=y,B(m.c,Pr),m.a=g,o},e.prototype.initVelocityConstraint=function(t){var r=this.m_fixtureA,i=this.m_fixtureB;if(!(r===null||i===null)){var n=r.m_body,o=i.m_body;if(!(n===null||o===null)){var s=n.c_velocity,a=o.c_velocity,l=n.c_position,c=o.c_position,h=this.p_radiusA,m=this.p_radiusB,f=this.m_manifold,p=this.v_invMassA,_=this.v_invMassB,d=this.v_invIA,x=this.v_invIB,v=this.p_localCenterA,y=this.p_localCenterB;B(Sr,l.c);var g=l.a;B(wt,s.v);var A=s.w;B(Pr,c.c);var w=c.a;B(Bt,a.v);var C=a.w;xs(Si,v,Sr,g),xs(Pi,y,Pr,w),Es.recycle(),f.getWorldManifold(Es,Si,h,Pi,m),B(this.v_normal,Es.normal);for(var S=0;S<this.v_pointCount;++S){var P=this.v_points[S],F=Es.points[S];$(P.rA,F,Sr),$(P.rB,F,Pr);var I=J(P.rA,this.v_normal),O=J(P.rB,this.v_normal),X=p+_+d*I*I+x*O*O;P.normalMass=X>0?1/X:0,Ui($r,this.v_normal,1);var Q=J(P.rA,$r),K=J(P.rB,$r),Nt=p+_+d*Q*Q+x*K*K;P.tangentMass=Nt>0?1/Nt:0,P.velocityBias=0;var ht=0;ht+=V(this.v_normal,Bt),ht+=V(this.v_normal,ge(hr,C,P.rB)),ht-=V(this.v_normal,wt),ht-=V(this.v_normal,ge(hr,A,P.rA)),ht<-z.velocityThreshold&&(P.velocityBias=-this.v_restitution*ht)}if(this.v_pointCount==2&&t.blockSolve){var At=this.v_points[0],k=this.v_points[1],N=J(At.rA,this.v_normal),W=J(At.rB,this.v_normal),et=J(k.rA,this.v_normal),lt=J(k.rB,this.v_normal),Ve=p+_+d*N*N+x*W*W,_e=p+_+d*et*et+x*lt*lt,lr=p+_+d*N*et+x*W*lt,We=1e3;if(Ve*Ve<We*(Ve*_e-lr*lr)){this.v_K.ex.setNum(Ve,lr),this.v_K.ey.setNum(lr,_e);var gi=this.v_K.ex.x,$c=this.v_K.ey.x,jc=this.v_K.ex.y,Wc=this.v_K.ey.y,xi=gi*Wc-$c*jc;xi!==0&&(xi=1/xi),this.v_normalMass.ex.x=xi*Wc,this.v_normalMass.ey.x=-xi*$c,this.v_normalMass.ex.y=-xi*jc,this.v_normalMass.ey.y=xi*gi}else this.v_pointCount=1}B(l.c,Sr),l.a=g,B(s.v,wt),s.w=A,B(c.c,Pr),c.a=w,B(a.v,Bt),a.w=C}}},e.prototype.warmStartConstraint=function(t){var r=this.m_fixtureA,i=this.m_fixtureB;if(!(r===null||i===null)){var n=r.m_body,o=i.m_body;if(!(n===null||o===null)){var s=n.c_velocity,a=o.c_velocity,l=this.v_invMassA,c=this.v_invIA,h=this.v_invMassB,m=this.v_invIB;B(wt,s.v);var f=s.w;B(Bt,a.v);var p=a.w;B(nt,this.v_normal),Ui($r,nt,1);for(var _=0;_<this.v_pointCount;++_){var d=this.v_points[_];ft(Pt,d.normalImpulse,nt,d.tangentImpulse,$r),f-=c*J(d.rA,Pt),yo(wt,l,Pt),p+=m*J(d.rB,Pt),er(Bt,h,Pt)}B(s.v,wt),s.w=f,B(a.v,Bt),a.w=p}}},e.prototype.storeConstraintImpulses=function(t){for(var r=this.m_manifold,i=0;i<this.v_pointCount;++i)r.points[i].normalImpulse=this.v_points[i].normalImpulse,r.points[i].tangentImpulse=this.v_points[i].tangentImpulse},e.prototype.solveVelocityConstraint=function(t){var r=this.m_fixtureA,i=this.m_fixtureB;if(!(r===null||i===null)){var n=r.m_body,o=i.m_body;if(!(n===null||o===null)){var s=n.c_velocity,a=o.c_velocity,l=this.v_invMassA,c=this.v_invIA,h=this.v_invMassB,m=this.v_invIB;B(wt,s.v);var f=s.w;B(Bt,a.v);var p=a.w;B(nt,this.v_normal),Ui($r,nt,1);for(var _=this.v_friction,d=0;d<this.v_pointCount;++d){var x=this.v_points[d];R(ze),Ee(ze,Bt),Ee(ze,ge(hr,p,x.rB)),Vr(ze,wt),Vr(ze,ge(hr,f,x.rA));var v=V(ze,$r)-this.v_tangentSpeed,y=x.tangentMass*-v,g=_*x.normalImpulse,A=qt(x.tangentImpulse+y,-g,g);y=A-x.tangentImpulse,x.tangentImpulse=A,D(Pt,y,$r),yo(wt,l,Pt),f-=c*J(x.rA,Pt),er(Bt,h,Pt),p+=m*J(x.rB,Pt)}if(this.v_pointCount==1||t.blockSolve==!1)for(var w=0;w<this.v_pointCount;++w){var x=this.v_points[w];R(ze),Ee(ze,Bt),Ee(ze,ge(hr,p,x.rB)),Vr(ze,wt),Vr(ze,ge(hr,f,x.rA));var C=V(ze,nt),y=-x.normalMass*(C-x.velocityBias),A=Ug(x.normalImpulse+y,0);y=A-x.normalImpulse,x.normalImpulse=A,D(Pt,y,nt),yo(wt,l,Pt),f-=c*J(x.rA,Pt),er(Bt,h,Pt),p+=m*J(x.rB,Pt)}else{var S=this.v_points[0],P=this.v_points[1];Ot(br,S.normalImpulse,P.normalImpulse),R(cn),Ee(cn,Bt),Ee(cn,ge(hr,p,S.rB)),Vr(cn,wt),Vr(cn,ge(hr,f,S.rA)),R(hn),Ee(hn,Bt),Ee(hn,ge(hr,p,P.rB)),Vr(hn,wt),Vr(hn,ge(hr,f,P.rA));var F=V(cn,nt),I=V(hn,nt);for(Ot(ye,F-S.velocityBias,I-P.velocityBias),ye.x-=this.v_K.ex.x*br.x+this.v_K.ey.x*br.y,ye.y-=this.v_K.ex.y*br.x+this.v_K.ey.y*br.y;;){if(R(ut),ut.x=-(this.v_normalMass.ex.x*ye.x+this.v_normalMass.ey.x*ye.y),ut.y=-(this.v_normalMass.ex.y*ye.x+this.v_normalMass.ey.y*ye.y),ut.x>=0&&ut.y>=0){$(Le,ut,br),D(bt,Le.x,nt),D(Mt,Le.y,nt),dr(wt,-l,bt,-l,Mt,1,wt),f-=c*(J(S.rA,bt)+J(P.rA,Mt)),dr(Bt,h,bt,h,Mt,1,Bt),p+=m*(J(S.rB,bt)+J(P.rB,Mt)),S.normalImpulse=ut.x,P.normalImpulse=ut.y;break}if(ut.x=-S.normalMass*ye.x,ut.y=0,F=0,I=this.v_K.ex.y*ut.x+ye.y,ut.x>=0&&I>=0){$(Le,ut,br),D(bt,Le.x,nt),D(Mt,Le.y,nt),dr(wt,-l,bt,-l,Mt,1,wt),f-=c*(J(S.rA,bt)+J(P.rA,Mt)),dr(Bt,h,bt,h,Mt,1,Bt),p+=m*(J(S.rB,bt)+J(P.rB,Mt)),S.normalImpulse=ut.x,P.normalImpulse=ut.y;break}if(ut.x=0,ut.y=-P.normalMass*ye.y,F=this.v_K.ey.x*ut.y+ye.x,I=0,ut.y>=0&&F>=0){$(Le,ut,br),D(bt,Le.x,nt),D(Mt,Le.y,nt),dr(wt,-l,bt,-l,Mt,1,wt),f-=c*(J(S.rA,bt)+J(P.rA,Mt)),dr(Bt,h,bt,h,Mt,1,Bt),p+=m*(J(S.rB,bt)+J(P.rB,Mt)),S.normalImpulse=ut.x,P.normalImpulse=ut.y;break}if(ut.x=0,ut.y=0,F=ye.x,I=ye.y,F>=0&&I>=0){$(Le,ut,br),D(bt,Le.x,nt),D(Mt,Le.y,nt),dr(wt,-l,bt,-l,Mt,1,wt),f-=c*(J(S.rA,bt)+J(P.rA,Mt)),dr(Bt,h,bt,h,Mt,1,Bt),p+=m*(J(S.rB,bt)+J(P.rB,Mt)),S.normalImpulse=ut.x,P.normalImpulse=ut.y;break}break}}B(s.v,wt),s.w=f,B(a.v,Bt),a.w=p}}},e.addType=function(t,r,i){Ci[t]=Ci[t]||{},Ci[t][r]=i},e.create=function(t,r,i,n){var o=t.m_shape.m_type,s=i.m_shape.m_type,a=Mm.allocate(),l;if(l=Ci[o]&&Ci[o][s])a.initialize(t,r,i,n,l);else if(l=Ci[s]&&Ci[s][o])a.initialize(i,n,t,r,l);else return null;t=a.m_fixtureA,i=a.m_fixtureB,r=a.getChildIndexA(),n=a.getChildIndexB();var c=t.m_body,h=i.m_body;return a.m_nodeA.contact=a,a.m_nodeA.other=h,a.m_nodeA.prev=null,a.m_nodeA.next=c.m_contactList,c.m_contactList!=null&&(c.m_contactList.prev=a.m_nodeA),c.m_contactList=a.m_nodeA,a.m_nodeB.contact=a,a.m_nodeB.other=c,a.m_nodeB.prev=null,a.m_nodeB.next=h.m_contactList,h.m_contactList!=null&&(h.m_contactList.prev=a.m_nodeB),h.m_contactList=a.m_nodeB,t.isSensor()==!1&&i.isSensor()==!1&&(c.setAwake(!0),h.setAwake(!0)),a},e.destroy=function(t,r){var i=t.m_fixtureA,n=t.m_fixtureB;if(!(i===null||n===null)){var o=i.m_body,s=n.m_body;o===null||s===null||(t.isTouching()&&r.endContact(t),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA==o.m_contactList&&(o.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB==s.m_contactList&&(s.m_contactList=t.m_nodeB.next),t.m_manifold.pointCount>0&&!i.m_isSensor&&!n.m_isSensor&&(o.setAwake(!0),s.setAwake(!0)),Mm.release(t))}},e}(),jg={gravity:u.zero(),allowSleep:!0,warmStarting:!0,continuousPhysics:!0,subStepping:!1,blockSolve:!0,velocityIterations:8,positionIterations:3},es=function(){function e(t){if(!(this instanceof e))return new e(t);this.s_step=new Oc,t?u.isValid(t)&&(t={gravity:t}):t={},t=Me(t,jg),this.m_solver=new Q_(this),this.m_broadPhase=new yg,this.m_contactList=null,this.m_contactCount=0,this.m_bodyList=null,this.m_bodyCount=0,this.m_jointList=null,this.m_jointCount=0,this.m_stepComplete=!0,this.m_allowSleep=t.allowSleep,this.m_gravity=u.clone(t.gravity),this.m_clearForces=!0,this.m_newFixture=!1,this.m_locked=!1,this.m_warmStarting=t.warmStarting,this.m_continuousPhysics=t.continuousPhysics,this.m_subStepping=t.subStepping,this.m_blockSolve=t.blockSolve,this.m_velocityIterations=t.velocityIterations,this.m_positionIterations=t.positionIterations,this.m_t=0,this.m_step_callback=[]}return e.prototype._serialize=function(){for(var t=[],r=[],i=this.getBodyList();i;i=i.getNext())t.push(i);for(var n=this.getJointList();n;n=n.getNext())typeof n._serialize=="function"&&r.push(n);return{gravity:this.m_gravity,bodies:t,joints:r}},e._deserialize=function(t,r,i){if(!t)return new e;var n=new e(t.gravity);if(t.bodies)for(var o=t.bodies.length-1;o>=0;o-=1)n._addBody(i(it,t.bodies[o],n));if(t.joints)for(var o=t.joints.length-1;o>=0;o--)n.createJoint(i(Qt,t.joints[o],n));return n},e.prototype.getBodyList=function(){return this.m_bodyList},e.prototype.getJointList=function(){return this.m_jointList},e.prototype.getContactList=function(){return this.m_contactList},e.prototype.getBodyCount=function(){return this.m_bodyCount},e.prototype.getJointCount=function(){return this.m_jointCount},e.prototype.getContactCount=function(){return this.m_contactCount},e.prototype.setGravity=function(t){this.m_gravity.set(t)},e.prototype.getGravity=function(){return this.m_gravity},e.prototype.isLocked=function(){return this.m_locked},e.prototype.setAllowSleeping=function(t){if(t!=this.m_allowSleep&&(this.m_allowSleep=t,this.m_allowSleep==!1))for(var r=this.m_bodyList;r;r=r.m_next)r.setAwake(!0)},e.prototype.getAllowSleeping=function(){return this.m_allowSleep},e.prototype.setWarmStarting=function(t){this.m_warmStarting=t},e.prototype.getWarmStarting=function(){return this.m_warmStarting},e.prototype.setContinuousPhysics=function(t){this.m_continuousPhysics=t},e.prototype.getContinuousPhysics=function(){return this.m_continuousPhysics},e.prototype.setSubStepping=function(t){this.m_subStepping=t},e.prototype.getSubStepping=function(){return this.m_subStepping},e.prototype.setAutoClearForces=function(t){this.m_clearForces=t},e.prototype.getAutoClearForces=function(){return this.m_clearForces},e.prototype.clearForces=function(){for(var t=this.m_bodyList;t;t=t.getNext())t.m_force.setZero(),t.m_torque=0},e.prototype.queryAABB=function(t,r){var i=this.m_broadPhase;this.m_broadPhase.query(t,function(n){var o=i.getUserData(n);return r(o.fixture)})},e.prototype.rayCast=function(t,r,i){var n=this.m_broadPhase;this.m_broadPhase.rayCast({maxFraction:1,p1:t,p2:r},function(o,s){var a=n.getUserData(s),l=a.fixture,c=a.childIndex,h={},m=l.rayCast(h,o,c);if(m){var f=h.fraction,p=u.add(u.mulNumVec2(1-f,o.p1),u.mulNumVec2(f,o.p2));return i(l,p,h.normal,f)}return o.maxFraction})},e.prototype.getProxyCount=function(){return this.m_broadPhase.getProxyCount()},e.prototype.getTreeHeight=function(){return this.m_broadPhase.getTreeHeight()},e.prototype.getTreeBalance=function(){return this.m_broadPhase.getTreeBalance()},e.prototype.getTreeQuality=function(){return this.m_broadPhase.getTreeQuality()},e.prototype.shiftOrigin=function(t){if(!this.isLocked()){for(var r=this.m_bodyList;r;r=r.m_next)r.m_xf.p.sub(t),r.m_sweep.c0.sub(t),r.m_sweep.c.sub(t);for(var i=this.m_jointList;i;i=i.m_next)i.shiftOrigin(t);this.m_broadPhase.shiftOrigin(t)}},e.prototype._addBody=function(t){this.isLocked()||(t.m_prev=null,t.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=t),this.m_bodyList=t,++this.m_bodyCount)},e.prototype.createBody=function(t,r){if(this.isLocked())return null;var i={};t&&(u.isValid(t)?i={position:t,angle:r}:typeof t=="object"&&(i=t));var n=new it(this,i);return this._addBody(n),n},e.prototype.createDynamicBody=function(t,r){var i={};return t&&(u.isValid(t)?i={position:t,angle:r}:typeof t=="object"&&(i=t)),i.type="dynamic",this.createBody(i)},e.prototype.createKinematicBody=function(t,r){var i={};return t&&(u.isValid(t)?i={position:t,angle:r}:typeof t=="object"&&(i=t)),i.type="kinematic",this.createBody(i)},e.prototype.destroyBody=function(t){if(!this.isLocked()){if(t.m_destroyed)return!1;for(var r=t.m_jointList;r;){var i=r;r=r.next,this.publish("remove-joint",i.joint),this.destroyJoint(i.joint),t.m_jointList=r}t.m_jointList=null;for(var n=t.m_contactList;n;){var o=n;n=n.next,this.destroyContact(o.contact),t.m_contactList=n}t.m_contactList=null;for(var s=t.m_fixtureList;s;){var a=s;s=s.m_next,this.publish("remove-fixture",a),a.destroyProxies(this.m_broadPhase),t.m_fixtureList=s}return t.m_fixtureList=null,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_bodyList&&(this.m_bodyList=t.m_next),t.m_destroyed=!0,--this.m_bodyCount,this.publish("remove-body",t),!0}},e.prototype.createJoint=function(t){if(this.isLocked())return null;if(t.m_prev=null,t.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=t),this.m_jointList=t,++this.m_jointCount,t.m_edgeA.joint=t,t.m_edgeA.other=t.m_bodyB,t.m_edgeA.prev=null,t.m_edgeA.next=t.m_bodyA.m_jointList,t.m_bodyA.m_jointList&&(t.m_bodyA.m_jointList.prev=t.m_edgeA),t.m_bodyA.m_jointList=t.m_edgeA,t.m_edgeB.joint=t,t.m_edgeB.other=t.m_bodyA,t.m_edgeB.prev=null,t.m_edgeB.next=t.m_bodyB.m_jointList,t.m_bodyB.m_jointList&&(t.m_bodyB.m_jointList.prev=t.m_edgeB),t.m_bodyB.m_jointList=t.m_edgeB,t.m_collideConnected==!1)for(var r=t.m_bodyB.getContactList();r;r=r.next)r.other==t.m_bodyA&&r.contact.flagForFiltering();return t},e.prototype.destroyJoint=function(t){if(!this.isLocked()){t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_jointList&&(this.m_jointList=t.m_next);var r=t.m_bodyA,i=t.m_bodyB;if(r.setAwake(!0),i.setAwake(!0),t.m_edgeA.prev&&(t.m_edgeA.prev.next=t.m_edgeA.next),t.m_edgeA.next&&(t.m_edgeA.next.prev=t.m_edgeA.prev),t.m_edgeA==r.m_jointList&&(r.m_jointList=t.m_edgeA.next),t.m_edgeA.prev=null,t.m_edgeA.next=null,t.m_edgeB.prev&&(t.m_edgeB.prev.next=t.m_edgeB.next),t.m_edgeB.next&&(t.m_edgeB.next.prev=t.m_edgeB.prev),t.m_edgeB==i.m_jointList&&(i.m_jointList=t.m_edgeB.next),t.m_edgeB.prev=null,t.m_edgeB.next=null,--this.m_jointCount,t.m_collideConnected==!1)for(var n=i.getContactList();n;)n.other==r&&n.contact.flagForFiltering(),n=n.next;this.publish("remove-joint",t)}},e.prototype.step=function(t,r,i){if(this.publish("pre-step",t),(r|0)!==r&&(r=0),r=r||this.m_velocityIterations,i=i||this.m_positionIterations,this.m_newFixture&&(this.findNewContacts(),this.m_newFixture=!1),this.m_locked=!0,this.s_step.reset(t),this.s_step.velocityIterations=r,this.s_step.positionIterations=i,this.s_step.warmStarting=this.m_warmStarting,this.s_step.blockSolve=this.m_blockSolve,this.updateContacts(),this.m_stepComplete&&t>0){this.m_solver.solveWorld(this.s_step);for(var n=this.m_bodyList;n;n=n.getNext())n.m_islandFlag!=!1&&(n.isStatic()||n.synchronizeFixtures());this.findNewContacts()}this.m_continuousPhysics&&t>0&&this.m_solver.solveWorldTOI(this.s_step),this.m_clearForces&&this.clearForces(),this.m_locked=!1;for(var o;o=this.m_step_callback.shift();)o(this);this.publish("post-step",t)},e.prototype.queueUpdate=function(t){this.isLocked()?this.m_step_callback.push(t):t(this)},e.prototype.findNewContacts=function(){var t=this;this.m_broadPhase.updatePairs(function(r,i){return t.createContact(r,i)})},e.prototype.createContact=function(t,r){var i=t.fixture,n=r.fixture,o=t.childIndex,s=r.childIndex,a=i.getBody(),l=n.getBody();if(a!=l){for(var c=l.getContactList();c;){if(c.other==a){var h=c.contact.getFixtureA(),m=c.contact.getFixtureB(),f=c.contact.getChildIndexA(),p=c.contact.getChildIndexB();if(h==i&&m==n&&f==o&&p==s||h==n&&m==i&&f==s&&p==o)return}c=c.next}if(l.shouldCollide(a)!=!1&&n.shouldCollide(i)!=!1){var _=Ar.create(i,o,n,s);_!=null&&(_.m_prev=null,this.m_contactList!=null&&(_.m_next=this.m_contactList,this.m_contactList.m_prev=_),this.m_contactList=_,++this.m_contactCount)}}},e.prototype.updateContacts=function(){for(var t,r=this.m_contactList;t=r;){r=t.getNext();var i=t.getFixtureA(),n=t.getFixtureB(),o=t.getChildIndexA(),s=t.getChildIndexB(),a=i.getBody(),l=n.getBody();if(t.m_filterFlag){if(l.shouldCollide(a)==!1){this.destroyContact(t);continue}if(n.shouldCollide(i)==!1){this.destroyContact(t);continue}t.m_filterFlag=!1}var c=a.isAwake()&&!a.isStatic(),h=l.isAwake()&&!l.isStatic();if(!(c==!1&&h==!1)){var m=i.m_proxies[o].proxyId,f=n.m_proxies[s].proxyId,p=this.m_broadPhase.testOverlap(m,f);if(p==!1){this.destroyContact(t);continue}t.update(this)}}},e.prototype.destroyContact=function(t){t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_contactList&&(this.m_contactList=t.m_next),Ar.destroy(t,this),--this.m_contactCount},e.prototype.on=function(t,r){return typeof t!="string"||typeof r!="function"?this:(this._listeners||(this._listeners={}),this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(r),this)},e.prototype.off=function(t,r){if(typeof t!="string"||typeof r!="function")return this;var i=this._listeners&&this._listeners[t];if(!i||!i.length)return this;var n=i.indexOf(r);return n>=0&&i.splice(n,1),this},e.prototype.publish=function(t,r,i,n){var o=this._listeners&&this._listeners[t];if(!o||!o.length)return 0;for(var s=0;s<o.length;s++)o[s].call(this,r,i,n);return o.length},e.prototype.beginContact=function(t){this.publish("begin-contact",t)},e.prototype.endContact=function(t){this.publish("end-contact",t)},e.prototype.preSolve=function(t,r){this.publish("pre-solve",t,r)},e.prototype.postSolve=function(t,r){this.publish("post-solve",t,r)},e}(),tt=function(){function e(t,r,i){if(!(this instanceof e))return new e(t,r,i);typeof t>"u"?(this.x=0,this.y=0,this.z=0):typeof t=="object"?(this.x=t.x,this.y=t.y,this.z=t.z):(this.x=t,this.y=r,this.z=i)}return e.prototype._serialize=function(){return{x:this.x,y:this.y,z:this.z}},e._deserialize=function(t){var r=Object.create(e.prototype);return r.x=t.x,r.y=t.y,r.z=t.z,r},e.neo=function(t,r,i){var n=Object.create(e.prototype);return n.x=t,n.y=r,n.z=i,n},e.zero=function(){var t=Object.create(e.prototype);return t.x=0,t.y=0,t.z=0,t},e.clone=function(t){return e.neo(t.x,t.y,t.z)},e.prototype.toString=function(){return JSON.stringify(this)},e.isValid=function(t){return t===null||typeof t>"u"?!1:Number.isFinite(t.x)&&Number.isFinite(t.y)&&Number.isFinite(t.z)},e.assert=function(t){},e.prototype.setZero=function(){return this.x=0,this.y=0,this.z=0,this},e.prototype.set=function(t,r,i){return this.x=t,this.y=r,this.z=i,this},e.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},e.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},e.prototype.mul=function(t){return this.x*=t,this.y*=t,this.z*=t,this},e.areEqual=function(t,r){return t===r||typeof t=="object"&&t!==null&&typeof r=="object"&&r!==null&&t.x===r.x&&t.y===r.y&&t.z===r.z},e.dot=function(t,r){return t.x*r.x+t.y*r.y+t.z*r.z},e.cross=function(t,r){return new e(t.y*r.z-t.z*r.y,t.z*r.x-t.x*r.z,t.x*r.y-t.y*r.x)},e.add=function(t,r){return new e(t.x+r.x,t.y+r.y,t.z+r.z)},e.sub=function(t,r){return new e(t.x-r.x,t.y-r.y,t.z-r.z)},e.mul=function(t,r){return new e(r*t.x,r*t.y,r*t.z)},e.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},e.neg=function(t){return new e(-t.x,-t.y,-t.z)},e}(),zm=b(0,0),Lm=b(0,0),fi=function(e){Zt(t,e);function t(r,i){var n=this;return n instanceof t?(n=e.call(this)||this,n.m_type=t.TYPE,n.m_radius=z.polygonRadius,n.m_vertex1=r?u.clone(r):u.zero(),n.m_vertex2=i?u.clone(i):u.zero(),n.m_vertex0=u.zero(),n.m_vertex3=u.zero(),n.m_hasVertex0=!1,n.m_hasVertex3=!1,n):new t(r,i)}return t.prototype._serialize=function(){return{type:this.m_type,vertex1:this.m_vertex1,vertex2:this.m_vertex2,vertex0:this.m_vertex0,vertex3:this.m_vertex3,hasVertex0:this.m_hasVertex0,hasVertex3:this.m_hasVertex3}},t._deserialize=function(r){var i=new t(r.vertex1,r.vertex2);return i.m_hasVertex0&&i.setPrevVertex(r.vertex0),i.m_hasVertex3&&i.setNextVertex(r.vertex3),i},t.prototype._reset=function(){},t.prototype.getRadius=function(){return this.m_radius},t.prototype.getType=function(){return this.m_type},t.prototype.setNext=function(r){return this.setNextVertex(r)},t.prototype.setNextVertex=function(r){return r?(this.m_vertex3.setVec2(r),this.m_hasVertex3=!0):(this.m_vertex3.setZero(),this.m_hasVertex3=!1),this},t.prototype.getNextVertex=function(){return this.m_vertex3},t.prototype.setPrev=function(r){return this.setPrevVertex(r)},t.prototype.setPrevVertex=function(r){return r?(this.m_vertex0.setVec2(r),this.m_hasVertex0=!0):(this.m_vertex0.setZero(),this.m_hasVertex0=!1),this},t.prototype.getPrevVertex=function(){return this.m_vertex0},t.prototype._set=function(r,i){return this.m_vertex1.setVec2(r),this.m_vertex2.setVec2(i),this.m_hasVertex0=!1,this.m_hasVertex3=!1,this},t.prototype._clone=function(){var r=new t;return r.m_type=this.m_type,r.m_radius=this.m_radius,r.m_vertex1.setVec2(this.m_vertex1),r.m_vertex2.setVec2(this.m_vertex2),r.m_vertex0.setVec2(this.m_vertex0),r.m_vertex3.setVec2(this.m_vertex3),r.m_hasVertex0=this.m_hasVertex0,r.m_hasVertex3=this.m_hasVertex3,r},t.prototype.getChildCount=function(){return 1},t.prototype.testPoint=function(r,i){return!1},t.prototype.rayCast=function(r,i,n,o){var s=M.mulTVec2(n.q,u.sub(i.p1,n.p)),a=M.mulTVec2(n.q,u.sub(i.p2,n.p)),l=u.sub(a,s),c=this.m_vertex1,h=this.m_vertex2,m=u.sub(h,c),f=u.neo(m.y,-m.x);f.normalize();var p=u.dot(f,u.sub(c,s)),_=u.dot(f,l);if(_==0)return!1;var d=p/_;if(d<0||i.maxFraction<d)return!1;var x=u.add(s,u.mulNumVec2(d,l)),v=u.sub(h,c),y=u.dot(v,v);if(y==0)return!1;var g=u.dot(u.sub(x,c),v)/y;return g<0||1<g?!1:(r.fraction=d,p>0?r.normal=M.mulVec2(n.q,f).neg():r.normal=M.mulVec2(n.q,f),!0)},t.prototype.computeAABB=function(r,i,n){U(zm,i,this.m_vertex1),U(Lm,i,this.m_vertex2),Rt.combinePoints(r,zm,Lm),Rt.extend(r,this.m_radius)},t.prototype.computeMass=function(r,i){r.mass=0,ft(r.center,.5,this.m_vertex1,.5,this.m_vertex2),r.I=0},t.prototype.computeDistanceProxy=function(r){r.m_vertices[0]=this.m_vertex1,r.m_vertices[1]=this.m_vertex2,r.m_vertices.length=2,r.m_count=2,r.m_radius=this.m_radius},t.TYPE="edge",t}(en),Fm=b(0,0),Em=b(0,0),ka=function(e){Zt(t,e);function t(r,i){var n=this;return n instanceof t?(n=e.call(this)||this,n.m_type=t.TYPE,n.m_radius=z.polygonRadius,n.m_vertices=[],n.m_count=0,n.m_prevVertex=null,n.m_nextVertex=null,n.m_hasPrevVertex=!1,n.m_hasNextVertex=!1,n.m_isLoop=!!i,r&&r.length&&(i?n._createLoop(r):n._createChain(r)),n):new t(r,i)}return t.prototype._serialize=function(){var r={type:this.m_type,vertices:this.m_isLoop?this.m_vertices.slice(0,this.m_vertices.length-1):this.m_vertices,isLoop:this.m_isLoop,hasPrevVertex:this.m_hasPrevVertex,hasNextVertex:this.m_hasNextVertex,prevVertex:null,nextVertex:null};return this.m_prevVertex&&(r.prevVertex=this.m_prevVertex),this.m_nextVertex&&(r.nextVertex=this.m_nextVertex),r},t._deserialize=function(r,i,n){var o=[];if(r.vertices)for(var s=0;s<r.vertices.length;s++)o.push(n(u,r.vertices[s]));var a=new t(o,r.isLoop);return r.prevVertex&&a.setPrevVertex(r.prevVertex),r.nextVertex&&a.setNextVertex(r.nextVertex),a},t.prototype.getType=function(){return this.m_type},t.prototype.getRadius=function(){return this.m_radius},t.prototype._createLoop=function(r){if(!(r.length<3)){var i;this.m_vertices=[],this.m_count=r.length+1;for(var i=0;i<r.length;++i)this.m_vertices[i]=u.clone(r[i]);return this.m_vertices[r.length]=u.clone(r[0]),this.m_prevVertex=this.m_vertices[this.m_count-2],this.m_nextVertex=this.m_vertices[1],this.m_hasPrevVertex=!0,this.m_hasNextVertex=!0,this}},t.prototype._createChain=function(r){var i;this.m_vertices=[],this.m_count=r.length;for(var i=0;i<r.length;++i)this.m_vertices[i]=u.clone(r[i]);return this.m_prevVertex=null,this.m_nextVertex=null,this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,this},t.prototype._reset=function(){this.m_isLoop?this._createLoop(this.m_vertices.slice(0,this.m_vertices.length-1)):this._createChain(this.m_vertices)},t.prototype.setPrevVertex=function(r){this.m_prevVertex=r,this.m_hasPrevVertex=!0},t.prototype.getPrevVertex=function(){return this.m_prevVertex},t.prototype.setNextVertex=function(r){this.m_nextVertex=r,this.m_hasNextVertex=!0},t.prototype.getNextVertex=function(){return this.m_nextVertex},t.prototype._clone=function(){var r=new t;return r._createChain(this.m_vertices),r.m_type=this.m_type,r.m_radius=this.m_radius,r.m_prevVertex=this.m_prevVertex,r.m_nextVertex=this.m_nextVertex,r.m_hasPrevVertex=this.m_hasPrevVertex,r.m_hasNextVertex=this.m_hasNextVertex,r},t.prototype.getChildCount=function(){return this.m_count-1},t.prototype.getChildEdge=function(r,i){r.m_type=fi.TYPE,r.m_radius=this.m_radius,r.m_vertex1=this.m_vertices[i],r.m_vertex2=this.m_vertices[i+1],i>0?(r.m_vertex0=this.m_vertices[i-1],r.m_hasVertex0=!0):(r.m_vertex0=this.m_prevVertex,r.m_hasVertex0=this.m_hasPrevVertex),i<this.m_count-2?(r.m_vertex3=this.m_vertices[i+2],r.m_hasVertex3=!0):(r.m_vertex3=this.m_nextVertex,r.m_hasVertex3=this.m_hasNextVertex)},t.prototype.getVertex=function(r){return r<this.m_count?this.m_vertices[r]:this.m_vertices[0]},t.prototype.isLoop=function(){return this.m_isLoop},t.prototype.testPoint=function(r,i){return!1},t.prototype.rayCast=function(r,i,n,o){var s=new fi(this.getVertex(o),this.getVertex(o+1));return s.rayCast(r,i,n,0)},t.prototype.computeAABB=function(r,i,n){U(Fm,i,this.getVertex(n)),U(Em,i,this.getVertex(n+1)),Rt.combinePoints(r,Fm,Em)},t.prototype.computeMass=function(r,i){r.mass=0,R(r.center),r.I=0},t.prototype.computeDistanceProxy=function(r,i){r.m_vertices[0]=this.getVertex(i),r.m_vertices[1]=this.getVertex(i+1),r.m_count=2,r.m_radius=this.m_radius},t.TYPE="chain",t}(en),Nm=Math.max,Fl=Math.min,Li=b(0,0),Rm=b(0,0),lo=b(0,0),mn=b(0,0),bi=b(0,0),jr=b(0,0),Dr=function(e){Zt(t,e);function t(r){var i=this;return i instanceof t?(i=e.call(this)||this,i.m_type=t.TYPE,i.m_radius=z.polygonRadius,i.m_centroid=u.zero(),i.m_vertices=[],i.m_normals=[],i.m_count=0,r&&r.length&&i._set(r),i):new t(r)}return t.prototype._serialize=function(){return{type:this.m_type,vertices:this.m_vertices}},t._deserialize=function(r,i,n){var o=[];if(r.vertices)for(var s=0;s<r.vertices.length;s++)o.push(n(u,r.vertices[s]));var a=new t(o);return a},t.prototype.getType=function(){return this.m_type},t.prototype.getRadius=function(){return this.m_radius},t.prototype._clone=function(){var r=new t;r.m_type=this.m_type,r.m_radius=this.m_radius,r.m_count=this.m_count,r.m_centroid.setVec2(this.m_centroid);for(var i=0;i<this.m_count;i++)r.m_vertices.push(this.m_vertices[i].clone());for(var i=0;i<this.m_normals.length;i++)r.m_normals.push(this.m_normals[i].clone());return r},t.prototype.getChildCount=function(){return 1},t.prototype._reset=function(){this._set(this.m_vertices)},t.prototype._set=function(r){if(r.length<3){this._setAsBox(1,1);return}for(var i=Fl(r.length,z.maxPolygonVertices),n=[],o=0;o<i;++o){for(var s=r[o],a=!0,l=0;l<n.length;++l)if(u.distanceSquared(s,n[l])<.25*z.linearSlopSquared){a=!1;break}a&&n.push(u.clone(s))}if(i=n.length,i<3){this._setAsBox(1,1);return}for(var c=0,h=n[0].x,o=1;o<i;++o){var m=n[o].x;(m>h||m===h&&n[o].y<n[c].y)&&(c=o,h=m)}for(var f=[],p=0,_=c;;){f[p]=_;for(var d=0,l=1;l<i;++l){if(d===_){d=l;continue}var x=u.sub(n[d],n[f[p]]),s=u.sub(n[l],n[f[p]]),v=u.crossVec2Vec2(x,s);v<0&&(d=l),v===0&&s.lengthSquared()>x.lengthSquared()&&(d=l)}if(++p,_=d,d===c)break}if(p<3){this._setAsBox(1,1);return}this.m_count=p,this.m_vertices=[];for(var o=0;o<p;++o)this.m_vertices[o]=n[f[o]];for(var o=0;o<p;++o){var y=o,g=o+1<p?o+1:0,A=u.sub(this.m_vertices[g],this.m_vertices[y]);this.m_normals[o]=u.crossVec2Num(A,1),this.m_normals[o].normalize()}this.m_centroid=Wg(this.m_vertices,p)},t.prototype._setAsBox=function(r,i,n,o){if(this.m_vertices[0]=u.neo(r,-i),this.m_vertices[1]=u.neo(r,i),this.m_vertices[2]=u.neo(-r,i),this.m_vertices[3]=u.neo(-r,-i),this.m_normals[0]=u.neo(1,0),this.m_normals[1]=u.neo(0,1),this.m_normals[2]=u.neo(-1,0),this.m_normals[3]=u.neo(0,-1),this.m_count=4,n&&u.isValid(n)){o=o||0,B(this.m_centroid,n);var s=or.identity();s.p.setVec2(n),s.q.setAngle(o);for(var a=0;a<this.m_count;++a)this.m_vertices[a]=or.mulVec2(s,this.m_vertices[a]),this.m_normals[a]=M.mulVec2(s.q,this.m_normals[a])}},t.prototype.testPoint=function(r,i){for(var n=Fc(Li,r,i),o=0;o<this.m_count;++o){var s=V(this.m_normals[o],n)-V(this.m_normals[o],this.m_vertices[o]);if(s>0)return!1}return!0},t.prototype.rayCast=function(r,i,n,o){for(var s=M.mulTVec2(n.q,u.sub(i.p1,n.p)),a=M.mulTVec2(n.q,u.sub(i.p2,n.p)),l=u.sub(a,s),c=0,h=i.maxFraction,m=-1,f=0;f<this.m_count;++f){var p=u.dot(this.m_normals[f],u.sub(this.m_vertices[f],s)),_=u.dot(this.m_normals[f],l);if(_==0){if(p<0)return!1}else _<0&&p<c*_?(c=p/_,m=f):_>0&&p<h*_&&(h=p/_);if(h<c)return!1}return m>=0?(r.fraction=c,r.normal=M.mulVec2(n.q,this.m_normals[m]),!0):!1},t.prototype.computeAABB=function(r,i,n){for(var o=1/0,s=1/0,a=-1/0,l=-1/0,c=0;c<this.m_count;++c){var h=U(Li,i,this.m_vertices[c]);o=Fl(o,h.x),a=Nm(a,h.x),s=Fl(s,h.y),l=Nm(l,h.y)}Ot(r.lowerBound,o-this.m_radius,s-this.m_radius),Ot(r.upperBound,a+this.m_radius,l+this.m_radius)},t.prototype.computeMass=function(r,i){R(bi);var n=0,o=0;R(jr);for(var s=0;s<this.m_count;++s)Ee(jr,this.m_vertices[s]);D(jr,1/this.m_count,jr);for(var a=1/3,s=0;s<this.m_count;++s){$(lo,this.m_vertices[s],jr),s+1<this.m_count?$(mn,this.m_vertices[s+1],jr):$(mn,this.m_vertices[0],jr);var l=J(lo,mn),c=.5*l;n+=c,ft(Li,c*a,lo,c*a,mn),Ee(bi,Li);var h=lo.x,m=lo.y,f=mn.x,p=mn.y,_=h*h+f*h+f*f,d=m*m+p*m+p*p;o+=.25*a*l*(_+d)}r.mass=i*n,D(bi,1/n,bi),xg(r.center,bi,jr),r.I=i*o,r.I+=r.mass*(V(r.center,r.center)-V(bi,bi))},t.prototype.validate=function(){for(var r=0;r<this.m_count;++r){var i=r,n=r<this.m_count-1?i+1:0,o=this.m_vertices[i];$(Rm,this.m_vertices[n],o);for(var s=0;s<this.m_count;++s)if(!(s==i||s==n)){var a=J(Rm,$(Li,this.m_vertices[s],o));if(a<0)return!1}}return!0},t.prototype.computeDistanceProxy=function(r){for(var i=0;i<this.m_count;++i)r.m_vertices[i]=this.m_vertices[i];r.m_vertices.length=this.m_count,r.m_count=this.m_count,r.m_radius=this.m_radius},t.TYPE="polygon",t}(en);function Wg(e,t){for(var r=u.zero(),i=0,n=u.zero(),o,s=1/3,o=0;o<t;++o){var a=n,l=e[o],c=o+1<t?e[o+1]:e[0],h=u.sub(l,a),m=u.sub(c,a),f=u.crossVec2Vec2(h,m),p=.5*f;i+=p,dr(Li,1,a,1,l,1,c),er(r,p*s,Li)}return r.mul(1/i),r}var Hg=Math.sqrt,Yg=Math.PI,Dm=b(0,0),pi=function(e){Zt(t,e);function t(r,i){var n=this;return n instanceof t?(n=e.call(this)||this,n.m_type=t.TYPE,n.m_p=u.zero(),n.m_radius=1,typeof r=="object"&&u.isValid(r)?(n.m_p.setVec2(r),typeof i=="number"&&(n.m_radius=i)):typeof r=="number"&&(n.m_radius=r),n):new t(r,i)}return t.prototype._serialize=function(){return{type:this.m_type,p:this.m_p,radius:this.m_radius}},t._deserialize=function(r){return new t(r.p,r.radius)},t.prototype._reset=function(){},t.prototype.getType=function(){return this.m_type},t.prototype.getRadius=function(){return this.m_radius},t.prototype.getCenter=function(){return this.m_p},t.prototype._clone=function(){var r=new t;return r.m_type=this.m_type,r.m_radius=this.m_radius,r.m_p=this.m_p.clone(),r},t.prototype.getChildCount=function(){return 1},t.prototype.testPoint=function(r,i){var n=U(Dm,r,this.m_p);return ji(i,n)<=this.m_radius*this.m_radius},t.prototype.rayCast=function(r,i,n,o){var s=u.add(n.p,M.mulVec2(n.q,this.m_p)),a=u.sub(i.p1,s),l=u.dot(a,a)-this.m_radius*this.m_radius,c=u.sub(i.p2,i.p1),h=u.dot(a,c),m=u.dot(c,c),f=h*h-m*l;if(f<0||m<ie)return!1;var p=-(h+Hg(f));return 0<=p&&p<=i.maxFraction*m?(p/=m,r.fraction=p,r.normal=u.add(a,u.mulNumVec2(p,c)),r.normal.normalize(),!0):!1},t.prototype.computeAABB=function(r,i,n){var o=U(Dm,i,this.m_p);Ot(r.lowerBound,o.x-this.m_radius,o.y-this.m_radius),Ot(r.upperBound,o.x+this.m_radius,o.y+this.m_radius)},t.prototype.computeMass=function(r,i){r.mass=i*Yg*this.m_radius*this.m_radius,B(r.center,this.m_p),r.I=r.mass*(.5*this.m_radius*this.m_radius+$i(this.m_p))},t.prototype.computeDistanceProxy=function(r){r.m_vertices[0]=this.m_p,r.m_vertices.length=1,r.m_count=1,r.m_radius=this.m_radius},t.TYPE="circle",t}(en),Jg=Math.abs,Xg=Math.PI,Qg={frequencyHz:0,dampingRatio:0},Om=function(e){Zt(t,e);function t(r,i,n,o,s){var a=this;if(!(a instanceof t))return new t(r,i,n,o,s);if(n&&o&&"m_type"in o&&"x"in n&&"y"in n){var l=n;n=o,o=l}return r=Me(r,Qg),a=e.call(this,r,i,n)||this,i=a.m_bodyA,n=a.m_bodyB,a.m_type=t.TYPE,a.m_localAnchorA=u.clone(o?i.getLocalPoint(o):r.localAnchorA||u.zero()),a.m_localAnchorB=u.clone(s?n.getLocalPoint(s):r.localAnchorB||u.zero()),a.m_length=Number.isFinite(r.length)?r.length:u.distance(i.getWorldPoint(a.m_localAnchorA),n.getWorldPoint(a.m_localAnchorB)),a.m_frequencyHz=r.frequencyHz,a.m_dampingRatio=r.dampingRatio,a.m_impulse=0,a.m_gamma=0,a.m_bias=0,a}return t.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,length:this.m_length,impulse:this.m_impulse,gamma:this.m_gamma,bias:this.m_bias}},t._deserialize=function(r,i,n){r=Kt({},r),r.bodyA=n(it,r.bodyA,i),r.bodyB=n(it,r.bodyB,i);var o=new t(r);return o},t.prototype._reset=function(r){r.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(r.anchorA)):r.localAnchorA&&this.m_localAnchorA.setVec2(r.localAnchorA),r.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(r.anchorB)):r.localAnchorB&&this.m_localAnchorB.setVec2(r.localAnchorB),r.length>0?this.m_length=+r.length:r.length<0||(r.anchorA||r.anchorA||r.anchorA||r.anchorA)&&(this.m_length=u.distance(this.m_bodyA.getWorldPoint(this.m_localAnchorA),this.m_bodyB.getWorldPoint(this.m_localAnchorB))),Number.isFinite(r.frequencyHz)&&(this.m_frequencyHz=r.frequencyHz),Number.isFinite(r.dampingRatio)&&(this.m_dampingRatio=r.dampingRatio)},t.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},t.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},t.prototype.setLength=function(r){this.m_length=r},t.prototype.getLength=function(){return this.m_length},t.prototype.setFrequency=function(r){this.m_frequencyHz=r},t.prototype.getFrequency=function(){return this.m_frequencyHz},t.prototype.setDampingRatio=function(r){this.m_dampingRatio=r},t.prototype.getDampingRatio=function(){return this.m_dampingRatio},t.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},t.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},t.prototype.getReactionForce=function(r){return u.mulNumVec2(this.m_impulse,this.m_u).mul(r)},t.prototype.getReactionTorque=function(r){return 0},t.prototype.initVelocityConstraints=function(r){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var i=this.m_bodyA.c_position.c,n=this.m_bodyA.c_position.a,o=this.m_bodyA.c_velocity.v,s=this.m_bodyA.c_velocity.w,a=this.m_bodyB.c_position.c,l=this.m_bodyB.c_position.a,c=this.m_bodyB.c_velocity.v,h=this.m_bodyB.c_velocity.w,m=M.neo(n),f=M.neo(l);this.m_rA=M.mulVec2(m,u.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=M.mulVec2(f,u.sub(this.m_localAnchorB,this.m_localCenterB)),this.m_u=u.sub(u.add(a,this.m_rB),u.add(i,this.m_rA));var p=this.m_u.length();p>z.linearSlop?this.m_u.mul(1/p):this.m_u.setNum(0,0);var _=u.crossVec2Vec2(this.m_rA,this.m_u),d=u.crossVec2Vec2(this.m_rB,this.m_u),x=this.m_invMassA+this.m_invIA*_*_+this.m_invMassB+this.m_invIB*d*d;if(this.m_mass=x!=0?1/x:0,this.m_frequencyHz>0){var v=p-this.m_length,y=2*Xg*this.m_frequencyHz,g=2*this.m_mass*this.m_dampingRatio*y,A=this.m_mass*y*y,w=r.dt;this.m_gamma=w*(g+w*A),this.m_gamma=this.m_gamma!=0?1/this.m_gamma:0,this.m_bias=v*w*A*this.m_gamma,x+=this.m_gamma,this.m_mass=x!=0?1/x:0}else this.m_gamma=0,this.m_bias=0;if(r.warmStarting){this.m_impulse*=r.dtRatio;var C=u.mulNumVec2(this.m_impulse,this.m_u);o.subMul(this.m_invMassA,C),s-=this.m_invIA*u.crossVec2Vec2(this.m_rA,C),c.addMul(this.m_invMassB,C),h+=this.m_invIB*u.crossVec2Vec2(this.m_rB,C)}else this.m_impulse=0;this.m_bodyA.c_velocity.v.setVec2(o),this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v.setVec2(c),this.m_bodyB.c_velocity.w=h},t.prototype.solveVelocityConstraints=function(r){var i=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,a=u.add(i,u.crossNumVec2(n,this.m_rA)),l=u.add(o,u.crossNumVec2(s,this.m_rB)),c=u.dot(this.m_u,l)-u.dot(this.m_u,a),h=-this.m_mass*(c+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=h;var m=u.mulNumVec2(h,this.m_u);i.subMul(this.m_invMassA,m),n-=this.m_invIA*u.crossVec2Vec2(this.m_rA,m),o.addMul(this.m_invMassB,m),s+=this.m_invIB*u.crossVec2Vec2(this.m_rB,m),this.m_bodyA.c_velocity.v.setVec2(i),this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v.setVec2(o),this.m_bodyB.c_velocity.w=s},t.prototype.solvePositionConstraints=function(r){if(this.m_frequencyHz>0)return!0;var i=this.m_bodyA.c_position.c,n=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,s=this.m_bodyB.c_position.a,a=M.neo(n),l=M.neo(s),c=M.mulSub(a,this.m_localAnchorA,this.m_localCenterA),h=M.mulSub(l,this.m_localAnchorB,this.m_localCenterB),m=u.sub(u.add(o,h),u.add(i,c)),f=m.normalize(),p=qt(f-this.m_length,-z.maxLinearCorrection,z.maxLinearCorrection),_=-this.m_mass*p,d=u.mulNumVec2(_,m);return i.subMul(this.m_invMassA,d),n-=this.m_invIA*u.crossVec2Vec2(c,d),o.addMul(this.m_invMassB,d),s+=this.m_invIB*u.crossVec2Vec2(h,d),this.m_bodyA.c_position.c.setVec2(i),this.m_bodyA.c_position.a=n,this.m_bodyB.c_position.c.setVec2(o),this.m_bodyB.c_position.a=s,Jg(p)<z.linearSlop},t.TYPE="distance-joint",t}(Qt),Gg={maxForce:0,maxTorque:0},qm=function(e){Zt(t,e);function t(r,i,n,o){var s=this;return s instanceof t?(r=Me(r,Gg),s=e.call(this,r,i,n)||this,i=s.m_bodyA,n=s.m_bodyB,s.m_type=t.TYPE,s.m_localAnchorA=u.clone(o?i.getLocalPoint(o):r.localAnchorA||u.zero()),s.m_localAnchorB=u.clone(o?n.getLocalPoint(o):r.localAnchorB||u.zero()),s.m_linearImpulse=u.zero(),s.m_angularImpulse=0,s.m_maxForce=r.maxForce,s.m_maxTorque=r.maxTorque,s):new t(r,i,n,o)}return t.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,maxForce:this.m_maxForce,maxTorque:this.m_maxTorque,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB}},t._deserialize=function(r,i,n){r=Kt({},r),r.bodyA=n(it,r.bodyA,i),r.bodyB=n(it,r.bodyB,i);var o=new t(r);return o},t.prototype._reset=function(r){r.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(r.anchorA)):r.localAnchorA&&this.m_localAnchorA.setVec2(r.localAnchorA),r.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(r.anchorB)):r.localAnchorB&&this.m_localAnchorB.setVec2(r.localAnchorB),Number.isFinite(r.maxForce)&&(this.m_maxForce=r.maxForce),Number.isFinite(r.maxTorque)&&(this.m_maxTorque=r.maxTorque)},t.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},t.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},t.prototype.setMaxForce=function(r){this.m_maxForce=r},t.prototype.getMaxForce=function(){return this.m_maxForce},t.prototype.setMaxTorque=function(r){this.m_maxTorque=r},t.prototype.getMaxTorque=function(){return this.m_maxTorque},t.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},t.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},t.prototype.getReactionForce=function(r){return u.mulNumVec2(r,this.m_linearImpulse)},t.prototype.getReactionTorque=function(r){return r*this.m_angularImpulse},t.prototype.initVelocityConstraints=function(r){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var i=this.m_bodyA.c_position.a,n=this.m_bodyA.c_velocity.v,o=this.m_bodyA.c_velocity.w,s=this.m_bodyB.c_position.a,a=this.m_bodyB.c_velocity.v,l=this.m_bodyB.c_velocity.w,c=M.neo(i),h=M.neo(s);this.m_rA=M.mulVec2(c,u.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=M.mulVec2(h,u.sub(this.m_localAnchorB,this.m_localCenterB));var m=this.m_invMassA,f=this.m_invMassB,p=this.m_invIA,_=this.m_invIB,d=new sr;if(d.ex.x=m+f+p*this.m_rA.y*this.m_rA.y+_*this.m_rB.y*this.m_rB.y,d.ex.y=-p*this.m_rA.x*this.m_rA.y-_*this.m_rB.x*this.m_rB.y,d.ey.x=d.ex.y,d.ey.y=m+f+p*this.m_rA.x*this.m_rA.x+_*this.m_rB.x*this.m_rB.x,this.m_linearMass=d.getInverse(),this.m_angularMass=p+_,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),r.warmStarting){this.m_linearImpulse.mul(r.dtRatio),this.m_angularImpulse*=r.dtRatio;var x=u.neo(this.m_linearImpulse.x,this.m_linearImpulse.y);n.subMul(m,x),o-=p*(u.crossVec2Vec2(this.m_rA,x)+this.m_angularImpulse),a.addMul(f,x),l+=_*(u.crossVec2Vec2(this.m_rB,x)+this.m_angularImpulse)}else this.m_linearImpulse.setZero(),this.m_angularImpulse=0;this.m_bodyA.c_velocity.v=n,this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v=a,this.m_bodyB.c_velocity.w=l},t.prototype.solveVelocityConstraints=function(r){var i=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,a=this.m_invMassA,l=this.m_invMassB,c=this.m_invIA,h=this.m_invIB,m=r.dt;{var f=s-n,p=-this.m_angularMass*f,_=this.m_angularImpulse,d=m*this.m_maxTorque;this.m_angularImpulse=qt(this.m_angularImpulse+p,-d,d),p=this.m_angularImpulse-_,n-=c*p,s+=h*p}{var f=u.sub(u.add(o,u.crossNumVec2(s,this.m_rB)),u.add(i,u.crossNumVec2(n,this.m_rA))),p=u.neg(sr.mulVec2(this.m_linearMass,f)),_=this.m_linearImpulse;this.m_linearImpulse.add(p);var d=m*this.m_maxForce;this.m_linearImpulse.lengthSquared()>d*d&&(this.m_linearImpulse.normalize(),this.m_linearImpulse.mul(d)),p=u.sub(this.m_linearImpulse,_),i.subMul(a,p),n-=c*u.crossVec2Vec2(this.m_rA,p),o.addMul(l,p),s+=h*u.crossVec2Vec2(this.m_rB,p)}this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=s},t.prototype.solvePositionConstraints=function(r){return!0},t.TYPE="friction-joint",t}(Qt),Zr=function(){function e(t,r,i){typeof t=="object"&&t!==null?(this.ex=tt.clone(t),this.ey=tt.clone(r),this.ez=tt.clone(i)):(this.ex=tt.zero(),this.ey=tt.zero(),this.ez=tt.zero())}return e.prototype.toString=function(){return JSON.stringify(this)},e.isValid=function(t){return t===null||typeof t>"u"?!1:tt.isValid(t.ex)&&tt.isValid(t.ey)&&tt.isValid(t.ez)},e.assert=function(t){},e.prototype.setZero=function(){return this.ex.setZero(),this.ey.setZero(),this.ez.setZero(),this},e.prototype.solve33=function(t){var r=this.ey.y*this.ez.z-this.ey.z*this.ez.y,i=this.ey.z*this.ez.x-this.ey.x*this.ez.z,n=this.ey.x*this.ez.y-this.ey.y*this.ez.x,o=this.ex.x*r+this.ex.y*i+this.ex.z*n;o!==0&&(o=1/o);var s=new tt;return r=this.ey.y*this.ez.z-this.ey.z*this.ez.y,i=this.ey.z*this.ez.x-this.ey.x*this.ez.z,n=this.ey.x*this.ez.y-this.ey.y*this.ez.x,s.x=o*(t.x*r+t.y*i+t.z*n),r=t.y*this.ez.z-t.z*this.ez.y,i=t.z*this.ez.x-t.x*this.ez.z,n=t.x*this.ez.y-t.y*this.ez.x,s.y=o*(this.ex.x*r+this.ex.y*i+this.ex.z*n),r=this.ey.y*t.z-this.ey.z*t.y,i=this.ey.z*t.x-this.ey.x*t.z,n=this.ey.x*t.y-this.ey.y*t.x,s.z=o*(this.ex.x*r+this.ex.y*i+this.ex.z*n),s},e.prototype.solve22=function(t){var r=this.ex.x,i=this.ey.x,n=this.ex.y,o=this.ey.y,s=r*o-i*n;s!==0&&(s=1/s);var a=u.zero();return a.x=s*(o*t.x-i*t.y),a.y=s*(r*t.y-n*t.x),a},e.prototype.getInverse22=function(t){var r=this.ex.x,i=this.ey.x,n=this.ex.y,o=this.ey.y,s=r*o-i*n;s!==0&&(s=1/s),t.ex.x=s*o,t.ey.x=-s*i,t.ex.z=0,t.ex.y=-s*n,t.ey.y=s*r,t.ey.z=0,t.ez.x=0,t.ez.y=0,t.ez.z=0},e.prototype.getSymInverse33=function(t){var r=tt.dot(this.ex,tt.cross(this.ey,this.ez));r!==0&&(r=1/r);var i=this.ex.x,n=this.ey.x,o=this.ez.x,s=this.ey.y,a=this.ez.y,l=this.ez.z;t.ex.x=r*(s*l-a*a),t.ex.y=r*(o*a-n*l),t.ex.z=r*(n*a-o*s),t.ey.x=t.ex.y,t.ey.y=r*(i*l-o*o),t.ey.z=r*(o*n-i*a),t.ez.x=t.ex.z,t.ez.y=t.ey.z,t.ez.z=r*(i*s-n*n)},e.mul=function(t,r){if(r&&"z"in r&&"y"in r&&"x"in r){var i=t.ex.x*r.x+t.ey.x*r.y+t.ez.x*r.z,n=t.ex.y*r.x+t.ey.y*r.y+t.ez.y*r.z,o=t.ex.z*r.x+t.ey.z*r.y+t.ez.z*r.z;return new tt(i,n,o)}else if(r&&"y"in r&&"x"in r){var i=t.ex.x*r.x+t.ey.x*r.y,n=t.ex.y*r.x+t.ey.y*r.y;return u.neo(i,n)}},e.mulVec3=function(t,r){var i=t.ex.x*r.x+t.ey.x*r.y+t.ez.x*r.z,n=t.ex.y*r.x+t.ey.y*r.y+t.ez.y*r.z,o=t.ex.z*r.x+t.ey.z*r.y+t.ez.z*r.z;return new tt(i,n,o)},e.mulVec2=function(t,r){var i=t.ex.x*r.x+t.ey.x*r.y,n=t.ex.y*r.x+t.ey.y*r.y;return u.neo(i,n)},e.add=function(t,r){return new e(tt.add(t.ex,r.ex),tt.add(t.ey,r.ey),tt.add(t.ez,r.ez))},e}(),Um=Math.abs,Lt;(function(e){e[e.inactiveLimit=0]="inactiveLimit",e[e.atLowerLimit=1]="atLowerLimit",e[e.atUpperLimit=2]="atUpperLimit",e[e.equalLimits=3]="equalLimits"})(Lt||(Lt={}));var fn={lowerAngle:0,upperAngle:0,maxMotorTorque:0,motorSpeed:0,enableLimit:!1,enableMotor:!1},Qr=function(e){Zt(t,e);function t(r,i,n,o){var s=this,a,l,c,h,m,f;return s instanceof t?(r=r??{},s=e.call(this,r,i,n)||this,i=s.m_bodyA,n=s.m_bodyB,s.m_mass=new Zr,s.m_limitState=Lt.inactiveLimit,s.m_type=t.TYPE,u.isValid(o)?s.m_localAnchorA=i.getLocalPoint(o):u.isValid(r.localAnchorA)?s.m_localAnchorA=u.clone(r.localAnchorA):s.m_localAnchorA=u.zero(),u.isValid(o)?s.m_localAnchorB=n.getLocalPoint(o):u.isValid(r.localAnchorB)?s.m_localAnchorB=u.clone(r.localAnchorB):s.m_localAnchorB=u.zero(),Number.isFinite(r.referenceAngle)?s.m_referenceAngle=r.referenceAngle:s.m_referenceAngle=n.getAngle()-i.getAngle(),s.m_impulse=new tt,s.m_motorImpulse=0,s.m_lowerAngle=(a=r.lowerAngle)!==null&&a!==void 0?a:fn.lowerAngle,s.m_upperAngle=(l=r.upperAngle)!==null&&l!==void 0?l:fn.upperAngle,s.m_maxMotorTorque=(c=r.maxMotorTorque)!==null&&c!==void 0?c:fn.maxMotorTorque,s.m_motorSpeed=(h=r.motorSpeed)!==null&&h!==void 0?h:fn.motorSpeed,s.m_enableLimit=(m=r.enableLimit)!==null&&m!==void 0?m:fn.enableLimit,s.m_enableMotor=(f=r.enableMotor)!==null&&f!==void 0?f:fn.enableMotor,s):new t(r,i,n,o)}return t.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,lowerAngle:this.m_lowerAngle,upperAngle:this.m_upperAngle,maxMotorTorque:this.m_maxMotorTorque,motorSpeed:this.m_motorSpeed,enableLimit:this.m_enableLimit,enableMotor:this.m_enableMotor,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,referenceAngle:this.m_referenceAngle}},t._deserialize=function(r,i,n){r=Kt({},r),r.bodyA=n(it,r.bodyA,i),r.bodyB=n(it,r.bodyB,i);var o=new t(r);return o},t.prototype._reset=function(r){r.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(r.anchorA)):r.localAnchorA&&this.m_localAnchorA.setVec2(r.localAnchorA),r.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(r.anchorB)):r.localAnchorB&&this.m_localAnchorB.setVec2(r.localAnchorB),Number.isFinite(r.referenceAngle)&&(this.m_referenceAngle=r.referenceAngle),r.enableLimit!==void 0&&(this.m_enableLimit=r.enableLimit),Number.isFinite(r.lowerAngle)&&(this.m_lowerAngle=r.lowerAngle),Number.isFinite(r.upperAngle)&&(this.m_upperAngle=r.upperAngle),Number.isFinite(r.maxMotorTorque)&&(this.m_maxMotorTorque=r.maxMotorTorque),Number.isFinite(r.motorSpeed)&&(this.m_motorSpeed=r.motorSpeed),r.enableMotor!==void 0&&(this.m_enableMotor=r.enableMotor)},t.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},t.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},t.prototype.getReferenceAngle=function(){return this.m_referenceAngle},t.prototype.getJointAngle=function(){var r=this.m_bodyA,i=this.m_bodyB;return i.m_sweep.a-r.m_sweep.a-this.m_referenceAngle},t.prototype.getJointSpeed=function(){var r=this.m_bodyA,i=this.m_bodyB;return i.m_angularVelocity-r.m_angularVelocity},t.prototype.isMotorEnabled=function(){return this.m_enableMotor},t.prototype.enableMotor=function(r){r!=this.m_enableMotor&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=r)},t.prototype.getMotorTorque=function(r){return r*this.m_motorImpulse},t.prototype.setMotorSpeed=function(r){r!=this.m_motorSpeed&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=r)},t.prototype.getMotorSpeed=function(){return this.m_motorSpeed},t.prototype.setMaxMotorTorque=function(r){r!=this.m_maxMotorTorque&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorTorque=r)},t.prototype.getMaxMotorTorque=function(){return this.m_maxMotorTorque},t.prototype.isLimitEnabled=function(){return this.m_enableLimit},t.prototype.enableLimit=function(r){r!=this.m_enableLimit&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableLimit=r,this.m_impulse.z=0)},t.prototype.getLowerLimit=function(){return this.m_lowerAngle},t.prototype.getUpperLimit=function(){return this.m_upperAngle},t.prototype.setLimits=function(r,i){(r!=this.m_lowerAngle||i!=this.m_upperAngle)&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_impulse.z=0,this.m_lowerAngle=r,this.m_upperAngle=i)},t.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},t.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},t.prototype.getReactionForce=function(r){return u.neo(this.m_impulse.x,this.m_impulse.y).mul(r)},t.prototype.getReactionTorque=function(r){return r*this.m_impulse.z},t.prototype.initVelocityConstraints=function(r){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var i=this.m_bodyA.c_position.a,n=this.m_bodyA.c_velocity.v,o=this.m_bodyA.c_velocity.w,s=this.m_bodyB.c_position.a,a=this.m_bodyB.c_velocity.v,l=this.m_bodyB.c_velocity.w,c=M.neo(i),h=M.neo(s);this.m_rA=M.mulVec2(c,u.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=M.mulVec2(h,u.sub(this.m_localAnchorB,this.m_localCenterB));var m=this.m_invMassA,f=this.m_invMassB,p=this.m_invIA,_=this.m_invIB,d=p+_===0;if(this.m_mass.ex.x=m+f+this.m_rA.y*this.m_rA.y*p+this.m_rB.y*this.m_rB.y*_,this.m_mass.ey.x=-this.m_rA.y*this.m_rA.x*p-this.m_rB.y*this.m_rB.x*_,this.m_mass.ez.x=-this.m_rA.y*p-this.m_rB.y*_,this.m_mass.ex.y=this.m_mass.ey.x,this.m_mass.ey.y=m+f+this.m_rA.x*this.m_rA.x*p+this.m_rB.x*this.m_rB.x*_,this.m_mass.ez.y=this.m_rA.x*p+this.m_rB.x*_,this.m_mass.ex.z=this.m_mass.ez.x,this.m_mass.ey.z=this.m_mass.ez.y,this.m_mass.ez.z=p+_,this.m_motorMass=p+_,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),(this.m_enableMotor==!1||d)&&(this.m_motorImpulse=0),this.m_enableLimit&&d==!1){var x=s-i-this.m_referenceAngle;Um(this.m_upperAngle-this.m_lowerAngle)<2*z.angularSlop?this.m_limitState=Lt.equalLimits:x<=this.m_lowerAngle?(this.m_limitState!=Lt.atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=Lt.atLowerLimit):x>=this.m_upperAngle?(this.m_limitState!=Lt.atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=Lt.atUpperLimit):(this.m_limitState=Lt.inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=Lt.inactiveLimit;if(r.warmStarting){this.m_impulse.mul(r.dtRatio),this.m_motorImpulse*=r.dtRatio;var v=u.neo(this.m_impulse.x,this.m_impulse.y);n.subMul(m,v),o-=p*(u.crossVec2Vec2(this.m_rA,v)+this.m_motorImpulse+this.m_impulse.z),a.addMul(f,v),l+=_*(u.crossVec2Vec2(this.m_rB,v)+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.setZero(),this.m_motorImpulse=0;this.m_bodyA.c_velocity.v=n,this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v=a,this.m_bodyB.c_velocity.w=l},t.prototype.solveVelocityConstraints=function(r){var i=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,a=this.m_invMassA,l=this.m_invMassB,c=this.m_invIA,h=this.m_invIB,m=c+h===0;if(this.m_enableMotor&&this.m_limitState!=Lt.equalLimits&&m==!1){var f=s-n-this.m_motorSpeed,p=-this.m_motorMass*f,_=this.m_motorImpulse,d=r.dt*this.m_maxMotorTorque;this.m_motorImpulse=qt(this.m_motorImpulse+p,-d,d),p=this.m_motorImpulse-_,n-=c*p,s+=h*p}if(this.m_enableLimit&&this.m_limitState!=Lt.inactiveLimit&&m==!1){var x=u.zero();x.addCombine(1,o,1,u.crossNumVec2(s,this.m_rB)),x.subCombine(1,i,1,u.crossNumVec2(n,this.m_rA));var v=s-n,f=new tt(x.x,x.y,v),p=tt.neg(this.m_mass.solve33(f));if(this.m_limitState==Lt.equalLimits)this.m_impulse.add(p);else if(this.m_limitState==Lt.atLowerLimit){var y=this.m_impulse.z+p.z;if(y<0){var g=u.combine(-1,x,this.m_impulse.z,u.neo(this.m_mass.ez.x,this.m_mass.ez.y)),A=this.m_mass.solve22(g);p.x=A.x,p.y=A.y,p.z=-this.m_impulse.z,this.m_impulse.x+=A.x,this.m_impulse.y+=A.y,this.m_impulse.z=0}else this.m_impulse.add(p)}else if(this.m_limitState==Lt.atUpperLimit){var y=this.m_impulse.z+p.z;if(y>0){var g=u.combine(-1,x,this.m_impulse.z,u.neo(this.m_mass.ez.x,this.m_mass.ez.y)),A=this.m_mass.solve22(g);p.x=A.x,p.y=A.y,p.z=-this.m_impulse.z,this.m_impulse.x+=A.x,this.m_impulse.y+=A.y,this.m_impulse.z=0}else this.m_impulse.add(p)}var w=u.neo(p.x,p.y);i.subMul(a,w),n-=c*(u.crossVec2Vec2(this.m_rA,w)+p.z),o.addMul(l,w),s+=h*(u.crossVec2Vec2(this.m_rB,w)+p.z)}else{var f=u.zero();f.addCombine(1,o,1,u.crossNumVec2(s,this.m_rB)),f.subCombine(1,i,1,u.crossNumVec2(n,this.m_rA));var p=this.m_mass.solve22(u.neg(f));this.m_impulse.x+=p.x,this.m_impulse.y+=p.y,i.subMul(a,p),n-=c*u.crossVec2Vec2(this.m_rA,p),o.addMul(l,p),s+=h*u.crossVec2Vec2(this.m_rB,p)}this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=s},t.prototype.solvePositionConstraints=function(r){var i=this.m_bodyA.c_position.c,n=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,s=this.m_bodyB.c_position.a,a=M.neo(n),l=M.neo(s),c=0,h=0,m=this.m_invIA+this.m_invIB==0;if(this.m_enableLimit&&this.m_limitState!=Lt.inactiveLimit&&m==!1){var f=s-n-this.m_referenceAngle,p=0;if(this.m_limitState==Lt.equalLimits){var _=qt(f-this.m_lowerAngle,-z.maxAngularCorrection,z.maxAngularCorrection);p=-this.m_motorMass*_,c=Um(_)}else if(this.m_limitState==Lt.atLowerLimit){var _=f-this.m_lowerAngle;c=-_,_=qt(_+z.angularSlop,-z.maxAngularCorrection,0),p=-this.m_motorMass*_}else if(this.m_limitState==Lt.atUpperLimit){var _=f-this.m_upperAngle;c=_,_=qt(_-z.angularSlop,0,z.maxAngularCorrection),p=-this.m_motorMass*_}n-=this.m_invIA*p,s+=this.m_invIB*p}{a.setAngle(n),l.setAngle(s);var d=M.mulVec2(a,u.sub(this.m_localAnchorA,this.m_localCenterA)),x=M.mulVec2(l,u.sub(this.m_localAnchorB,this.m_localCenterB)),_=u.zero();_.addCombine(1,o,1,x),_.subCombine(1,i,1,d),h=_.length();var v=this.m_invMassA,y=this.m_invMassB,g=this.m_invIA,A=this.m_invIB,w=new sr;w.ex.x=v+y+g*d.y*d.y+A*x.y*x.y,w.ex.y=-g*d.x*d.y-A*x.x*x.y,w.ey.x=w.ex.y,w.ey.y=v+y+g*d.x*d.x+A*x.x*x.x;var C=u.neg(w.solve(_));i.subMul(v,C),n-=g*u.crossVec2Vec2(d,C),o.addMul(y,C),s+=A*u.crossVec2Vec2(x,C)}return this.m_bodyA.c_position.c.setVec2(i),this.m_bodyA.c_position.a=n,this.m_bodyB.c_position.c.setVec2(o),this.m_bodyB.c_position.a=s,h<=z.linearSlop&&c<=z.angularSlop},t.TYPE="revolute-joint",t}(Qt),uo=Math.abs,$m=Math.max,Kg=Math.min,ue;(function(e){e[e.inactiveLimit=0]="inactiveLimit",e[e.atLowerLimit=1]="atLowerLimit",e[e.atUpperLimit=2]="atUpperLimit",e[e.equalLimits=3]="equalLimits"})(ue||(ue={}));var Zg={enableLimit:!1,lowerTranslation:0,upperTranslation:0,enableMotor:!1,maxMotorForce:0,motorSpeed:0},jm=function(e){Zt(t,e);function t(r,i,n,o,s){var a=this;return a instanceof t?(r=Me(r,Zg),a=e.call(this,r,i,n)||this,i=a.m_bodyA,n=a.m_bodyB,a.m_type=t.TYPE,a.m_localAnchorA=u.clone(o?i.getLocalPoint(o):r.localAnchorA||u.zero()),a.m_localAnchorB=u.clone(o?n.getLocalPoint(o):r.localAnchorB||u.zero()),a.m_localXAxisA=u.clone(s?i.getLocalVector(s):r.localAxisA||u.neo(1,0)),a.m_localXAxisA.normalize(),a.m_localYAxisA=u.crossNumVec2(1,a.m_localXAxisA),a.m_referenceAngle=Number.isFinite(r.referenceAngle)?r.referenceAngle:n.getAngle()-i.getAngle(),a.m_impulse=new tt,a.m_motorMass=0,a.m_motorImpulse=0,a.m_lowerTranslation=r.lowerTranslation,a.m_upperTranslation=r.upperTranslation,a.m_maxMotorForce=r.maxMotorForce,a.m_motorSpeed=r.motorSpeed,a.m_enableLimit=r.enableLimit,a.m_enableMotor=r.enableMotor,a.m_limitState=ue.inactiveLimit,a.m_axis=u.zero(),a.m_perp=u.zero(),a.m_K=new Zr,a):new t(r,i,n,o,s)}return t.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,lowerTranslation:this.m_lowerTranslation,upperTranslation:this.m_upperTranslation,maxMotorForce:this.m_maxMotorForce,motorSpeed:this.m_motorSpeed,enableLimit:this.m_enableLimit,enableMotor:this.m_enableMotor,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,localAxisA:this.m_localXAxisA,referenceAngle:this.m_referenceAngle}},t._deserialize=function(r,i,n){r=Kt({},r),r.bodyA=n(it,r.bodyA,i),r.bodyB=n(it,r.bodyB,i),r.localAxisA=u.clone(r.localAxisA);var o=new t(r);return o},t.prototype._reset=function(r){r.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(r.anchorA)):r.localAnchorA&&this.m_localAnchorA.setVec2(r.localAnchorA),r.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(r.anchorB)):r.localAnchorB&&this.m_localAnchorB.setVec2(r.localAnchorB),r.localAxisA&&(this.m_localXAxisA.setVec2(r.localAxisA),this.m_localYAxisA.setVec2(u.crossNumVec2(1,r.localAxisA))),Number.isFinite(r.referenceAngle)&&(this.m_referenceAngle=r.referenceAngle),typeof r.enableLimit<"u"&&(this.m_enableLimit=!!r.enableLimit),Number.isFinite(r.lowerTranslation)&&(this.m_lowerTranslation=r.lowerTranslation),Number.isFinite(r.upperTranslation)&&(this.m_upperTranslation=r.upperTranslation),typeof r.enableMotor<"u"&&(this.m_enableMotor=!!r.enableMotor),Number.isFinite(r.maxMotorForce)&&(this.m_maxMotorForce=r.maxMotorForce),Number.isFinite(r.motorSpeed)&&(this.m_motorSpeed=r.motorSpeed)},t.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},t.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},t.prototype.getLocalAxisA=function(){return this.m_localXAxisA},t.prototype.getReferenceAngle=function(){return this.m_referenceAngle},t.prototype.getJointTranslation=function(){var r=this.m_bodyA.getWorldPoint(this.m_localAnchorA),i=this.m_bodyB.getWorldPoint(this.m_localAnchorB),n=u.sub(i,r),o=this.m_bodyA.getWorldVector(this.m_localXAxisA),s=u.dot(n,o);return s},t.prototype.getJointSpeed=function(){var r=this.m_bodyA,i=this.m_bodyB,n=M.mulVec2(r.m_xf.q,u.sub(this.m_localAnchorA,r.m_sweep.localCenter)),o=M.mulVec2(i.m_xf.q,u.sub(this.m_localAnchorB,i.m_sweep.localCenter)),s=u.add(r.m_sweep.c,n),a=u.add(i.m_sweep.c,o),l=u.sub(a,s),c=M.mulVec2(r.m_xf.q,this.m_localXAxisA),h=r.m_linearVelocity,m=i.m_linearVelocity,f=r.m_angularVelocity,p=i.m_angularVelocity,_=u.dot(l,u.crossNumVec2(f,c))+u.dot(c,u.sub(u.addCrossNumVec2(m,p,o),u.addCrossNumVec2(h,f,n)));return _},t.prototype.isLimitEnabled=function(){return this.m_enableLimit},t.prototype.enableLimit=function(r){r!=this.m_enableLimit&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableLimit=r,this.m_impulse.z=0)},t.prototype.getLowerLimit=function(){return this.m_lowerTranslation},t.prototype.getUpperLimit=function(){return this.m_upperTranslation},t.prototype.setLimits=function(r,i){(r!=this.m_lowerTranslation||i!=this.m_upperTranslation)&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_lowerTranslation=r,this.m_upperTranslation=i,this.m_impulse.z=0)},t.prototype.isMotorEnabled=function(){return this.m_enableMotor},t.prototype.enableMotor=function(r){r!=this.m_enableMotor&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=r)},t.prototype.setMotorSpeed=function(r){r!=this.m_motorSpeed&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=r)},t.prototype.setMaxMotorForce=function(r){r!=this.m_maxMotorForce&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorForce=r)},t.prototype.getMaxMotorForce=function(){return this.m_maxMotorForce},t.prototype.getMotorSpeed=function(){return this.m_motorSpeed},t.prototype.getMotorForce=function(r){return r*this.m_motorImpulse},t.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},t.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},t.prototype.getReactionForce=function(r){return u.combine(this.m_impulse.x,this.m_perp,this.m_motorImpulse+this.m_impulse.z,this.m_axis).mul(r)},t.prototype.getReactionTorque=function(r){return r*this.m_impulse.y},t.prototype.initVelocityConstraints=function(r){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var i=this.m_bodyA.c_position.c,n=this.m_bodyA.c_position.a,o=this.m_bodyA.c_velocity.v,s=this.m_bodyA.c_velocity.w,a=this.m_bodyB.c_position.c,l=this.m_bodyB.c_position.a,c=this.m_bodyB.c_velocity.v,h=this.m_bodyB.c_velocity.w,m=M.neo(n),f=M.neo(l),p=M.mulVec2(m,u.sub(this.m_localAnchorA,this.m_localCenterA)),_=M.mulVec2(f,u.sub(this.m_localAnchorB,this.m_localCenterB)),d=u.zero();d.addCombine(1,a,1,_),d.subCombine(1,i,1,p);var x=this.m_invMassA,v=this.m_invMassB,y=this.m_invIA,g=this.m_invIB;this.m_axis=M.mulVec2(m,this.m_localXAxisA),this.m_a1=u.crossVec2Vec2(u.add(d,p),this.m_axis),this.m_a2=u.crossVec2Vec2(_,this.m_axis),this.m_motorMass=x+v+y*this.m_a1*this.m_a1+g*this.m_a2*this.m_a2,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass);{this.m_perp=M.mulVec2(m,this.m_localYAxisA),this.m_s1=u.crossVec2Vec2(u.add(d,p),this.m_perp),this.m_s2=u.crossVec2Vec2(_,this.m_perp),u.crossVec2Vec2(p,this.m_perp);var A=x+v+y*this.m_s1*this.m_s1+g*this.m_s2*this.m_s2,w=y*this.m_s1+g*this.m_s2,C=y*this.m_s1*this.m_a1+g*this.m_s2*this.m_a2,S=y+g;S==0&&(S=1);var P=y*this.m_a1+g*this.m_a2,F=x+v+y*this.m_a1*this.m_a1+g*this.m_a2*this.m_a2;this.m_K.ex.set(A,w,C),this.m_K.ey.set(w,S,P),this.m_K.ez.set(C,P,F)}if(this.m_enableLimit){var I=u.dot(this.m_axis,d);uo(this.m_upperTranslation-this.m_lowerTranslation)<2*z.linearSlop?this.m_limitState=ue.equalLimits:I<=this.m_lowerTranslation?this.m_limitState!=ue.atLowerLimit&&(this.m_limitState=ue.atLowerLimit,this.m_impulse.z=0):I>=this.m_upperTranslation?this.m_limitState!=ue.atUpperLimit&&(this.m_limitState=ue.atUpperLimit,this.m_impulse.z=0):(this.m_limitState=ue.inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=ue.inactiveLimit,this.m_impulse.z=0;if(this.m_enableMotor==!1&&(this.m_motorImpulse=0),r.warmStarting){this.m_impulse.mul(r.dtRatio),this.m_motorImpulse*=r.dtRatio;var O=u.combine(this.m_impulse.x,this.m_perp,this.m_motorImpulse+this.m_impulse.z,this.m_axis),X=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,Q=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;o.subMul(x,O),s-=y*X,c.addMul(v,O),h+=g*Q}else this.m_impulse.setZero(),this.m_motorImpulse=0;this.m_bodyA.c_velocity.v.setVec2(o),this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v.setVec2(c),this.m_bodyB.c_velocity.w=h},t.prototype.solveVelocityConstraints=function(r){var i=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,a=this.m_invMassA,l=this.m_invMassB,c=this.m_invIA,h=this.m_invIB;if(this.m_enableMotor&&this.m_limitState!=ue.equalLimits){var m=u.dot(this.m_axis,u.sub(o,i))+this.m_a2*s-this.m_a1*n,f=this.m_motorMass*(this.m_motorSpeed-m),p=this.m_motorImpulse,_=r.dt*this.m_maxMotorForce;this.m_motorImpulse=qt(this.m_motorImpulse+f,-_,_),f=this.m_motorImpulse-p;var d=u.mulNumVec2(f,this.m_axis),x=f*this.m_a1,v=f*this.m_a2;i.subMul(a,d),n-=c*x,o.addMul(l,d),s+=h*v}var y=u.zero();if(y.x+=u.dot(this.m_perp,o)+this.m_s2*s,y.x-=u.dot(this.m_perp,i)+this.m_s1*n,y.y=s-n,this.m_enableLimit&&this.m_limitState!=ue.inactiveLimit){var g=0;g+=u.dot(this.m_axis,o)+this.m_a2*s,g-=u.dot(this.m_axis,i)+this.m_a1*n;var m=new tt(y.x,y.y,g),A=tt.clone(this.m_impulse),w=this.m_K.solve33(tt.neg(m));this.m_impulse.add(w),this.m_limitState==ue.atLowerLimit?this.m_impulse.z=$m(this.m_impulse.z,0):this.m_limitState==ue.atUpperLimit&&(this.m_impulse.z=Kg(this.m_impulse.z,0));var C=u.combine(-1,y,-(this.m_impulse.z-A.z),u.neo(this.m_K.ez.x,this.m_K.ez.y)),S=u.add(this.m_K.solve22(C),u.neo(A.x,A.y));this.m_impulse.x=S.x,this.m_impulse.y=S.y,w=tt.sub(this.m_impulse,A);var d=u.combine(w.x,this.m_perp,w.z,this.m_axis),x=w.x*this.m_s1+w.y+w.z*this.m_a1,v=w.x*this.m_s2+w.y+w.z*this.m_a2;i.subMul(a,d),n-=c*x,o.addMul(l,d),s+=h*v}else{var w=this.m_K.solve22(u.neg(y));this.m_impulse.x+=w.x,this.m_impulse.y+=w.y;var d=u.mulNumVec2(w.x,this.m_perp),x=w.x*this.m_s1+w.y,v=w.x*this.m_s2+w.y;i.subMul(a,d),n-=c*x,o.addMul(l,d),s+=h*v}this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=s},t.prototype.solvePositionConstraints=function(r){var i=this.m_bodyA.c_position.c,n=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,s=this.m_bodyB.c_position.a,a=M.neo(n),l=M.neo(s),c=this.m_invMassA,h=this.m_invMassB,m=this.m_invIA,f=this.m_invIB,p=M.mulVec2(a,u.sub(this.m_localAnchorA,this.m_localCenterA)),_=M.mulVec2(l,u.sub(this.m_localAnchorB,this.m_localCenterB)),d=u.sub(u.add(o,_),u.add(i,p)),x=M.mulVec2(a,this.m_localXAxisA),v=u.crossVec2Vec2(u.add(d,p),x),y=u.crossVec2Vec2(_,x),g=M.mulVec2(a,this.m_localYAxisA),A=u.crossVec2Vec2(u.add(d,p),g),w=u.crossVec2Vec2(_,g),C=new tt,S=u.zero();S.x=u.dot(g,d),S.y=s-n-this.m_referenceAngle;var P=uo(S.x),F=uo(S.y),I=z.linearSlop,O=z.maxLinearCorrection,X=!1,Q=0;if(this.m_enableLimit){var K=u.dot(x,d);uo(this.m_upperTranslation-this.m_lowerTranslation)<2*I?(Q=qt(K,-O,O),P=$m(P,uo(K)),X=!0):K<=this.m_lowerTranslation?(Q=qt(K-this.m_lowerTranslation+I,-O,0),P=Math.max(P,this.m_lowerTranslation-K),X=!0):K>=this.m_upperTranslation&&(Q=qt(K-this.m_upperTranslation-I,0,O),P=Math.max(P,K-this.m_upperTranslation),X=!0)}if(X){var Nt=c+h+m*A*A+f*w*w,ht=m*A+f*w,At=m*A*v+f*w*y,k=m+f;k==0&&(k=1);var N=m*v+f*y,W=c+h+m*v*v+f*y*y,et=new Zr;et.ex.set(Nt,ht,At),et.ey.set(ht,k,N),et.ez.set(At,N,W);var lt=new tt;lt.x=S.x,lt.y=S.y,lt.z=Q,C=et.solve33(tt.neg(lt))}else{var Nt=c+h+m*A*A+f*w*w,ht=m*A+f*w,k=m+f;k==0&&(k=1);var et=new sr;et.ex.setNum(Nt,ht),et.ey.setNum(ht,k);var Ve=et.solve(u.neg(S));C.x=Ve.x,C.y=Ve.y,C.z=0}var _e=u.combine(C.x,g,C.z,x),lr=C.x*A+C.y+C.z*v,We=C.x*w+C.y+C.z*y;return i.subMul(c,_e),n-=m*lr,o.addMul(h,_e),s+=f*We,this.m_bodyA.c_position.c=i,this.m_bodyA.c_position.a=n,this.m_bodyB.c_position.c=o,this.m_bodyB.c_position.a=s,P<=z.linearSlop&&F<=z.angularSlop},t.TYPE="prismatic-joint",t}(Qt),t0={ratio:1},Wm=function(e){Zt(t,e);function t(r,i,n,o,s,a){var l=this;if(!(l instanceof t))return new t(r,i,n,o,s,a);r=Me(r,t0),l=e.call(this,r,i,n)||this,i=l.m_bodyA,n=l.m_bodyB,l.m_type=t.TYPE,l.m_joint1=o||r.joint1,l.m_joint2=s||r.joint2,l.m_ratio=Number.isFinite(a)?a:r.ratio,l.m_type1=l.m_joint1.getType(),l.m_type2=l.m_joint2.getType();var c,h;l.m_bodyC=l.m_joint1.getBodyA(),l.m_bodyA=l.m_joint1.getBodyB();var m=l.m_bodyA.m_xf,f=l.m_bodyA.m_sweep.a,p=l.m_bodyC.m_xf,_=l.m_bodyC.m_sweep.a;if(l.m_type1===Qr.TYPE){var d=l.m_joint1;l.m_localAnchorC=d.m_localAnchorA,l.m_localAnchorA=d.m_localAnchorB,l.m_referenceAngleA=d.m_referenceAngle,l.m_localAxisC=u.zero(),c=f-_-l.m_referenceAngleA}else{var x=l.m_joint1;l.m_localAnchorC=x.m_localAnchorA,l.m_localAnchorA=x.m_localAnchorB,l.m_referenceAngleA=x.m_referenceAngle,l.m_localAxisC=x.m_localXAxisA;var v=l.m_localAnchorC,y=M.mulTVec2(p.q,u.add(M.mulVec2(m.q,l.m_localAnchorA),u.sub(m.p,p.p)));c=u.dot(y,l.m_localAxisC)-u.dot(v,l.m_localAxisC)}l.m_bodyD=l.m_joint2.getBodyA(),l.m_bodyB=l.m_joint2.getBodyB();var g=l.m_bodyB.m_xf,A=l.m_bodyB.m_sweep.a,w=l.m_bodyD.m_xf,C=l.m_bodyD.m_sweep.a;if(l.m_type2===Qr.TYPE){var d=l.m_joint2;l.m_localAnchorD=d.m_localAnchorA,l.m_localAnchorB=d.m_localAnchorB,l.m_referenceAngleB=d.m_referenceAngle,l.m_localAxisD=u.zero(),h=A-C-l.m_referenceAngleB}else{var x=l.m_joint2;l.m_localAnchorD=x.m_localAnchorA,l.m_localAnchorB=x.m_localAnchorB,l.m_referenceAngleB=x.m_referenceAngle,l.m_localAxisD=x.m_localXAxisA;var S=l.m_localAnchorD,P=M.mulTVec2(w.q,u.add(M.mulVec2(g.q,l.m_localAnchorB),u.sub(g.p,w.p)));h=u.dot(P,l.m_localAxisD)-u.dot(S,l.m_localAxisD)}return l.m_constant=c+l.m_ratio*h,l.m_impulse=0,l}return t.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,joint1:this.m_joint1,joint2:this.m_joint2,ratio:this.m_ratio}},t._deserialize=function(r,i,n){r=Kt({},r),r.bodyA=n(it,r.bodyA,i),r.bodyB=n(it,r.bodyB,i),r.joint1=n(Qt,r.joint1,i),r.joint2=n(Qt,r.joint2,i);var o=new t(r);return o},t.prototype._reset=function(r){Number.isFinite(r.ratio)&&(this.m_ratio=r.ratio)},t.prototype.getJoint1=function(){return this.m_joint1},t.prototype.getJoint2=function(){return this.m_joint2},t.prototype.setRatio=function(r){this.m_ratio=r},t.prototype.getRatio=function(){return this.m_ratio},t.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},t.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},t.prototype.getReactionForce=function(r){return u.mulNumVec2(this.m_impulse,this.m_JvAC).mul(r)},t.prototype.getReactionTorque=function(r){var i=this.m_impulse*this.m_JwA;return r*i},t.prototype.initVelocityConstraints=function(r){this.m_lcA=this.m_bodyA.m_sweep.localCenter,this.m_lcB=this.m_bodyB.m_sweep.localCenter,this.m_lcC=this.m_bodyC.m_sweep.localCenter,this.m_lcD=this.m_bodyD.m_sweep.localCenter,this.m_mA=this.m_bodyA.m_invMass,this.m_mB=this.m_bodyB.m_invMass,this.m_mC=this.m_bodyC.m_invMass,this.m_mD=this.m_bodyD.m_invMass,this.m_iA=this.m_bodyA.m_invI,this.m_iB=this.m_bodyB.m_invI,this.m_iC=this.m_bodyC.m_invI,this.m_iD=this.m_bodyD.m_invI;var i=this.m_bodyA.c_position.a,n=this.m_bodyA.c_velocity.v,o=this.m_bodyA.c_velocity.w,s=this.m_bodyB.c_position.a,a=this.m_bodyB.c_velocity.v,l=this.m_bodyB.c_velocity.w,c=this.m_bodyC.c_position.a,h=this.m_bodyC.c_velocity.v,m=this.m_bodyC.c_velocity.w,f=this.m_bodyD.c_position.a,p=this.m_bodyD.c_velocity.v,_=this.m_bodyD.c_velocity.w,d=M.neo(i),x=M.neo(s),v=M.neo(c),y=M.neo(f);if(this.m_mass=0,this.m_type1==Qr.TYPE)this.m_JvAC=u.zero(),this.m_JwA=1,this.m_JwC=1,this.m_mass+=this.m_iA+this.m_iC;else{var g=M.mulVec2(v,this.m_localAxisC),A=M.mulSub(v,this.m_localAnchorC,this.m_lcC),w=M.mulSub(d,this.m_localAnchorA,this.m_lcA);this.m_JvAC=g,this.m_JwC=u.crossVec2Vec2(A,g),this.m_JwA=u.crossVec2Vec2(w,g),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA}if(this.m_type2==Qr.TYPE)this.m_JvBD=u.zero(),this.m_JwB=this.m_ratio,this.m_JwD=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD);else{var g=M.mulVec2(y,this.m_localAxisD),C=M.mulSub(y,this.m_localAnchorD,this.m_lcD),S=M.mulSub(x,this.m_localAnchorB,this.m_lcB);this.m_JvBD=u.mulNumVec2(this.m_ratio,g),this.m_JwD=this.m_ratio*u.crossVec2Vec2(C,g),this.m_JwB=this.m_ratio*u.crossVec2Vec2(S,g),this.m_mass+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*this.m_JwD*this.m_JwD+this.m_iB*this.m_JwB*this.m_JwB}this.m_mass=this.m_mass>0?1/this.m_mass:0,r.warmStarting?(n.addMul(this.m_mA*this.m_impulse,this.m_JvAC),o+=this.m_iA*this.m_impulse*this.m_JwA,a.addMul(this.m_mB*this.m_impulse,this.m_JvBD),l+=this.m_iB*this.m_impulse*this.m_JwB,h.subMul(this.m_mC*this.m_impulse,this.m_JvAC),m-=this.m_iC*this.m_impulse*this.m_JwC,p.subMul(this.m_mD*this.m_impulse,this.m_JvBD),_-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0,this.m_bodyA.c_velocity.v.setVec2(n),this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v.setVec2(a),this.m_bodyB.c_velocity.w=l,this.m_bodyC.c_velocity.v.setVec2(h),this.m_bodyC.c_velocity.w=m,this.m_bodyD.c_velocity.v.setVec2(p),this.m_bodyD.c_velocity.w=_},t.prototype.solveVelocityConstraints=function(r){var i=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,a=this.m_bodyC.c_velocity.v,l=this.m_bodyC.c_velocity.w,c=this.m_bodyD.c_velocity.v,h=this.m_bodyD.c_velocity.w,m=u.dot(this.m_JvAC,i)-u.dot(this.m_JvAC,a)+u.dot(this.m_JvBD,o)-u.dot(this.m_JvBD,c);m+=this.m_JwA*n-this.m_JwC*l+(this.m_JwB*s-this.m_JwD*h);var f=-this.m_mass*m;this.m_impulse+=f,i.addMul(this.m_mA*f,this.m_JvAC),n+=this.m_iA*f*this.m_JwA,o.addMul(this.m_mB*f,this.m_JvBD),s+=this.m_iB*f*this.m_JwB,a.subMul(this.m_mC*f,this.m_JvAC),l-=this.m_iC*f*this.m_JwC,c.subMul(this.m_mD*f,this.m_JvBD),h-=this.m_iD*f*this.m_JwD,this.m_bodyA.c_velocity.v.setVec2(i),this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v.setVec2(o),this.m_bodyB.c_velocity.w=s,this.m_bodyC.c_velocity.v.setVec2(a),this.m_bodyC.c_velocity.w=l,this.m_bodyD.c_velocity.v.setVec2(c),this.m_bodyD.c_velocity.w=h},t.prototype.solvePositionConstraints=function(r){var i=this.m_bodyA.c_position.c,n=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,s=this.m_bodyB.c_position.a,a=this.m_bodyC.c_position.c,l=this.m_bodyC.c_position.a,c=this.m_bodyD.c_position.c,h=this.m_bodyD.c_position.a,m=M.neo(n),f=M.neo(s),p=M.neo(l),_=M.neo(h),d=0,x,v,y,g,A,w,C,S,P=0;if(this.m_type1==Qr.TYPE)y=u.zero(),A=1,C=1,P+=this.m_iA+this.m_iC,x=n-l-this.m_referenceAngleA;else{var F=M.mulVec2(p,this.m_localAxisC),I=M.mulSub(p,this.m_localAnchorC,this.m_lcC),O=M.mulSub(m,this.m_localAnchorA,this.m_lcA);y=F,C=u.crossVec2Vec2(I,F),A=u.crossVec2Vec2(O,F),P+=this.m_mC+this.m_mA+this.m_iC*C*C+this.m_iA*A*A;var X=u.sub(this.m_localAnchorC,this.m_lcC),Q=M.mulTVec2(p,u.add(O,u.sub(i,a)));x=u.dot(u.sub(Q,X),this.m_localAxisC)}if(this.m_type2==Qr.TYPE)g=u.zero(),w=this.m_ratio,S=this.m_ratio,P+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),v=s-h-this.m_referenceAngleB;else{var F=M.mulVec2(_,this.m_localAxisD),K=M.mulSub(_,this.m_localAnchorD,this.m_lcD),Nt=M.mulSub(f,this.m_localAnchorB,this.m_lcB);g=u.mulNumVec2(this.m_ratio,F),S=this.m_ratio*u.crossVec2Vec2(K,F),w=this.m_ratio*u.crossVec2Vec2(Nt,F),P+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*S*S+this.m_iB*w*w;var ht=u.sub(this.m_localAnchorD,this.m_lcD),At=M.mulTVec2(_,u.add(Nt,u.sub(o,c)));v=u.dot(At,this.m_localAxisD)-u.dot(ht,this.m_localAxisD)}var k=x+this.m_ratio*v-this.m_constant,N=0;return P>0&&(N=-k/P),i.addMul(this.m_mA*N,y),n+=this.m_iA*N*A,o.addMul(this.m_mB*N,g),s+=this.m_iB*N*w,a.subMul(this.m_mC*N,y),l-=this.m_iC*N*C,c.subMul(this.m_mD*N,g),h-=this.m_iD*N*S,this.m_bodyA.c_position.c.setVec2(i),this.m_bodyA.c_position.a=n,this.m_bodyB.c_position.c.setVec2(o),this.m_bodyB.c_position.a=s,this.m_bodyC.c_position.c.setVec2(a),this.m_bodyC.c_position.a=l,this.m_bodyD.c_position.c.setVec2(c),this.m_bodyD.c_position.a=h,d<z.linearSlop},t.TYPE="gear-joint",t}(Qt),e0={maxForce:1,maxTorque:1,correctionFactor:.3},Hm=function(e){Zt(t,e);function t(r,i,n){var o=this;return o instanceof t?(r=Me(r,e0),o=e.call(this,r,i,n)||this,i=o.m_bodyA,n=o.m_bodyB,o.m_type=t.TYPE,o.m_linearOffset=u.isValid(r.linearOffset)?u.clone(r.linearOffset):i.getLocalPoint(n.getPosition()),o.m_angularOffset=Number.isFinite(r.angularOffset)?r.angularOffset:n.getAngle()-i.getAngle(),o.m_linearImpulse=u.zero(),o.m_angularImpulse=0,o.m_maxForce=r.maxForce,o.m_maxTorque=r.maxTorque,o.m_correctionFactor=r.correctionFactor,o):new t(r,i,n)}return t.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,maxForce:this.m_maxForce,maxTorque:this.m_maxTorque,correctionFactor:this.m_correctionFactor,linearOffset:this.m_linearOffset,angularOffset:this.m_angularOffset}},t._deserialize=function(r,i,n){r=Kt({},r),r.bodyA=n(it,r.bodyA,i),r.bodyB=n(it,r.bodyB,i);var o=new t(r);return o},t.prototype._reset=function(r){Number.isFinite(r.angularOffset)&&(this.m_angularOffset=r.angularOffset),Number.isFinite(r.maxForce)&&(this.m_maxForce=r.maxForce),Number.isFinite(r.maxTorque)&&(this.m_maxTorque=r.maxTorque),Number.isFinite(r.correctionFactor)&&(this.m_correctionFactor=r.correctionFactor),u.isValid(r.linearOffset)&&this.m_linearOffset.set(r.linearOffset)},t.prototype.setMaxForce=function(r){this.m_maxForce=r},t.prototype.getMaxForce=function(){return this.m_maxForce},t.prototype.setMaxTorque=function(r){this.m_maxTorque=r},t.prototype.getMaxTorque=function(){return this.m_maxTorque},t.prototype.setCorrectionFactor=function(r){this.m_correctionFactor=r},t.prototype.getCorrectionFactor=function(){return this.m_correctionFactor},t.prototype.setLinearOffset=function(r){(r.x!=this.m_linearOffset.x||r.y!=this.m_linearOffset.y)&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_linearOffset.set(r))},t.prototype.getLinearOffset=function(){return this.m_linearOffset},t.prototype.setAngularOffset=function(r){r!=this.m_angularOffset&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_angularOffset=r)},t.prototype.getAngularOffset=function(){return this.m_angularOffset},t.prototype.getAnchorA=function(){return this.m_bodyA.getPosition()},t.prototype.getAnchorB=function(){return this.m_bodyB.getPosition()},t.prototype.getReactionForce=function(r){return u.mulNumVec2(r,this.m_linearImpulse)},t.prototype.getReactionTorque=function(r){return r*this.m_angularImpulse},t.prototype.initVelocityConstraints=function(r){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var i=this.m_bodyA.c_position.c,n=this.m_bodyA.c_position.a,o=this.m_bodyA.c_velocity.v,s=this.m_bodyA.c_velocity.w,a=this.m_bodyB.c_position.c,l=this.m_bodyB.c_position.a,c=this.m_bodyB.c_velocity.v,h=this.m_bodyB.c_velocity.w,m=M.neo(n),f=M.neo(l);this.m_rA=M.mulVec2(m,u.sub(this.m_linearOffset,this.m_localCenterA)),this.m_rB=M.mulVec2(f,u.neg(this.m_localCenterB));var p=this.m_invMassA,_=this.m_invMassB,d=this.m_invIA,x=this.m_invIB,v=new sr;if(v.ex.x=p+_+d*this.m_rA.y*this.m_rA.y+x*this.m_rB.y*this.m_rB.y,v.ex.y=-d*this.m_rA.x*this.m_rA.y-x*this.m_rB.x*this.m_rB.y,v.ey.x=v.ex.y,v.ey.y=p+_+d*this.m_rA.x*this.m_rA.x+x*this.m_rB.x*this.m_rB.x,this.m_linearMass=v.getInverse(),this.m_angularMass=d+x,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),this.m_linearError=u.zero(),this.m_linearError.addCombine(1,a,1,this.m_rB),this.m_linearError.subCombine(1,i,1,this.m_rA),this.m_angularError=l-n-this.m_angularOffset,r.warmStarting){this.m_linearImpulse.mul(r.dtRatio),this.m_angularImpulse*=r.dtRatio;var y=u.neo(this.m_linearImpulse.x,this.m_linearImpulse.y);o.subMul(p,y),s-=d*(u.crossVec2Vec2(this.m_rA,y)+this.m_angularImpulse),c.addMul(_,y),h+=x*(u.crossVec2Vec2(this.m_rB,y)+this.m_angularImpulse)}else this.m_linearImpulse.setZero(),this.m_angularImpulse=0;this.m_bodyA.c_velocity.v=o,this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v=c,this.m_bodyB.c_velocity.w=h},t.prototype.solveVelocityConstraints=function(r){var i=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,a=this.m_invMassA,l=this.m_invMassB,c=this.m_invIA,h=this.m_invIB,m=r.dt,f=r.inv_dt;{var p=s-n+f*this.m_correctionFactor*this.m_angularError,_=-this.m_angularMass*p,d=this.m_angularImpulse,x=m*this.m_maxTorque;this.m_angularImpulse=qt(this.m_angularImpulse+_,-x,x),_=this.m_angularImpulse-d,n-=c*_,s+=h*_}{var p=u.zero();p.addCombine(1,o,1,u.crossNumVec2(s,this.m_rB)),p.subCombine(1,i,1,u.crossNumVec2(n,this.m_rA)),p.addMul(f*this.m_correctionFactor,this.m_linearError);var _=u.neg(sr.mulVec2(this.m_linearMass,p)),d=u.clone(this.m_linearImpulse);this.m_linearImpulse.add(_);var x=m*this.m_maxForce;this.m_linearImpulse.clamp(x),_=u.sub(this.m_linearImpulse,d),i.subMul(a,_),n-=c*u.crossVec2Vec2(this.m_rA,_),o.addMul(l,_),s+=h*u.crossVec2Vec2(this.m_rB,_)}this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=s},t.prototype.solvePositionConstraints=function(r){return!0},t.TYPE="motor-joint",t}(Qt),r0=Math.PI,i0={maxForce:0,frequencyHz:5,dampingRatio:.7},Ym=function(e){Zt(t,e);function t(r,i,n,o){var s=this;return s instanceof t?(r=Me(r,i0),s=e.call(this,r,i,n)||this,i=s.m_bodyA,n=s.m_bodyB,s.m_type=t.TYPE,u.isValid(o)?s.m_targetA=u.clone(o):u.isValid(r.target)?s.m_targetA=u.clone(r.target):s.m_targetA=u.zero(),s.m_localAnchorB=or.mulTVec2(n.getTransform(),s.m_targetA),s.m_maxForce=r.maxForce,s.m_impulse=u.zero(),s.m_frequencyHz=r.frequencyHz,s.m_dampingRatio=r.dampingRatio,s.m_beta=0,s.m_gamma=0,s.m_rB=u.zero(),s.m_localCenterB=u.zero(),s.m_invMassB=0,s.m_invIB=0,s.m_mass=new sr,s.m_C=u.zero(),s):new t(r,i,n,o)}return t.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,target:this.m_targetA,maxForce:this.m_maxForce,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,_localAnchorB:this.m_localAnchorB}},t._deserialize=function(r,i,n){r=Kt({},r),r.bodyA=n(it,r.bodyA,i),r.bodyB=n(it,r.bodyB,i),r.target=u.clone(r.target);var o=new t(r);return r._localAnchorB&&(o.m_localAnchorB=r._localAnchorB),o},t.prototype._reset=function(r){Number.isFinite(r.maxForce)&&(this.m_maxForce=r.maxForce),Number.isFinite(r.frequencyHz)&&(this.m_frequencyHz=r.frequencyHz),Number.isFinite(r.dampingRatio)&&(this.m_dampingRatio=r.dampingRatio)},t.prototype.setTarget=function(r){u.areEqual(r,this.m_targetA)||(this.m_bodyB.setAwake(!0),this.m_targetA.set(r))},t.prototype.getTarget=function(){return this.m_targetA},t.prototype.setMaxForce=function(r){this.m_maxForce=r},t.prototype.getMaxForce=function(){return this.m_maxForce},t.prototype.setFrequency=function(r){this.m_frequencyHz=r},t.prototype.getFrequency=function(){return this.m_frequencyHz},t.prototype.setDampingRatio=function(r){this.m_dampingRatio=r},t.prototype.getDampingRatio=function(){return this.m_dampingRatio},t.prototype.getAnchorA=function(){return u.clone(this.m_targetA)},t.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},t.prototype.getReactionForce=function(r){return u.mulNumVec2(r,this.m_impulse)},t.prototype.getReactionTorque=function(r){return r*0},t.prototype.shiftOrigin=function(r){this.m_targetA.sub(r)},t.prototype.initVelocityConstraints=function(r){this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIB=this.m_bodyB.m_invI;var i=this.m_bodyB.c_position,n=this.m_bodyB.c_velocity,o=i.c,s=i.a,a=n.v,l=n.w,c=M.neo(s),h=this.m_bodyB.getMass(),m=2*r0*this.m_frequencyHz,f=2*h*this.m_dampingRatio*m,p=h*(m*m),_=r.dt;this.m_gamma=_*(f+_*p),this.m_gamma!=0&&(this.m_gamma=1/this.m_gamma),this.m_beta=_*p*this.m_gamma,this.m_rB=M.mulVec2(c,u.sub(this.m_localAnchorB,this.m_localCenterB));var d=new sr;d.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma,d.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y,d.ey.x=d.ex.y,d.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma,this.m_mass=d.getInverse(),this.m_C.setVec2(o),this.m_C.addCombine(1,this.m_rB,-1,this.m_targetA),this.m_C.mul(this.m_beta),l*=.98,r.warmStarting?(this.m_impulse.mul(r.dtRatio),a.addMul(this.m_invMassB,this.m_impulse),l+=this.m_invIB*u.crossVec2Vec2(this.m_rB,this.m_impulse)):this.m_impulse.setZero(),n.v.setVec2(a),n.w=l},t.prototype.solveVelocityConstraints=function(r){var i=this.m_bodyB.c_velocity,n=u.clone(i.v),o=i.w,s=u.crossNumVec2(o,this.m_rB);s.add(n),s.addCombine(1,this.m_C,this.m_gamma,this.m_impulse),s.neg();var a=sr.mulVec2(this.m_mass,s),l=u.clone(this.m_impulse);this.m_impulse.add(a);var c=r.dt*this.m_maxForce;this.m_impulse.clamp(c),a=u.sub(this.m_impulse,l),n.addMul(this.m_invMassB,a),o+=this.m_invIB*u.crossVec2Vec2(this.m_rB,a),i.v.setVec2(n),i.w=o},t.prototype.solvePositionConstraints=function(r){return!0},t.TYPE="mouse-joint",t}(Qt),n0=Math.abs,o0={collideConnected:!0},Jm=function(e){Zt(t,e);function t(r,i,n,o,s,a,l,c){var h=this;return h instanceof t?(r=Me(r,o0),h=e.call(this,r,i,n)||this,i=h.m_bodyA,n=h.m_bodyB,h.m_type=t.TYPE,h.m_groundAnchorA=u.clone(o||r.groundAnchorA||u.neo(-1,1)),h.m_groundAnchorB=u.clone(s||r.groundAnchorB||u.neo(1,1)),h.m_localAnchorA=u.clone(a?i.getLocalPoint(a):r.localAnchorA||u.neo(-1,0)),h.m_localAnchorB=u.clone(l?n.getLocalPoint(l):r.localAnchorB||u.neo(1,0)),h.m_lengthA=Number.isFinite(r.lengthA)?r.lengthA:u.distance(a,o),h.m_lengthB=Number.isFinite(r.lengthB)?r.lengthB:u.distance(l,s),h.m_ratio=Number.isFinite(c)?c:r.ratio,h.m_constant=h.m_lengthA+h.m_ratio*h.m_lengthB,h.m_impulse=0,h):new t(r,i,n,o,s,a,l,c)}return t.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,groundAnchorA:this.m_groundAnchorA,groundAnchorB:this.m_groundAnchorB,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,lengthA:this.m_lengthA,lengthB:this.m_lengthB,ratio:this.m_ratio}},t._deserialize=function(r,i,n){r=Kt({},r),r.bodyA=n(it,r.bodyA,i),r.bodyB=n(it,r.bodyB,i);var o=new t(r);return o},t.prototype._reset=function(r){u.isValid(r.groundAnchorA)&&this.m_groundAnchorA.set(r.groundAnchorA),u.isValid(r.groundAnchorB)&&this.m_groundAnchorB.set(r.groundAnchorB),u.isValid(r.localAnchorA)?this.m_localAnchorA.set(r.localAnchorA):u.isValid(r.anchorA)&&this.m_localAnchorA.set(this.m_bodyA.getLocalPoint(r.anchorA)),u.isValid(r.localAnchorB)?this.m_localAnchorB.set(r.localAnchorB):u.isValid(r.anchorB)&&this.m_localAnchorB.set(this.m_bodyB.getLocalPoint(r.anchorB)),Number.isFinite(r.lengthA)&&(this.m_lengthA=r.lengthA),Number.isFinite(r.lengthB)&&(this.m_lengthB=r.lengthB),Number.isFinite(r.ratio)&&(this.m_ratio=r.ratio)},t.prototype.getGroundAnchorA=function(){return this.m_groundAnchorA},t.prototype.getGroundAnchorB=function(){return this.m_groundAnchorB},t.prototype.getLengthA=function(){return this.m_lengthA},t.prototype.getLengthB=function(){return this.m_lengthB},t.prototype.getRatio=function(){return this.m_ratio},t.prototype.getCurrentLengthA=function(){var r=this.m_bodyA.getWorldPoint(this.m_localAnchorA),i=this.m_groundAnchorA;return u.distance(r,i)},t.prototype.getCurrentLengthB=function(){var r=this.m_bodyB.getWorldPoint(this.m_localAnchorB),i=this.m_groundAnchorB;return u.distance(r,i)},t.prototype.shiftOrigin=function(r){this.m_groundAnchorA.sub(r),this.m_groundAnchorB.sub(r)},t.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},t.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},t.prototype.getReactionForce=function(r){return u.mulNumVec2(this.m_impulse,this.m_uB).mul(r)},t.prototype.getReactionTorque=function(r){return 0},t.prototype.initVelocityConstraints=function(r){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var i=this.m_bodyA.c_position.c,n=this.m_bodyA.c_position.a,o=this.m_bodyA.c_velocity.v,s=this.m_bodyA.c_velocity.w,a=this.m_bodyB.c_position.c,l=this.m_bodyB.c_position.a,c=this.m_bodyB.c_velocity.v,h=this.m_bodyB.c_velocity.w,m=M.neo(n),f=M.neo(l);this.m_rA=M.mulVec2(m,u.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=M.mulVec2(f,u.sub(this.m_localAnchorB,this.m_localCenterB)),this.m_uA=u.sub(u.add(i,this.m_rA),this.m_groundAnchorA),this.m_uB=u.sub(u.add(a,this.m_rB),this.m_groundAnchorB);var p=this.m_uA.length(),_=this.m_uB.length();p>10*z.linearSlop?this.m_uA.mul(1/p):this.m_uA.setZero(),_>10*z.linearSlop?this.m_uB.mul(1/_):this.m_uB.setZero();var d=u.crossVec2Vec2(this.m_rA,this.m_uA),x=u.crossVec2Vec2(this.m_rB,this.m_uB),v=this.m_invMassA+this.m_invIA*d*d,y=this.m_invMassB+this.m_invIB*x*x;if(this.m_mass=v+this.m_ratio*this.m_ratio*y,this.m_mass>0&&(this.m_mass=1/this.m_mass),r.warmStarting){this.m_impulse*=r.dtRatio;var g=u.mulNumVec2(-this.m_impulse,this.m_uA),A=u.mulNumVec2(-this.m_ratio*this.m_impulse,this.m_uB);o.addMul(this.m_invMassA,g),s+=this.m_invIA*u.crossVec2Vec2(this.m_rA,g),c.addMul(this.m_invMassB,A),h+=this.m_invIB*u.crossVec2Vec2(this.m_rB,A)}else this.m_impulse=0;this.m_bodyA.c_velocity.v=o,this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v=c,this.m_bodyB.c_velocity.w=h},t.prototype.solveVelocityConstraints=function(r){var i=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,a=u.add(i,u.crossNumVec2(n,this.m_rA)),l=u.add(o,u.crossNumVec2(s,this.m_rB)),c=-u.dot(this.m_uA,a)-this.m_ratio*u.dot(this.m_uB,l),h=-this.m_mass*c;this.m_impulse+=h;var m=u.mulNumVec2(-h,this.m_uA),f=u.mulNumVec2(-this.m_ratio*h,this.m_uB);i.addMul(this.m_invMassA,m),n+=this.m_invIA*u.crossVec2Vec2(this.m_rA,m),o.addMul(this.m_invMassB,f),s+=this.m_invIB*u.crossVec2Vec2(this.m_rB,f),this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=s},t.prototype.solvePositionConstraints=function(r){var i=this.m_bodyA.c_position.c,n=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,s=this.m_bodyB.c_position.a,a=M.neo(n),l=M.neo(s),c=M.mulVec2(a,u.sub(this.m_localAnchorA,this.m_localCenterA)),h=M.mulVec2(l,u.sub(this.m_localAnchorB,this.m_localCenterB)),m=u.sub(u.add(i,this.m_rA),this.m_groundAnchorA),f=u.sub(u.add(o,this.m_rB),this.m_groundAnchorB),p=m.length(),_=f.length();p>10*z.linearSlop?m.mul(1/p):m.setZero(),_>10*z.linearSlop?f.mul(1/_):f.setZero();var d=u.crossVec2Vec2(c,m),x=u.crossVec2Vec2(h,f),v=this.m_invMassA+this.m_invIA*d*d,y=this.m_invMassB+this.m_invIB*x*x,g=v+this.m_ratio*this.m_ratio*y;g>0&&(g=1/g);var A=this.m_constant-p-this.m_ratio*_,w=n0(A),C=-g*A,S=u.mulNumVec2(-C,m),P=u.mulNumVec2(-this.m_ratio*C,f);return i.addMul(this.m_invMassA,S),n+=this.m_invIA*u.crossVec2Vec2(c,S),o.addMul(this.m_invMassB,P),s+=this.m_invIB*u.crossVec2Vec2(h,P),this.m_bodyA.c_position.c=i,this.m_bodyA.c_position.a=n,this.m_bodyB.c_position.c=o,this.m_bodyB.c_position.a=s,w<z.linearSlop},t.TYPE="pulley-joint",t}(Qt),s0=Math.min,Vo;(function(e){e[e.inactiveLimit=0]="inactiveLimit",e[e.atLowerLimit=1]="atLowerLimit",e[e.atUpperLimit=2]="atUpperLimit",e[e.equalLimits=3]="equalLimits"})(Vo||(Vo={}));var a0={maxLength:0},Xm=function(e){Zt(t,e);function t(r,i,n,o){var s=this;return s instanceof t?(r=Me(r,a0),s=e.call(this,r,i,n)||this,i=s.m_bodyA,n=s.m_bodyB,s.m_type=t.TYPE,s.m_localAnchorA=u.clone(o?i.getLocalPoint(o):r.localAnchorA||u.neo(-1,0)),s.m_localAnchorB=u.clone(o?n.getLocalPoint(o):r.localAnchorB||u.neo(1,0)),s.m_maxLength=r.maxLength,s.m_mass=0,s.m_impulse=0,s.m_length=0,s.m_state=Vo.inactiveLimit,s):new t(r,i,n,o)}return t.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,maxLength:this.m_maxLength}},t._deserialize=function(r,i,n){r=Kt({},r),r.bodyA=n(it,r.bodyA,i),r.bodyB=n(it,r.bodyB,i);var o=new t(r);return o},t.prototype._reset=function(r){Number.isFinite(r.maxLength)&&(this.m_maxLength=r.maxLength)},t.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},t.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},t.prototype.setMaxLength=function(r){this.m_maxLength=r},t.prototype.getMaxLength=function(){return this.m_maxLength},t.prototype.getLimitState=function(){return this.m_state},t.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},t.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},t.prototype.getReactionForce=function(r){return u.mulNumVec2(this.m_impulse,this.m_u).mul(r)},t.prototype.getReactionTorque=function(r){return 0},t.prototype.initVelocityConstraints=function(r){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var i=this.m_bodyA.c_position.c,n=this.m_bodyA.c_position.a,o=this.m_bodyA.c_velocity.v,s=this.m_bodyA.c_velocity.w,a=this.m_bodyB.c_position.c,l=this.m_bodyB.c_position.a,c=this.m_bodyB.c_velocity.v,h=this.m_bodyB.c_velocity.w,m=M.neo(n),f=M.neo(l);this.m_rA=M.mulSub(m,this.m_localAnchorA,this.m_localCenterA),this.m_rB=M.mulSub(f,this.m_localAnchorB,this.m_localCenterB),this.m_u=u.zero(),this.m_u.addCombine(1,a,1,this.m_rB),this.m_u.subCombine(1,i,1,this.m_rA),this.m_length=this.m_u.length();var p=this.m_length-this.m_maxLength;if(p>0?this.m_state=Vo.atUpperLimit:this.m_state=Vo.inactiveLimit,this.m_length>z.linearSlop)this.m_u.mul(1/this.m_length);else{this.m_u.setZero(),this.m_mass=0,this.m_impulse=0;return}var _=u.crossVec2Vec2(this.m_rA,this.m_u),d=u.crossVec2Vec2(this.m_rB,this.m_u),x=this.m_invMassA+this.m_invIA*_*_+this.m_invMassB+this.m_invIB*d*d;if(this.m_mass=x!=0?1/x:0,r.warmStarting){this.m_impulse*=r.dtRatio;var v=u.mulNumVec2(this.m_impulse,this.m_u);o.subMul(this.m_invMassA,v),s-=this.m_invIA*u.crossVec2Vec2(this.m_rA,v),c.addMul(this.m_invMassB,v),h+=this.m_invIB*u.crossVec2Vec2(this.m_rB,v)}else this.m_impulse=0;this.m_bodyA.c_velocity.v.setVec2(o),this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v.setVec2(c),this.m_bodyB.c_velocity.w=h},t.prototype.solveVelocityConstraints=function(r){var i=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,a=u.addCrossNumVec2(i,n,this.m_rA),l=u.addCrossNumVec2(o,s,this.m_rB),c=this.m_length-this.m_maxLength,h=u.dot(this.m_u,u.sub(l,a));c<0&&(h+=r.inv_dt*c);var m=-this.m_mass*h,f=this.m_impulse;this.m_impulse=s0(0,this.m_impulse+m),m=this.m_impulse-f;var p=u.mulNumVec2(m,this.m_u);i.subMul(this.m_invMassA,p),n-=this.m_invIA*u.crossVec2Vec2(this.m_rA,p),o.addMul(this.m_invMassB,p),s+=this.m_invIB*u.crossVec2Vec2(this.m_rB,p),this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=s},t.prototype.solvePositionConstraints=function(r){var i=this.m_bodyA.c_position.c,n=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,s=this.m_bodyB.c_position.a,a=M.neo(n),l=M.neo(s),c=M.mulSub(a,this.m_localAnchorA,this.m_localCenterA),h=M.mulSub(l,this.m_localAnchorB,this.m_localCenterB),m=u.zero();m.addCombine(1,o,1,h),m.subCombine(1,i,1,c);var f=m.normalize(),p=f-this.m_maxLength;p=qt(p,0,z.maxLinearCorrection);var _=-this.m_mass*p,d=u.mulNumVec2(_,m);return i.subMul(this.m_invMassA,d),n-=this.m_invIA*u.crossVec2Vec2(c,d),o.addMul(this.m_invMassB,d),s+=this.m_invIB*u.crossVec2Vec2(h,d),this.m_bodyA.c_position.c.setVec2(i),this.m_bodyA.c_position.a=n,this.m_bodyB.c_position.c.setVec2(o),this.m_bodyB.c_position.a=s,f-this.m_maxLength<z.linearSlop},t.TYPE="rope-joint",t}(Qt),l0=Math.abs,u0=Math.PI,c0={frequencyHz:0,dampingRatio:0},Qm=function(e){Zt(t,e);function t(r,i,n,o){var s=this;return s instanceof t?(r=Me(r,c0),s=e.call(this,r,i,n)||this,i=s.m_bodyA,n=s.m_bodyB,s.m_type=t.TYPE,s.m_localAnchorA=u.clone(o?i.getLocalPoint(o):r.localAnchorA||u.zero()),s.m_localAnchorB=u.clone(o?n.getLocalPoint(o):r.localAnchorB||u.zero()),s.m_referenceAngle=Number.isFinite(r.referenceAngle)?r.referenceAngle:n.getAngle()-i.getAngle(),s.m_frequencyHz=r.frequencyHz,s.m_dampingRatio=r.dampingRatio,s.m_impulse=new tt,s.m_bias=0,s.m_gamma=0,s.m_mass=new Zr,s):new t(r,i,n,o)}return t.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,referenceAngle:this.m_referenceAngle}},t._deserialize=function(r,i,n){r=Kt({},r),r.bodyA=n(it,r.bodyA,i),r.bodyB=n(it,r.bodyB,i);var o=new t(r);return o},t.prototype._reset=function(r){r.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(r.anchorA)):r.localAnchorA&&this.m_localAnchorA.setVec2(r.localAnchorA),r.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(r.anchorB)):r.localAnchorB&&this.m_localAnchorB.setVec2(r.localAnchorB),Number.isFinite(r.frequencyHz)&&(this.m_frequencyHz=r.frequencyHz),Number.isFinite(r.dampingRatio)&&(this.m_dampingRatio=r.dampingRatio)},t.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},t.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},t.prototype.getReferenceAngle=function(){return this.m_referenceAngle},t.prototype.setFrequency=function(r){this.m_frequencyHz=r},t.prototype.getFrequency=function(){return this.m_frequencyHz},t.prototype.setDampingRatio=function(r){this.m_dampingRatio=r},t.prototype.getDampingRatio=function(){return this.m_dampingRatio},t.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},t.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},t.prototype.getReactionForce=function(r){return u.neo(this.m_impulse.x,this.m_impulse.y).mul(r)},t.prototype.getReactionTorque=function(r){return r*this.m_impulse.z},t.prototype.initVelocityConstraints=function(r){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var i=this.m_bodyA.c_position.a,n=this.m_bodyA.c_velocity.v,o=this.m_bodyA.c_velocity.w,s=this.m_bodyB.c_position.a,a=this.m_bodyB.c_velocity.v,l=this.m_bodyB.c_velocity.w,c=M.neo(i),h=M.neo(s);this.m_rA=M.mulVec2(c,u.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=M.mulVec2(h,u.sub(this.m_localAnchorB,this.m_localCenterB));var m=this.m_invMassA,f=this.m_invMassB,p=this.m_invIA,_=this.m_invIB,d=new Zr;if(d.ex.x=m+f+this.m_rA.y*this.m_rA.y*p+this.m_rB.y*this.m_rB.y*_,d.ey.x=-this.m_rA.y*this.m_rA.x*p-this.m_rB.y*this.m_rB.x*_,d.ez.x=-this.m_rA.y*p-this.m_rB.y*_,d.ex.y=d.ey.x,d.ey.y=m+f+this.m_rA.x*this.m_rA.x*p+this.m_rB.x*this.m_rB.x*_,d.ez.y=this.m_rA.x*p+this.m_rB.x*_,d.ex.z=d.ez.x,d.ey.z=d.ez.y,d.ez.z=p+_,this.m_frequencyHz>0){d.getInverse22(this.m_mass);var x=p+_,v=x>0?1/x:0,y=s-i-this.m_referenceAngle,g=2*u0*this.m_frequencyHz,A=2*v*this.m_dampingRatio*g,w=v*g*g,C=r.dt;this.m_gamma=C*(A+C*w),this.m_gamma=this.m_gamma!=0?1/this.m_gamma:0,this.m_bias=y*C*w*this.m_gamma,x+=this.m_gamma,this.m_mass.ez.z=x!=0?1/x:0}else d.ez.z==0?(d.getInverse22(this.m_mass),this.m_gamma=0,this.m_bias=0):(d.getSymInverse33(this.m_mass),this.m_gamma=0,this.m_bias=0);if(r.warmStarting){this.m_impulse.mul(r.dtRatio);var S=u.neo(this.m_impulse.x,this.m_impulse.y);n.subMul(m,S),o-=p*(u.crossVec2Vec2(this.m_rA,S)+this.m_impulse.z),a.addMul(f,S),l+=_*(u.crossVec2Vec2(this.m_rB,S)+this.m_impulse.z)}else this.m_impulse.setZero();this.m_bodyA.c_velocity.v=n,this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v=a,this.m_bodyB.c_velocity.w=l},t.prototype.solveVelocityConstraints=function(r){var i=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,a=this.m_invMassA,l=this.m_invMassB,c=this.m_invIA,h=this.m_invIB;if(this.m_frequencyHz>0){var m=s-n,f=-this.m_mass.ez.z*(m+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=f,n-=c*f,s+=h*f;var p=u.zero();p.addCombine(1,o,1,u.crossNumVec2(s,this.m_rB)),p.subCombine(1,i,1,u.crossNumVec2(n,this.m_rA));var _=u.neg(Zr.mulVec2(this.m_mass,p));this.m_impulse.x+=_.x,this.m_impulse.y+=_.y;var d=u.clone(_);i.subMul(a,d),n-=c*u.crossVec2Vec2(this.m_rA,d),o.addMul(l,d),s+=h*u.crossVec2Vec2(this.m_rB,d)}else{var p=u.zero();p.addCombine(1,o,1,u.crossNumVec2(s,this.m_rB)),p.subCombine(1,i,1,u.crossNumVec2(n,this.m_rA));var m=s-n,x=new tt(p.x,p.y,m),v=tt.neg(Zr.mulVec3(this.m_mass,x));this.m_impulse.add(v);var d=u.neo(v.x,v.y);i.subMul(a,d),n-=c*(u.crossVec2Vec2(this.m_rA,d)+v.z),o.addMul(l,d),s+=h*(u.crossVec2Vec2(this.m_rB,d)+v.z)}this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=s},t.prototype.solvePositionConstraints=function(r){var i=this.m_bodyA.c_position.c,n=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,s=this.m_bodyB.c_position.a,a=M.neo(n),l=M.neo(s),c=this.m_invMassA,h=this.m_invMassB,m=this.m_invIA,f=this.m_invIB,p=M.mulVec2(a,u.sub(this.m_localAnchorA,this.m_localCenterA)),_=M.mulVec2(l,u.sub(this.m_localAnchorB,this.m_localCenterB)),d,x,v=new Zr;if(v.ex.x=c+h+p.y*p.y*m+_.y*_.y*f,v.ey.x=-p.y*p.x*m-_.y*_.x*f,v.ez.x=-p.y*m-_.y*f,v.ex.y=v.ey.x,v.ey.y=c+h+p.x*p.x*m+_.x*_.x*f,v.ez.y=p.x*m+_.x*f,v.ex.z=v.ez.x,v.ey.z=v.ez.y,v.ez.z=m+f,this.m_frequencyHz>0){var y=u.zero();y.addCombine(1,o,1,_),y.subCombine(1,i,1,p),d=y.length(),x=0;var g=u.neg(v.solve22(y));i.subMul(c,g),n-=m*u.crossVec2Vec2(p,g),o.addMul(h,g),s+=f*u.crossVec2Vec2(_,g)}else{var y=u.zero();y.addCombine(1,o,1,_),y.subCombine(1,i,1,p);var A=s-n-this.m_referenceAngle;d=y.length(),x=l0(A);var w=new tt(y.x,y.y,A),C=new tt;if(v.ez.z>0)C=tt.neg(v.solve33(w));else{var S=u.neg(v.solve22(y));C.set(S.x,S.y,0)}var g=u.neo(C.x,C.y);i.subMul(c,g),n-=m*(u.crossVec2Vec2(p,g)+C.z),o.addMul(h,g),s+=f*(u.crossVec2Vec2(_,g)+C.z)}return this.m_bodyA.c_position.c=i,this.m_bodyA.c_position.a=n,this.m_bodyB.c_position.c=o,this.m_bodyB.c_position.a=s,d<=z.linearSlop&&x<=z.angularSlop},t.TYPE="weld-joint",t}(Qt),h0=Math.abs,m0=Math.PI,f0={enableMotor:!1,maxMotorTorque:0,motorSpeed:0,frequencyHz:2,dampingRatio:.7},Gm=function(e){Zt(t,e);function t(r,i,n,o,s){var a=this;return a instanceof t?(r=Me(r,f0),a=e.call(this,r,i,n)||this,i=a.m_bodyA,n=a.m_bodyB,a.m_ax=u.zero(),a.m_ay=u.zero(),a.m_type=t.TYPE,a.m_localAnchorA=u.clone(o?i.getLocalPoint(o):r.localAnchorA||u.zero()),a.m_localAnchorB=u.clone(o?n.getLocalPoint(o):r.localAnchorB||u.zero()),u.isValid(s)?a.m_localXAxisA=i.getLocalVector(s):u.isValid(r.localAxisA)?a.m_localXAxisA=u.clone(r.localAxisA):u.isValid(r.localAxis)?a.m_localXAxisA=u.clone(r.localAxis):a.m_localXAxisA=u.neo(1,0),a.m_localYAxisA=u.crossNumVec2(1,a.m_localXAxisA),a.m_mass=0,a.m_impulse=0,a.m_motorMass=0,a.m_motorImpulse=0,a.m_springMass=0,a.m_springImpulse=0,a.m_maxMotorTorque=r.maxMotorTorque,a.m_motorSpeed=r.motorSpeed,a.m_enableMotor=r.enableMotor,a.m_frequencyHz=r.frequencyHz,a.m_dampingRatio=r.dampingRatio,a.m_bias=0,a.m_gamma=0,a):new t(r,i,n,o,s)}return t.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,enableMotor:this.m_enableMotor,maxMotorTorque:this.m_maxMotorTorque,motorSpeed:this.m_motorSpeed,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,localAxisA:this.m_localXAxisA}},t._deserialize=function(r,i,n){r=Kt({},r),r.bodyA=n(it,r.bodyA,i),r.bodyB=n(it,r.bodyB,i);var o=new t(r);return o},t.prototype._reset=function(r){r.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(r.anchorA)):r.localAnchorA&&this.m_localAnchorA.setVec2(r.localAnchorA),r.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(r.anchorB)):r.localAnchorB&&this.m_localAnchorB.setVec2(r.localAnchorB),r.localAxisA&&(this.m_localXAxisA.setVec2(r.localAxisA),this.m_localYAxisA.setVec2(u.crossNumVec2(1,r.localAxisA))),r.enableMotor!==void 0&&(this.m_enableMotor=r.enableMotor),Number.isFinite(r.maxMotorTorque)&&(this.m_maxMotorTorque=r.maxMotorTorque),Number.isFinite(r.motorSpeed)&&(this.m_motorSpeed=r.motorSpeed),Number.isFinite(r.frequencyHz)&&(this.m_frequencyHz=r.frequencyHz),Number.isFinite(r.dampingRatio)&&(this.m_dampingRatio=r.dampingRatio)},t.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},t.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},t.prototype.getLocalAxisA=function(){return this.m_localXAxisA},t.prototype.getJointTranslation=function(){var r=this.m_bodyA,i=this.m_bodyB,n=r.getWorldPoint(this.m_localAnchorA),o=i.getWorldPoint(this.m_localAnchorB),s=u.sub(o,n),a=r.getWorldVector(this.m_localXAxisA),l=u.dot(s,a);return l},t.prototype.getJointSpeed=function(){var r=this.m_bodyA.m_angularVelocity,i=this.m_bodyB.m_angularVelocity;return i-r},t.prototype.isMotorEnabled=function(){return this.m_enableMotor},t.prototype.enableMotor=function(r){r!=this.m_enableMotor&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=r)},t.prototype.setMotorSpeed=function(r){r!=this.m_motorSpeed&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=r)},t.prototype.getMotorSpeed=function(){return this.m_motorSpeed},t.prototype.setMaxMotorTorque=function(r){r!=this.m_maxMotorTorque&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorTorque=r)},t.prototype.getMaxMotorTorque=function(){return this.m_maxMotorTorque},t.prototype.getMotorTorque=function(r){return r*this.m_motorImpulse},t.prototype.setSpringFrequencyHz=function(r){this.m_frequencyHz=r},t.prototype.getSpringFrequencyHz=function(){return this.m_frequencyHz},t.prototype.setSpringDampingRatio=function(r){this.m_dampingRatio=r},t.prototype.getSpringDampingRatio=function(){return this.m_dampingRatio},t.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},t.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},t.prototype.getReactionForce=function(r){return u.combine(this.m_impulse,this.m_ay,this.m_springImpulse,this.m_ax).mul(r)},t.prototype.getReactionTorque=function(r){return r*this.m_motorImpulse},t.prototype.initVelocityConstraints=function(r){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var i=this.m_invMassA,n=this.m_invMassB,o=this.m_invIA,s=this.m_invIB,a=this.m_bodyA.c_position.c,l=this.m_bodyA.c_position.a,c=this.m_bodyA.c_velocity.v,h=this.m_bodyA.c_velocity.w,m=this.m_bodyB.c_position.c,f=this.m_bodyB.c_position.a,p=this.m_bodyB.c_velocity.v,_=this.m_bodyB.c_velocity.w,d=M.neo(l),x=M.neo(f),v=M.mulVec2(d,u.sub(this.m_localAnchorA,this.m_localCenterA)),y=M.mulVec2(x,u.sub(this.m_localAnchorB,this.m_localCenterB)),g=u.zero();if(g.addCombine(1,m,1,y),g.subCombine(1,a,1,v),this.m_ay=M.mulVec2(d,this.m_localYAxisA),this.m_sAy=u.crossVec2Vec2(u.add(g,v),this.m_ay),this.m_sBy=u.crossVec2Vec2(y,this.m_ay),this.m_mass=i+n+o*this.m_sAy*this.m_sAy+s*this.m_sBy*this.m_sBy,this.m_mass>0&&(this.m_mass=1/this.m_mass),this.m_springMass=0,this.m_bias=0,this.m_gamma=0,this.m_frequencyHz>0){this.m_ax=M.mulVec2(d,this.m_localXAxisA),this.m_sAx=u.crossVec2Vec2(u.add(g,v),this.m_ax),this.m_sBx=u.crossVec2Vec2(y,this.m_ax);var A=i+n+o*this.m_sAx*this.m_sAx+s*this.m_sBx*this.m_sBx;if(A>0){this.m_springMass=1/A;var w=u.dot(g,this.m_ax),C=2*m0*this.m_frequencyHz,S=2*this.m_springMass*this.m_dampingRatio*C,P=this.m_springMass*C*C,F=r.dt;this.m_gamma=F*(S+F*P),this.m_gamma>0&&(this.m_gamma=1/this.m_gamma),this.m_bias=w*F*P*this.m_gamma,this.m_springMass=A+this.m_gamma,this.m_springMass>0&&(this.m_springMass=1/this.m_springMass)}}else this.m_springImpulse=0;if(this.m_enableMotor?(this.m_motorMass=o+s,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass)):(this.m_motorMass=0,this.m_motorImpulse=0),r.warmStarting){this.m_impulse*=r.dtRatio,this.m_springImpulse*=r.dtRatio,this.m_motorImpulse*=r.dtRatio;var I=u.combine(this.m_impulse,this.m_ay,this.m_springImpulse,this.m_ax),O=this.m_impulse*this.m_sAy+this.m_springImpulse*this.m_sAx+this.m_motorImpulse,X=this.m_impulse*this.m_sBy+this.m_springImpulse*this.m_sBx+this.m_motorImpulse;c.subMul(this.m_invMassA,I),h-=this.m_invIA*O,p.addMul(this.m_invMassB,I),_+=this.m_invIB*X}else this.m_impulse=0,this.m_springImpulse=0,this.m_motorImpulse=0;this.m_bodyA.c_velocity.v.setVec2(c),this.m_bodyA.c_velocity.w=h,this.m_bodyB.c_velocity.v.setVec2(p),this.m_bodyB.c_velocity.w=_},t.prototype.solveVelocityConstraints=function(r){var i=this.m_invMassA,n=this.m_invMassB,o=this.m_invIA,s=this.m_invIB,a=this.m_bodyA.c_velocity.v,l=this.m_bodyA.c_velocity.w,c=this.m_bodyB.c_velocity.v,h=this.m_bodyB.c_velocity.w;{var m=u.dot(this.m_ax,c)-u.dot(this.m_ax,a)+this.m_sBx*h-this.m_sAx*l,f=-this.m_springMass*(m+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=f;var p=u.mulNumVec2(f,this.m_ax),_=f*this.m_sAx,d=f*this.m_sBx;a.subMul(i,p),l-=o*_,c.addMul(n,p),h+=s*d}{var m=h-l-this.m_motorSpeed,f=-this.m_motorMass*m,x=this.m_motorImpulse,v=r.dt*this.m_maxMotorTorque;this.m_motorImpulse=qt(this.m_motorImpulse+f,-v,v),f=this.m_motorImpulse-x,l-=o*f,h+=s*f}{var m=u.dot(this.m_ay,c)-u.dot(this.m_ay,a)+this.m_sBy*h-this.m_sAy*l,f=-this.m_mass*m;this.m_impulse+=f;var p=u.mulNumVec2(f,this.m_ay),_=f*this.m_sAy,d=f*this.m_sBy;a.subMul(i,p),l-=o*_,c.addMul(n,p),h+=s*d}this.m_bodyA.c_velocity.v.setVec2(a),this.m_bodyA.c_velocity.w=l,this.m_bodyB.c_velocity.v.setVec2(c),this.m_bodyB.c_velocity.w=h},t.prototype.solvePositionConstraints=function(r){var i=this.m_bodyA.c_position.c,n=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,s=this.m_bodyB.c_position.a,a=M.neo(n),l=M.neo(s),c=M.mulVec2(a,u.sub(this.m_localAnchorA,this.m_localCenterA)),h=M.mulVec2(l,u.sub(this.m_localAnchorB,this.m_localCenterB)),m=u.zero();m.addCombine(1,o,1,h),m.subCombine(1,i,1,c);var f=M.mulVec2(a,this.m_localYAxisA),p=u.crossVec2Vec2(u.add(m,c),f),_=u.crossVec2Vec2(h,f),d=u.dot(m,f),x=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy,v=x!=0?-d/x:0,y=u.mulNumVec2(v,f),g=v*p,A=v*_;return i.subMul(this.m_invMassA,y),n-=this.m_invIA*g,o.addMul(this.m_invMassB,y),s+=this.m_invIB*A,this.m_bodyA.c_position.c.setVec2(i),this.m_bodyA.c_position.a=n,this.m_bodyB.c_position.c.setVec2(o),this.m_bodyB.c_position.a=s,h0(d)<=z.linearSlop},t.TYPE="wheel-joint",t}(Qt),Vt,p0=0,Km={World:es,Body:it,Joint:Qt,Fixture:Ta,Shape:en},Zm={Vec2:u,Vec3:tt,World:es,Body:it,Joint:Qt,Fixture:Ta,Shape:en},_0=(Vt={},Vt[it.STATIC]=it,Vt[it.DYNAMIC]=it,Vt[it.KINEMATIC]=it,Vt[ka.TYPE]=ka,Vt[Dr.TYPE]=Dr,Vt[fi.TYPE]=fi,Vt[pi.TYPE]=pi,Vt[Om.TYPE]=Om,Vt[qm.TYPE]=qm,Vt[Wm.TYPE]=Wm,Vt[Hm.TYPE]=Hm,Vt[Ym.TYPE]=Ym,Vt[jm.TYPE]=jm,Vt[Jm.TYPE]=Jm,Vt[Qr.TYPE]=Qr,Vt[Xm.TYPE]=Xm,Vt[Qm.TYPE]=Qm,Vt[Gm.TYPE]=Gm,Vt),d0={rootClass:es,preSerialize:function(e){return e},postSerialize:function(e,t){return e},preDeserialize:function(e){return e},postDeserialize:function(e,t){return e}},qc=function(){function e(t){var r=this;this.toJson=function(i){var n=r.options.preSerialize,o=r.options.postSerialize,s=[],a=[i],l={};function c(_,d){if(_.__sid=_.__sid||++p0,!l[_.__sid]){a.push(_);var x=s.length+a.length,v={refIndex:x,refType:d};l[_.__sid]=v}return l[_.__sid]}function h(_){_=n(_);var d=_._serialize();return d=o(d,_),d}function m(_,d){if(d===void 0&&(d=!1),typeof _!="object"||_===null)return _;if(typeof _._serialize=="function"){if(!d){for(var x in Km)if(_ instanceof Km[x])return c(_,x)}_=h(_)}if(Array.isArray(_)){for(var v=[],y=0;y<_.length;y++)v[y]=m(_[y]);_=v}else{var v={};for(var y in _)_.hasOwnProperty(y)&&(v[y]=m(_[y]));_=v}return _}for(;a.length;){var f=a.shift(),p=m(f,!0);s.push(p)}return s},this.fromJson=function(i){var n=r.options.preDeserialize,o=r.options.postDeserialize,s=r.options.rootClass,a={};function l(m,f,p){(!m||!m._deserialize)&&(m=_0[f.type]);var _=m&&m._deserialize;if(_){f=n(f);var d=m._deserialize,x=d(f,p,c);return x=o(x,f),x}}function c(m,f,p){var _=f.refIndex&&f.refType;if(!_)return l(m,f,p);var d=f;Zm[d.refType]&&(m=Zm[d.refType]);var x=d.refIndex;if(!a[x]){var v=i[x],y=l(m,v,p);a[x]=y}return a[x]}var h=l(s,i[0],null);return h},this.options=Kt(Kt({},d0),t)}return e}(),td=new qc({rootClass:es});qc.fromJson=td.fromJson;qc.toJson=td.toJson;(function(){function e(){}return e.mount=function(t){throw new Error("Not implemented")},e.start=function(t){var r=e.mount();return r.start(t),r},e})();(function(e){Zt(t,e);function t(r,i,n,o){var s=this;return s instanceof t?(s=e.call(this)||this,s._setAsBox(r,i,n,o),s):new t(r,i,n,o)}return t.TYPE="polygon",t})(Dr);Ar.addType(pi.TYPE,pi.TYPE,v0);function v0(e,t,r,i,n,o,s){y0(e,r.getShape(),t,o.getShape(),n)}var tf=b(0,0),ef=b(0,0),y0=function(e,t,r,i,n){e.pointCount=0,U(tf,r,t.m_p),U(ef,n,i.m_p);var o=ji(ef,tf),s=t.m_radius,a=i.m_radius,l=s+a;o>l*l||(e.type=yt.e_circles,B(e.localPoint,t.m_p),R(e.localNormal),e.pointCount=1,B(e.points[0].localPoint,i.m_p),e.points[0].id.setFeatures(0,Z.e_vertex,0,Z.e_vertex))};Ar.addType(fi.TYPE,pi.TYPE,g0);Ar.addType(ka.TYPE,pi.TYPE,x0);function g0(e,t,r,i,n,o,s){var a=r.getShape(),l=o.getShape();ed(e,a,t,l,n)}function x0(e,t,r,i,n,o,s){var a=r.getShape(),l=new fi;a.getChildEdge(l,i);var c=l,h=o.getShape();ed(e,c,t,h,n)}var Mi=b(0,0),El=b(0,0),Nl=b(0,0),Mr=b(0,0),Vi=b(0,0),pn=b(0,0),ed=function(e,t,r,i,n){e.pointCount=0,$_(Mr,n,r,i.m_p);var o=t.m_vertex1,s=t.m_vertex2;$(Mi,s,o);var a=V(Mi,s)-V(Mi,Mr),l=V(Mi,Mr)-V(Mi,o),c=t.m_radius+i.m_radius;if(l<=0){B(Vi,o);var h=ji(Mr,o);if(h>c*c)return;if(t.m_hasVertex0){var m=t.m_vertex0,f=o;$(El,f,m);var p=V(El,f)-V(El,Mr);if(p>0)return}e.type=yt.e_circles,R(e.localNormal),B(e.localPoint,Vi),e.pointCount=1,B(e.points[0].localPoint,i.m_p),e.points[0].id.setFeatures(0,Z.e_vertex,0,Z.e_vertex);return}if(a<=0){B(Vi,s);var _=ji(Mr,Vi);if(_>c*c)return;if(t.m_hasVertex3){var d=t.m_vertex3,x=s;$(Nl,d,x);var v=V(Nl,Mr)-V(Nl,x);if(v>0)return}e.type=yt.e_circles,R(e.localNormal),B(e.localPoint,Vi),e.pointCount=1,B(e.points[0].localPoint,i.m_p),e.points[0].id.setFeatures(1,Z.e_vertex,0,Z.e_vertex);return}var y=$i(Mi);ft(Vi,a/y,o,l/y,s);var g=ji(Mr,Vi);g>c*c||(ge(pn,1,Mi),V(pn,Mr)-V(pn,o)<0&&Jo(pn),nr(pn),e.type=yt.e_faceA,B(e.localNormal,pn),B(e.localPoint,o),e.pointCount=1,B(e.points[0].localPoint,i.m_p),e.points[0].id.setFeatures(0,Z.e_face,0,Z.e_vertex))},Os=[new Se,new Se],qs=[new Se,new Se],Ti=[new Se,new Se],Us=b(0,0),rf=b(0,0),Rl=b(0,0),Dl=tn(0,0,0),ki=b(0,0),_n=b(0,0),$s=b(0,0),nf=b(0,0),of=b(0,0),Wr=b(0,0),Ol=b(0,0),sf=b(0,0);Ar.addType(Dr.TYPE,Dr.TYPE,A0);function A0(e,t,r,i,n,o,s){B0(e,r.getShape(),t,o.getShape(),n)}function af(e,t,r,i,n){var o=e.m_count,s=r.m_count,a=e.m_normals,l=e.m_vertices,c=r.m_vertices;j_(Dl,i,t);for(var h=0,m=-1/0,f=0;f<o;++f){qe(Rl,Dl.q,a[f]),U(rf,Dl,l[f]);for(var p=1/0,_=0;_<s;++_){var d=V(Rl,c[_])-V(Rl,rf);d<p&&(p=d)}p>m&&(m=p,h=f)}n.maxSeparation=m,n.bestIndex=h}function w0(e,t,r,i,n,o){var s=t.m_normals,a=n.m_count,l=n.m_vertices,c=n.m_normals;Bg(sf,o.q,r.q,s[i]);for(var h=0,m=1/0,f=0;f<a;++f){var p=V(sf,c[f]);p<m&&(m=p,h=f)}var _=h,d=_+1<a?_+1:0;U(e[0].v,o,l[_]),e[0].id.setFeatures(i,Z.e_face,_,Z.e_vertex),U(e[1].v,o,l[d]),e[1].id.setFeatures(i,Z.e_face,d,Z.e_vertex)}var dn={maxSeparation:0,bestIndex:0},B0=function(e,t,r,i,n){e.pointCount=0;var o=t.m_radius+i.m_radius;af(t,r,i,n,dn);var s=dn.bestIndex,a=dn.maxSeparation;if(!(a>o)){af(i,n,t,r,dn);var l=dn.bestIndex,c=dn.maxSeparation;if(!(c>o)){var h,m,f,p,_,d,x=.1*z.linearSlop;c>a+x?(h=i,m=t,f=n,p=r,_=l,e.type=yt.e_faceB,d=!0):(h=t,m=i,f=r,p=n,_=s,e.type=yt.e_faceA,d=!1),Os[0].recycle(),Os[1].recycle(),w0(Os,h,f,_,m,p);var v=h.m_count,y=h.m_vertices,g=_,A=_+1<v?_+1:0;B(ki,y[g]),B(_n,y[A]),$($s,_n,ki),nr($s),Ui(nf,$s,1),ft(of,.5,ki,.5,_n),qe(Wr,f.q,$s),Ui(Ol,Wr,1),U(ki,f,ki),U(_n,f,_n);var w=V(Ol,ki),C=-V(Wr,ki)+o,S=V(Wr,_n)+o;qs[0].recycle(),qs[1].recycle(),Ti[0].recycle(),Ti[1].recycle(),Ot(Us,-Wr.x,-Wr.y);var P=Xo(qs,Os,Us,C,g);if(!(P<2)){Ot(Us,Wr.x,Wr.y);var F=Xo(Ti,qs,Us,S,A);if(!(F<2)){B(e.localNormal,nf),B(e.localPoint,of);for(var I=0,O=0;O<Ti.length;++O){var X=V(Ol,Ti[O].v)-w;if(X<=o){var Q=e.points[I];Fc(Q.localPoint,p,Ti[O].v),Q.id.set(Ti[O].id),d&&Q.id.swapFeatures(),++I}}e.pointCount=I}}}}};Ar.addType(Dr.TYPE,pi.TYPE,C0);function C0(e,t,r,i,n,o,s){S0(e,r.getShape(),t,o.getShape(),n)}var Xe=b(0,0),ql=b(0,0),S0=function(e,t,r,i,n){e.pointCount=0,$_(Xe,n,r,i.m_p);for(var o=0,s=-1/0,a=t.m_radius+i.m_radius,l=t.m_count,c=t.m_vertices,h=t.m_normals,m=0;m<l;++m){var f=V(h[m],Xe)-V(h[m],c[m]);if(f>a)return;f>s&&(s=f,o=m)}var p=o,_=p+1<l?p+1:0,d=c[p],x=c[_];if(s<ie){e.pointCount=1,e.type=yt.e_faceA,B(e.localNormal,h[o]),ft(e.localPoint,.5,d,.5,x),B(e.points[0].localPoint,i.m_p),e.points[0].id.setFeatures(0,Z.e_vertex,0,Z.e_vertex);return}var v=V(Xe,x)-V(Xe,d)-V(d,x)+V(d,d),y=V(Xe,d)-V(Xe,x)-V(x,d)+V(x,x);if(v<=0){if(ji(Xe,d)>a*a)return;e.pointCount=1,e.type=yt.e_faceA,$(e.localNormal,Xe,d),nr(e.localNormal),B(e.localPoint,d),B(e.points[0].localPoint,i.m_p),e.points[0].id.setFeatures(0,Z.e_vertex,0,Z.e_vertex)}else if(y<=0){if(ji(Xe,x)>a*a)return;e.pointCount=1,e.type=yt.e_faceA,$(e.localNormal,Xe,x),nr(e.localNormal),B(e.localPoint,x),B(e.points[0].localPoint,i.m_p),e.points[0].id.setFeatures(0,Z.e_vertex,0,Z.e_vertex)}else{ft(ql,.5,d,.5,x);var g=V(Xe,h[p])-V(ql,h[p]);if(g>a)return;e.pointCount=1,e.type=yt.e_faceA,B(e.localNormal,h[p]),B(e.localPoint,ql),B(e.points[0].localPoint,i.m_p),e.points[0].id.setFeatures(0,Z.e_vertex,0,Z.e_vertex)}},P0=Math.min;Ar.addType(fi.TYPE,Dr.TYPE,b0);Ar.addType(ka.TYPE,Dr.TYPE,M0);function b0(e,t,r,i,n,o,s){id(e,r.getShape(),t,o.getShape(),n)}var lf=new fi;function M0(e,t,r,i,n,o,s){var a=r.getShape();a.getChildEdge(lf,i),id(e,lf,t,o.getShape(),n)}var Fe;(function(e){e[e.e_unknown=-1]="e_unknown",e[e.e_edgeA=1]="e_edgeA",e[e.e_edgeB=2]="e_edgeB"})(Fe||(Fe={}));var uf;(function(e){e[e.e_isolated=0]="e_isolated",e[e.e_concave=1]="e_concave",e[e.e_convex=2]="e_convex"})(uf||(uf={}));var rd=function(){function e(){}return e}(),V0=function(){function e(){this.vertices=[],this.normals=[],this.count=0;for(var t=0;t<z.maxPolygonVertices;t++)this.vertices.push(b(0,0)),this.normals.push(b(0,0))}return e}(),T0=function(){function e(){this.v1=b(0,0),this.v2=b(0,0),this.normal=b(0,0),this.sideNormal1=b(0,0),this.sideNormal2=b(0,0)}return e.prototype.recycle=function(){R(this.v1),R(this.v2),R(this.normal),R(this.sideNormal1),R(this.sideNormal2)},e}(),js=[new Se,new Se],Hr=[new Se,new Se],Qe=[new Se,new Se],mr=new rd,te=new rd,zt=new V0,j=new T0,Ws=b(0,0),co=b(0,0),vn=b(0,0),ho=b(0,0),mo=tn(0,0,0),ot=b(0,0),fr=b(0,0),q=b(0,0),pr=b(0,0),Tt=b(0,0),kt=b(0,0),cf=b(0,0),Yr=b(0,0),id=function(e,t,r,i,n){j_(mo,r,n),U(Ws,mo,i.m_centroid);var o=t.m_vertex0,s=t.m_vertex1,a=t.m_vertex2,l=t.m_vertex3,c=t.m_hasVertex0,h=t.m_hasVertex3;$(vn,a,s),nr(vn),Ot(q,vn.y,-vn.x);var m=V(q,Ws)-V(q,s),f=0,p=0,_=!1,d=!1;R(fr),R(pr),c&&($(co,s,o),nr(co),Ot(fr,co.y,-co.x),_=J(co,vn)>=0,f=u.dot(fr,Ws)-u.dot(fr,o)),h&&($(ho,l,a),nr(ho),Ot(pr,ho.y,-ho.x),d=u.crossVec2Vec2(vn,ho)>0,p=u.dot(pr,Ws)-u.dot(pr,a));var x;R(ot),R(Tt),R(kt),c&&h?_&&d?(x=f>=0||m>=0||p>=0,x?(B(ot,q),B(Tt,fr),B(kt,pr)):(D(ot,-1,q),D(Tt,-1,q),D(kt,-1,q))):_?(x=f>=0||m>=0&&p>=0,x?(B(ot,q),B(Tt,fr),B(kt,q)):(D(ot,-1,q),D(Tt,-1,pr),D(kt,-1,q))):d?(x=p>=0||f>=0&&m>=0,x?(B(ot,q),B(Tt,q),B(kt,pr)):(D(ot,-1,q),D(Tt,-1,q),D(kt,-1,fr))):(x=f>=0&&m>=0&&p>=0,x?(B(ot,q),B(Tt,q),B(kt,q)):(D(ot,-1,q),D(Tt,-1,pr),D(kt,-1,fr))):c?_?(x=f>=0||m>=0,x?(B(ot,q),B(Tt,fr),D(kt,-1,q)):(D(ot,-1,q),B(Tt,q),D(kt,-1,q))):(x=f>=0&&m>=0,x?(B(ot,q),B(Tt,q),D(kt,-1,q)):(D(ot,-1,q),B(Tt,q),D(kt,-1,fr))):h?d?(x=m>=0||p>=0,x?(B(ot,q),D(Tt,-1,q),B(kt,pr)):(D(ot,-1,q),D(Tt,-1,q),B(kt,q))):(x=m>=0&&p>=0,x?(B(ot,q),D(Tt,-1,q),B(kt,q)):(D(ot,-1,q),D(Tt,-1,pr),B(kt,q))):(x=m>=0,x?(B(ot,q),D(Tt,-1,q),D(kt,-1,q)):(D(ot,-1,q),B(Tt,q),B(kt,q))),zt.count=i.m_count;for(var v=0;v<i.m_count;++v)U(zt.vertices[v],mo,i.m_vertices[v]),qe(zt.normals[v],mo.q,i.m_normals[v]);var y=i.m_radius+t.m_radius;e.pointCount=0;{mr.type=Fe.e_edgeA,mr.index=x?0:1,mr.separation=1/0;for(var v=0;v<zt.count;++v){var g=zt.vertices[v],A=V(ot,g)-V(ot,s);A<mr.separation&&(mr.separation=A)}}if(mr.type!=Fe.e_unknown&&!(mr.separation>y)){{te.type=Fe.e_unknown,te.index=-1,te.separation=-1/0,Ot(cf,-ot.y,ot.x);for(var v=0;v<zt.count;++v){D(Yr,-1,zt.normals[v]);var w=V(Yr,zt.vertices[v])-V(Yr,s),C=V(Yr,zt.vertices[v])-V(Yr,a),A=P0(w,C);if(A>y){te.type=Fe.e_edgeB,te.index=v,te.separation=A;break}if(V(Yr,cf)>=0){if(V(Yr,ot)-V(kt,ot)<-z.angularSlop)continue}else if(V(Yr,ot)-V(Tt,ot)<-z.angularSlop)continue;A>te.separation&&(te.type=Fe.e_edgeB,te.index=v,te.separation=A)}}if(!(te.type!=Fe.e_unknown&&te.separation>y)){var S=.98,P=.001,F;if(te.type==Fe.e_unknown?F=mr:te.separation>S*mr.separation+P?F=te:F=mr,Qe[0].recycle(),Qe[1].recycle(),F.type==Fe.e_edgeA){e.type=yt.e_faceA;for(var I=0,O=V(ot,zt.normals[0]),v=1;v<zt.count;++v){var X=V(ot,zt.normals[v]);X<O&&(O=X,I=v)}var Q=I,K=Q+1<zt.count?Q+1:0;B(Qe[0].v,zt.vertices[Q]),Qe[0].id.setFeatures(0,Z.e_face,Q,Z.e_vertex),B(Qe[1].v,zt.vertices[K]),Qe[1].id.setFeatures(0,Z.e_face,K,Z.e_vertex),x?(j.i1=0,j.i2=1,B(j.v1,s),B(j.v2,a),B(j.normal,q)):(j.i1=1,j.i2=0,B(j.v1,a),B(j.v2,s),D(j.normal,-1,q))}else e.type=yt.e_faceB,B(Qe[0].v,s),Qe[0].id.setFeatures(0,Z.e_vertex,F.index,Z.e_face),B(Qe[1].v,a),Qe[1].id.setFeatures(0,Z.e_vertex,F.index,Z.e_face),j.i1=F.index,j.i2=j.i1+1<zt.count?j.i1+1:0,B(j.v1,zt.vertices[j.i1]),B(j.v2,zt.vertices[j.i2]),B(j.normal,zt.normals[j.i1]);Ot(j.sideNormal1,j.normal.y,-j.normal.x),Ot(j.sideNormal2,-j.sideNormal1.x,-j.sideNormal1.y),j.sideOffset1=V(j.sideNormal1,j.v1),j.sideOffset2=V(j.sideNormal2,j.v2),js[0].recycle(),js[1].recycle(),Hr[0].recycle(),Hr[1].recycle();var Nt=Xo(js,Qe,j.sideNormal1,j.sideOffset1,j.i1);if(!(Nt<z.maxManifoldPoints)){var ht=Xo(Hr,js,j.sideNormal2,j.sideOffset2,j.i2);if(!(ht<z.maxManifoldPoints)){F.type==Fe.e_edgeA?(B(e.localNormal,j.normal),B(e.localPoint,j.v1)):(B(e.localNormal,i.m_normals[j.i1]),B(e.localPoint,i.m_vertices[j.i1]));for(var At=0,v=0;v<z.maxManifoldPoints;++v){var k=V(j.normal,Hr[v].v)-V(j.normal,j.v1);if(k<=y){var N=e.points[At];F.type==Fe.e_edgeA?(Fc(N.localPoint,mo,Hr[v].v),N.id.set(Hr[v].id)):(B(N.localPoint,Hr[v].v),N.id.set(Hr[v].id),N.id.swapFeatures()),++At}}e.pointCount=At}}}}};(function(){function e(t,r){this._refMap={},this._map={},this._xmap={},this._data=[],this._entered=[],this._exited=[],this._key=t,this._listener=r}return e.prototype.update=function(t){if(!Array.isArray(t))throw"Invalid data: "+t;this._entered.length=0,this._exited.length=0,this._data.length=t.length;for(var r=0;r<t.length;r++)if(!(typeof t[r]!="object"||t[r]===null)){var i=t[r],n=this._key(i);this._map[n]?delete this._map[n]:this._entered.push(i),this._data[r]=i,this._xmap[n]=i}for(var n in this._map)this._exited.push(this._map[n]),delete this._map[n];var o=this._map;this._map=this._xmap,this._xmap=o;for(var r=0;r<this._exited.length;r++){var i=this._exited[r],s=this._key(i),a=this._refMap[s];this._listener.exit(i,a),delete this._refMap[s]}for(var r=0;r<this._entered.length;r++){var i=this._entered[r],s=this._key(i),a=this._listener.enter(i);a&&(this._refMap[s]=a)}for(var r=0;r<this._data.length;r++)if(!(typeof t[r]!="object"||t[r]===null)){var i=this._data[r],s=this._key(i),a=this._refMap[s];this._listener.update(i,a)}this._entered.length=0,this._exited.length=0,this._data.length=0},e.prototype.ref=function(t){return this._refMap[this._key(t)]},e})();class k0 extends Ry{aabbCast(t,r,i,n){const o=new Map,s=1e-5,a=new u(t.x-s,t.y-s),l=new u(t.x+s,t.y+s),c=new Rt(a,l);return this.world.queryAABB(c,h=>(h.testPoint(t)&&this.handleRayHit(h,new u(t.x,t.y),new u(0,0),0,r,i,n,o),!0)),Array.from(o.entries()).sort((h,m)=>h[1]-m[1]).map(([h])=>h)}rayCast(t,r,i,n,o){const s=new Map,a=new u(t.x,t.y),l=new u(r.x,r.y);return this.world.rayCast(a,l,(c,h,m,f)=>this.handleRayHit(c,h,m,f,i,n,o,s)),Array.from(s.entries()).sort((c,h)=>c[1]-h[1]).map(([c])=>c)}handleRayHit(t,r,i,n,o,s,a,l){const c=t.getBody(),h=c.getUserData(),m=h==null?void 0:h.actor;if(!m)return 1;const f=c.getType();if(f==="static"&&!o||(f==="dynamic"||f==="kinematic")&&!s)return 1;if(m instanceof a){const p=m,_=l.get(p);(_===void 0||n<_)&&l.set(p,n)}return 1}radialCast(t,r,i,n,o){const s=new Map,a=16,l=Math.PI*2/a,c=new u(t.x,t.y);for(let h=0;h<a;h++){const m=l*h,f=t.x+Math.cos(m)*r,p=t.y+Math.sin(m)*r,_=new u(f,p);this.world.rayCast(c,_,(d,x,v,y)=>this.handleRayHit(d,x,v,y,i,n,o,s))}return Array.from(s.entries()).sort((h,m)=>h[1]-m[1]).map(([h])=>h)}checkWorldBounds(t,r){const i=t.getComponentsOfType(Yo);if(i.length===0)return!0;const n=t.getPosition();for(const o of i){const s=o.getBounds(),a=s.min.x+n.x,l=s.min.y+n.y,c=s.max.x+n.x,h=s.max.y+n.y;if(this.boundsOverlapFrustum(a,l,c,h,r))return!0}return!1}boundsOverlapFrustum(t,r,i,n,o){return!(i<o.left||t>o.right||n<o.bottom||r>o.top)}checkWithinBounds(t,r){return this.checkWorldBounds(t,r)}createPhysicsBody(t){const r=new I0(this,t,this.world);for(const i of t.getComponentsOfType(Yo))r.createBoundingVolume(i);return r}getGravity(){const t=this.world.getGravity();return new H(t.x,t.y)}setGravity(t){this.world.setGravity(new u(t.x,t.y))}_tick(t){this.world.step(t);let r=this.world.getBodyList();for(;r;){const i=r.getUserData().actor;i&&(i.setPosition(new H(r.getPosition().x,r.getPosition().y)),i.setRotation(r.getAngle())),r=r.getNext()}}constructor(t){super(t),this.world=new es({gravity:t!=null&&t.gravity?new u(t.gravity.x,t.gravity.y):new u(0,0),allowSleep:(t==null?void 0:t.allowSleep)??!0})}}class I0 extends Jy{constructor(t,r,i){super(t,r),this.actor=r,this.bodyType="dynamic",this.boundingVolumes=[],this.body=i.createBody({userData:{actor:this.actor},type:r.getBodyType(),awake:!0}),this.body.setPosition(new u(r.getPosition().x,r.getPosition().y)),this.body.setActive(r.getIsPhysicsSimulated())}setBodyType(t){this.bodyType=t,this.body.setType(t)}setIsActive(t){this.body.setActive(t)}createBoundingVolume(t){const r=new z0(this.body,t);this.boundingVolumes.push(r)}destroyBoundingVolume(){for(const t of this.boundingVolumes)this.body.destroyFixture(t.fixture)}getBoundingVolumes(){return this.boundingVolumes}}class z0 extends Xy{constructor(t,r){super(),this.body=t,this.localVertices=[],this.localOffset=new u(0,0),this.radius=null,this.descriptor=r.createShapeDescriptor();const i=this.createShape(this.descriptor);this.localVertices=i.localVertices,this.localOffset=i.localOffset,this.radius=i.radius,this.fixture=this.body.createFixture({shape:i.shape,density:this.descriptor.density,friction:this.descriptor.friction,restitution:this.descriptor.restitution,isSensor:this.descriptor.isSensor,userData:r}),r.clearDirty()}getType(){return this.descriptor.type}getWorldVertices(){return this.descriptor.type==="circle"?this.sampleCircleVertices():this.localVertices.map(t=>{const r=this.body.getWorldPoint(t);return new H(r.x,r.y)})}createShape(t){return t.type==="circle"?this.createCircleShape(t):this.createPolygonShape(t)}createCircleShape(t){const r=new u(t.offset.x,t.offset.y);return{shape:new pi(r,t.radius),localVertices:[],localOffset:r,radius:t.radius}}createPolygonShape(t){const r=t.vertices.map(n=>new u(n.x+t.offset.x,n.y+t.offset.y));return{shape:new Dr(r),localVertices:r,localOffset:new u(t.offset.x,t.offset.y),radius:null}}sampleCircleVertices(){if(this.radius===null)return[];const t=16,r=[],i=this.body.getWorldPoint(this.localOffset),n=Math.PI*2/t;for(let o=0;o<t;o++){const s=n*o,a=i.x+Math.cos(s)*this.radius,l=i.y+Math.sin(s)*this.radius;r.push(new H(a,l))}return r}}var L0=Object.getOwnPropertyDescriptor,nd=(e,t,r,i)=>{for(var n=i>1?void 0:i?L0(t,r):t,o=e.length-1,s;o>=0;o--)(s=e[o])&&(n=s(n)||n);return n};let hf=class extends at{tick(e){}constructor(e){super(e),this.shouldTick=!0,this.bodyType="dynamic",this.components=[],this.components.push(new zc([{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}]))}};hf=nd([yi()],hf);let Fi=class extends at{constructor(e){super(e),this.shouldTick=!0,this.bodyType="dynamic",this.components=[],this.components.push(new Dy(1))}tick(e){}};Fi=nd([yi()],Fi);class F0{constructor(t,r,i,n,o,s){this.near=t,this.far=r,this.left=i,this.right=n,this.top=o,this.bottom=s}containsBounds(t){return t.min.x>=this.left&&t.min.y>=this.bottom&&t.max.x<=this.right&&t.max.y<=this.top}}class E0{}class Ia extends E0{constructor(r=new H(0,0),i=1,n=10){super();L(this,"position");L(this,"zoom");L(this,"unitsPerScreenHeight");L(this,"viewMatrix",new ri);L(this,"projectionMatrix",new ri);L(this,"viewProjectionMatrix",new ri);L(this,"needsUpdate",!0);L(this,"lastAspectRatio",0);L(this,"frustum");this.position=r.clone(),this.zoom=em.clamp(i,.5,10),this.unitsPerScreenHeight=n}getPosition(){return this.position.clone()}getZoom(){return this.zoom}setPosition(r){this.position.equals(r)||(this.position.copy(r),this.needsUpdate=!0)}setZoom(r){const i=em.clamp(r,1,10);this.zoom!==i&&(this.zoom=i,this.needsUpdate=!0)}getViewMatrix(){return this.needsUpdate&&this.updateMatrices(this.lastAspectRatio),this.viewMatrix}getProjectionMatrix(r){return(this.needsUpdate||this.lastAspectRatio!==r)&&this.updateMatrices(r),this.projectionMatrix}getViewProjectionMatrix(r){return(this.needsUpdate||this.lastAspectRatio!==r)&&this.updateMatrices(r),this.viewProjectionMatrix}update(r){}getFrustum(){if(this.frustum){const r=this.lastAspectRatio,i=this.unitsPerScreenHeight/this.zoom,o=i*r/2,s=i/2;this.frustum.left=this.position.x-o,this.frustum.right=this.position.x+o,this.frustum.top=this.position.y+s,this.frustum.bottom=this.position.y-s}else{const r=this.lastAspectRatio,i=this.unitsPerScreenHeight/this.zoom,o=i*r/2,s=i/2;this.frustum=new F0(0,1e3,this.position.x-o,this.position.x+o,this.position.y+s,this.position.y-s)}return this.frustum}updateMatrices(r){r===0&&(r=1);const i=this.unitsPerScreenHeight/this.zoom,o=i*r/2,s=i/2;this.viewMatrix.identity(),this.viewMatrix.translate(new H(-this.position.x,-this.position.y));const a=-o,l=o,c=-s,h=s,m=this.projectionMatrix.elements,f=1/(l-a),p=1/(h-c);m[0]=2*f,m[3]=0,m[6]=-(l+a)*f,m[1]=0,m[4]=2*p,m[7]=-(h+c)*p,m[2]=0,m[5]=0,m[8]=1,this.viewProjectionMatrix=this.projectionMatrix.clone().multiply(this.viewMatrix),this.needsUpdate=!1,this.lastAspectRatio=r}screenToWorld(r,i,n){const o=i/n,s=r.x/i*2-1,a=1-r.y/n*2,l=this.unitsPerScreenHeight/this.zoom,c=l*o,h=s*(c/2),m=a*(l/2);return new H(this.position.x+h,this.position.y+m)}worldToScreen(r,i,n){const o=i/n,s=this.unitsPerScreenHeight/this.zoom,a=s*o,l=r.x-this.position.x,c=r.y-this.position.y,h=l/(a/2),m=c/(s/2),f=(h+1)/2*i,p=(1-m)/2*n;return new H(f,p)}getBounds(r,i){const n=r/i,o=this.unitsPerScreenHeight/this.zoom,a=o*n/2,l=o/2;return{min:new H(this.position.x-a,this.position.y-l),max:new H(this.position.x+a,this.position.y+l)}}clone(){return new Ia(this.position.clone(),this.zoom,this.unitsPerScreenHeight)}copyFrom(r){this.setPosition(r.getPosition()),this.setZoom(r.getZoom())}lerpTo(r,i){const n=r.getPosition(),o=r.getZoom();this.position.x+=(n.x-this.position.x)*i,this.position.y+=(n.y-this.position.y)*i,this.setZoom(this.zoom+(o-this.zoom)*i)}equals(r){return this.position.equals(r.getPosition())&&this.zoom===r.getZoom()}toString(){return`OrthoCamera(Position: ${this.position.toString()}, Zoom: ${this.zoom}, UnitsPerScreen: ${this.unitsPerScreenHeight})`}}const N0="modulepreload",R0=function(e){return"/nostalgi2dts-client/"+e},mf={},Hs=function(t,r,i){let n=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),a=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));n=Promise.allSettled(r.map(l=>{if(l=R0(l),l in mf)return;mf[l]=!0;const c=l.endsWith(".css"),h=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const m=document.createElement("link");if(m.rel=c?"stylesheet":N0,c||(m.as="script"),m.crossOrigin="",m.href=l,a&&m.setAttribute("nonce",a),document.head.appendChild(m),c)return new Promise((f,p)=>{m.addEventListener("load",f),m.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function o(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return n.then(s=>{for(const a of s||[])a.status==="rejected"&&o(a.reason);return t().catch(o)})};class Uc{constructor(t=()=>{if(typeof DOMParser>"u")throw new Error("DOMParser is not available in the current environment");return new DOMParser}){this.domParserFactory=t}async parse(t){if(!t)throw new Error("A TMX url must be provided to the parser");const r=await this.loadSource(t),o=this.domParserFactory().parseFromString(r,"application/xml").querySelector("map");if(!o)throw new Error("The provided TMX file does not contain a <map> element");const s=this.parseTilesets(o),a=this.parseTileLayers(o),l=this.parseObjectLayers(o),c=this.parseProperties(o.querySelector("properties")),h=this.getIntAttribute(o,"width"),m=this.getIntAttribute(o,"height"),f=this.getIntAttribute(o,"tilewidth"),p=this.getIntAttribute(o,"tileheight"),_=o.getAttribute("orientation")||"orthogonal";return{width:h,height:m,tileWidth:f,tileHeight:p,orientation:_,renderOrder:o.getAttribute("renderorder")||void 0,nextLayerId:this.getOptionalIntAttribute(o,"nextlayerid"),nextObjectId:this.getOptionalIntAttribute(o,"nextobjectid"),properties:c,tileLayers:a,objectLayers:l,tilesets:s}}async loadSource(t){return z_.isValidUrl(t)?this.fetchText(t):t.startsWith("file://")?this.readFileFromUrl(t):typeof window<"u"?this.fetchText(t):this.readFileFromDisk(t)}async fetchText(t){const r=await fetch(t);if(!r.ok)throw new Error(`Failed to fetch TMX map from ${t}: ${r.status} ${r.statusText}`);return r.text()}async readFileFromUrl(t){const r=await Hs(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),i=await Hs(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),n=r.fileURLToPath(t);return i.readFile(n,"utf-8")}async readFileFromDisk(t){const r=await Hs(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),i=await Hs(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),n=i.isAbsolute(t)?t:i.resolve(process.cwd(),t);return r.readFile(n,"utf-8")}parseTilesets(t){return Array.from(t.querySelectorAll("tileset")).map(i=>{const n=i.querySelector("image");return{firstGid:this.getIntAttribute(i,"firstgid"),name:i.getAttribute("name")||"",tileWidth:this.getIntAttribute(i,"tilewidth"),tileHeight:this.getIntAttribute(i,"tileheight"),tileCount:this.getIntAttribute(i,"tilecount"),columns:this.getIntAttribute(i,"columns"),image:n?{source:n.getAttribute("source")||"",width:this.getIntAttribute(n,"width"),height:this.getIntAttribute(n,"height"),transparentColor:n.getAttribute("trans")||void 0}:void 0}})}parseTileLayers(t){return Array.from(t.querySelectorAll("layer")).map(i=>{const n=i.querySelector("data"),o=n?this.parseLayerData(n):[];return{id:this.getIntAttribute(i,"id",this.getOptionalIntAttribute(i,"id")??0),name:i.getAttribute("name")||"Unnamed Layer",width:this.getIntAttribute(i,"width"),height:this.getIntAttribute(i,"height"),opacity:this.getOptionalFloatAttribute(i,"opacity",1),visible:this.getOptionalBoolAttribute(i,"visible",!0),offsetX:this.getOptionalFloatAttribute(i,"offsetx",0),offsetY:this.getOptionalFloatAttribute(i,"offsety",0),data:o}})}parseLayerData(t){const r=t.getAttribute("encoding");if(r&&r!=="csv")throw new Error(`Unsupported TMX layer encoding: ${r}. Only CSV encoding is currently supported.`);const i=(t.textContent||"").trim();return i?i.split(/\s*,\s*/).map(n=>n.length>0?Number.parseInt(n,10):0).filter(n=>Number.isFinite(n)):[]}parseObjectLayers(t){return Array.from(t.querySelectorAll("objectgroup")).map(i=>{const n=this.parseProperties(i.querySelector("properties")),o=this.parseObjects(i.querySelectorAll("object"));return{id:this.getOptionalIntAttribute(i,"id")??0,name:i.getAttribute("name")||"Unnamed Object Layer",color:i.getAttribute("color"),opacity:this.getOptionalFloatAttribute(i,"opacity",1),visible:this.getOptionalBoolAttribute(i,"visible",!0),offsetX:this.getOptionalFloatAttribute(i,"offsetx",0),offsetY:this.getOptionalFloatAttribute(i,"offsety",0),drawOrder:i.getAttribute("draworder"),properties:n,objects:o}})}parseObjects(t){return Array.from(t).map(r=>{const i=this.parseProperties(r.querySelector("properties")),n=this.parsePoints(r.querySelector("polygon")),o=this.parsePoints(r.querySelector("polyline")),s=!!r.querySelector("ellipse"),a=r.querySelector("text"),l=r.getAttribute("gid");return{id:this.getOptionalIntAttribute(r,"id")??0,name:r.getAttribute("name"),type:r.getAttribute("type"),x:this.getOptionalFloatAttribute(r,"x",0),y:this.getOptionalFloatAttribute(r,"y",0),width:this.getOptionalFloatAttribute(r,"width",0),height:this.getOptionalFloatAttribute(r,"height",0),rotation:this.getOptionalFloatAttribute(r,"rotation",0),visible:this.getOptionalBoolAttribute(r,"visible",!0),gid:l?Number.parseInt(l,10):void 0,properties:i,polygon:n,polyline:o,ellipse:s,text:(a==null?void 0:a.textContent)||null}})}parsePoints(t){if(!t)return;const r=t.getAttribute("points");if(r)return r.trim().split(/\s+/).map(i=>{const[n,o]=i.split(",");return{x:Number.parseFloat(n),y:Number.parseFloat(o)}}).filter(i=>Number.isFinite(i.x)&&Number.isFinite(i.y))}parseProperties(t){var n;if(!t)return{};const r={},i=Array.from(t.querySelectorAll("property"));for(const o of i){const s=o.getAttribute("name");if(!s)continue;const a=o.getAttribute("type")||void 0;let l;o.hasAttribute("value")?l=this.parsePropertyValue(o.getAttribute("value")||"",a):l=this.parsePropertyValue(((n=o.textContent)==null?void 0:n.trim())??"",a),r[s]=l}return r}parsePropertyValue(t,r){switch(r){case"int":return Number.parseInt(t,10);case"float":return Number.parseFloat(t);case"bool":return t.toLowerCase()==="true"||t==="1";case"color":case"file":case"string":case void 0:return t;default:return t}}getIntAttribute(t,r,i){const n=t.getAttribute(r);if(n==null||n===""){if(i!==void 0)return i;throw new Error(`Required TMX attribute '${r}' is missing`)}return Number.parseInt(n,10)}getOptionalIntAttribute(t,r,i){const n=t.getAttribute(r);if(n==null||n==="")return i;const o=Number.parseInt(n,10);return Number.isNaN(o)?i:o}getOptionalFloatAttribute(t,r,i){const n=t.getAttribute(r);if(n==null||n==="")return i;const o=Number.parseFloat(n);return Number.isNaN(o)?i:o}getOptionalBoolAttribute(t,r,i){const n=t.getAttribute(r);return n==null||n===""?i:n==="1"||n.toLowerCase()==="true"}}var D0=Object.getOwnPropertyDescriptor,Qa=(e,t,r,i)=>{for(var n=i>1?void 0:i?D0(t,r):t,o=e.length-1,s;o>=0;o--)(s=e[o])&&(n=s(n)||n);return n};let Fu=class extends at{constructor(e,t,r){super(e),this.objectData=t,this.layerName=r,this.shouldTick=!1}};Fu=Qa([yi()],Fu);let ff=class extends at{constructor(e){super(e),this.shouldTick=!0}};ff=Qa([yi()],ff);let pf=class extends at{constructor(t,r,i,n){super(t),this.layerName=i,this.objectData=n,this.shouldTick=!1,this.components=[],this.setIsPhysicsSimulated(!0,"static"),this.collisionComponent=new zc(r),this.components.push(this.collisionComponent)}getCollisionComponent(){return this.collisionComponent}};pf=Qa([yi()],pf);let za=class extends at{constructor(e,t,r=new Uc,i={}){super(e),this.mapUrl=t,this.parser=r,this.mapData=null,this.objectActorsCreated=!1,this.worldUnitsPerPixel=null,this.mapWorldSize=null,this.renderTranslation=new H(0,0),this.shouldTick=!1,this.options=i,this.normalizedMapUrl=this.mapUrl.replace(/\\/g,"/"),this.basePath=this.computeBasePath(this.normalizedMapUrl),this.isRemote=this.isAbsoluteUrl(this.mapUrl)}async onLoad(){console.log("Loading tile map from URL:",this.mapUrl),!this.mapData&&(this.mapData=await this.parser.parse(this.mapUrl),console.log("Loaded map data:",this.mapData),this.worldUnitsPerPixel=this.computeWorldUnitsPerPixel(),this.updateWorldSize(),(this.options.spawnObjects??!0)&&this.createObjectActors())}getMap(){return this.mapData}getMapUrl(){return this.mapUrl}getWorldUnitsPerPixel(){return this.worldUnitsPerPixel!==null?this.worldUnitsPerPixel:1}getWorldSize(){return this.mapWorldSize?this.mapWorldSize.clone():null}getWorldCenter(){return this.mapWorldSize?new H(this.mapWorldSize.x/2,-(this.mapWorldSize.y/2)):new H(0,0)}getRenderTranslation(){return this.renderTranslation.clone()}getWorldBounds(){if(!this.mapWorldSize)return null;const e=this.getPosition(),t=new H(e.x+this.renderTranslation.x,e.y+this.renderTranslation.y),r=new H(t.x,t.y-this.mapWorldSize.y),i=new H(t.x+this.mapWorldSize.x,t.y);return{min:r,max:i}}computeWorldUnitsPerPixel(){if(!this.mapData)return 1;if(this.options.worldUnitsPerPixel!==void 0)return this.options.worldUnitsPerPixel;if(this.options.worldUnitsPerTile!==void 0){const t=this.mapData.tileWidth||1;return this.options.worldUnitsPerTile/t}return 1/(this.mapData.tileWidth||1)}resolveResourcePath(e){if(!e||/^(?:[a-z]+:)?\/\//i.test(e))return e;if(e.startsWith("/")){if(this.isRemote)try{return new URL(e,this.mapUrl).toString()}catch{return e}return e}if(this.isRemote)try{return new URL(e,this.mapUrl).toString()}catch{return`${this.basePath}${e}`}return this.basePath?`${this.basePath}${e}`:e}tick(){}computeBasePath(e){const t=e.lastIndexOf("/");return t===-1?"":e.substring(0,t+1)}isAbsoluteUrl(e){try{const t=new URL(e);return t.protocol==="http:"||t.protocol==="https:"}catch{return!1}}updateWorldSize(){if(!this.mapData){this.mapWorldSize=null,this.renderTranslation=new H(0,0);return}const e=this.getWorldUnitsPerPixel(),t=this.mapData.width*this.mapData.tileWidth*e,r=this.mapData.height*this.mapData.tileHeight*e;this.mapWorldSize=new H(t,r),this.renderTranslation=new H(-t/2,r/2)}createObjectActors(){if(!(!this.mapData||this.objectActorsCreated)){for(const e of this.mapData.objectLayers)this.handleLayer(e)||this.handleLayerInternal(e);this.objectActorsCreated=!0}}handleLayer(e){return!1}handleLayerInternal(e){if(!e.visible||e.objects.length===0)return;console.log("Creating actors for layer:",e.name);const t=new Set(this.getChildren().map(i=>i.name)),r=this.getWorldUnitsPerPixel();e.objects.forEach((i,n)=>{var m,f,p,_;const o=this.getObjectBaseName(e,i,n),s=this.makeUniqueName(o,t);let a=[];try{if(i.properties.Type){const d=Wy(i.properties.Type,s),x=(f=(m=this.options).objectActorFactory)==null?void 0:f.call(m,{tileMap:this,layer:e,object:i,index:n,defaultActor:d});a=this.normalizeFactoryResult(x,d)}else{const d=new Fu(s,i,e.name),x=(_=(p=this.options).objectActorFactory)==null?void 0:_.call(p,{tileMap:this,layer:e,object:i,index:n,defaultActor:d});a=this.normalizeFactoryResult(x,d)}}catch(d){console.error(`Error creating actor for object '${s}' of type '${i.properties.Type}':`,d);return}if(a.length===0)return;const l=(i.x+(e.offsetX??0))*r,c=-((i.y+(e.offsetY??0))*r),h=i.rotation*(Math.PI/180);a.forEach(d=>{if(!d.name||t.has(d.name)){const y=d.name&&d.name.trim().length>0?d.name.trim():`${e.name}_object`;d.name=this.makeUniqueName(y,t)}t.add(d.name);const x=l+this.renderTranslation.x,v=c+this.renderTranslation.y;d.setPosition(new H(x,v)),d.setRotation(h),this.addChild(d)})})}normalizeFactoryResult(e,t){return e===void 0?[t]:e===null?[]:Array.isArray(e)?e.filter(r=>r instanceof at):[e]}getObjectBaseName(e,t,r){return t.name&&t.name.trim().length>0?t.name.trim():t.type&&t.type.trim().length>0?`${e.name}_${t.type.trim()}`:`${e.name}_object_${t.id||r}`}makeUniqueName(e,t){let r=e,i=1;for(;t.has(r);)r=`${e}_${i++}`;return r}};za=Qa([yi()],za);var O0=Object.getOwnPropertyDescriptor,q0=(e,t,r,i)=>{for(var n=i>1?void 0:i?O0(t,r):t,o=e.length-1,s;o>=0;o--)(s=e[o])&&(n=s(n)||n);return n};let _f=class extends N_{constructor(){super(...arguments),this.program=null,this.uniformLocations={viewProj:null,translation:null,opacity:null,texture:null},this.caches=new WeakMap,this.textureCache=new WeakMap,this.loggedDiagonalWarning=!1}render(e,t,r){const i=e.getMap();if(!i)return;this.ensureProgram(r);const n=this.ensureCache(r,e,i);if(!n)return;r.useProgram(this.program);const o=r.canvas.width/r.canvas.height,s=t.getViewProjectionMatrix(o).elements;this.uniformLocations.viewProj&&r.uniformMatrix3fv(this.uniformLocations.viewProj,!1,s);const l=e.getPosition().add(e.getRenderTranslation());this.uniformLocations.translation&&r.uniform2f(this.uniformLocations.translation,l.x,l.y),this.uniformLocations.texture&&r.uniform1i(this.uniformLocations.texture,0),r.enable(r.BLEND),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA);const c=n.drawCalls.slice().sort((h,m)=>h.layerIndex-m.layerIndex);for(const h of c){const m=this.getTexture(r,h.textureKey);m&&(this.uniformLocations.opacity&&r.uniform1f(this.uniformLocations.opacity,h.opacity),h.vao?r.bindVertexArray(h.vao):(r.bindBuffer(r.ARRAY_BUFFER,h.vertexBuffer),r.enableVertexAttribArray(0),r.vertexAttribPointer(0,2,r.FLOAT,!1,16,0),r.enableVertexAttribArray(1),r.vertexAttribPointer(1,2,r.FLOAT,!1,16,8),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,h.indexBuffer)),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,m),r.drawElements(r.TRIANGLES,h.indexCount,r.UNSIGNED_SHORT,0))}r.bindVertexArray(null)}ensureProgram(e){if(this.program)return;const t=`#version 300 es
            precision highp float;
            layout(location=0) in vec2 a_position;
            layout(location=1) in vec2 a_uv;
            uniform mat3 u_viewProjection;
            uniform vec2 u_translation;
            out vec2 v_uv;
            void main() {
                vec2 worldPos = a_position + u_translation;
                vec3 clip = u_viewProjection * vec3(worldPos, 1.0);
                gl_Position = vec4(clip.xy, 0.0, 1.0);
                v_uv = a_uv;
            }`,r=`#version 300 es
            precision highp float;
            in vec2 v_uv;
            uniform sampler2D u_texture;
            uniform float u_opacity;
            out vec4 outColor;
            void main() {
                vec4 tex = texture(u_texture, v_uv);
                if (tex.a == 0.0) {
                    discard;
                }
                outColor = vec4(tex.rgb, tex.a * u_opacity);
            }`,i=this.compileShader(e,e.VERTEX_SHADER,t),n=this.compileShader(e,e.FRAGMENT_SHADER,r),o=e.createProgram();if(!o)throw new Error("Failed to create tile map shader program");if(e.attachShader(o,i),e.attachShader(o,n),e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS)){const s=e.getProgramInfoLog(o);throw e.deleteProgram(o),e.deleteShader(i),e.deleteShader(n),new Error(`Failed to link tile map shader program: ${s??"unknown error"}`)}e.deleteShader(i),e.deleteShader(n),this.program=o,this.uniformLocations.viewProj=e.getUniformLocation(o,"u_viewProjection"),this.uniformLocations.translation=e.getUniformLocation(o,"u_translation"),this.uniformLocations.opacity=e.getUniformLocation(o,"u_opacity"),this.uniformLocations.texture=e.getUniformLocation(o,"u_texture")}compileShader(e,t,r){const i=e.createShader(t);if(!i)throw new Error("Failed to create shader");if(e.shaderSource(i,r),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS)){const n=e.getShaderInfoLog(i);throw e.deleteShader(i),new Error(`Failed to compile shader: ${n??"unknown error"}`)}return i}ensureCache(e,t,r){let i=this.caches.get(t);const n=t.getWorldUnitsPerPixel();return i||(i={drawCalls:[],map:null,scale:n},this.caches.set(t,i)),(i.map!==r||i.scale!==n)&&(this.buildCache(e,t,r,i,n),i.map=r,i.scale=n),i}buildCache(e,t,r,i,n){this.disposeCache(e,i);const o=r.tileWidth*n,s=r.tileHeight*n;for(let a=0;a<r.tileLayers.length;a++){const l=r.tileLayers[a];if(!l.visible||!l.data.length)continue;const c=[],h=new Map;for(let m=0;m<l.data.length;m++){const f=l.data[m];if(!f)continue;const p=this.decodeGid(f);if(p.gid===0)continue;if(p.flipDiag){this.loggedDiagonalWarning||(console.warn("TileMapActorRenderer: Diagonal tile flips are not currently supported."),this.loggedDiagonalWarning=!0);continue}const _=this.findTileset(r.tilesets,p.gid);if(!_||!_.image)continue;let d=h.get(_.firstGid);d||(d={tileset:_,textureKey:t.resolveResourcePath(_.image.source),vertices:[],indices:[]},h.set(_.firstGid,d),c.push(d));const x=p.gid-_.firstGid,v=x%_.columns,y=Math.floor(x/_.columns),g=_.image.width||_.tileWidth*_.columns,A=_.image.height||_.tileHeight*Math.ceil(_.tileCount/_.columns);let w=v*_.tileWidth/g,C=y*_.tileHeight/A,S=(v+1)*_.tileWidth/g,P=(y+1)*_.tileHeight/A;p.flipH&&([w,S]=[S,w]),p.flipV&&([C,P]=[P,C]);const F=m%l.width,I=Math.floor(m/l.width),O=(l.offsetX??0)*n,X=(l.offsetY??0)*n,Q=F*o+O,K=-(I*s+X),Nt=Q+o,ht=K-s,At=d.vertices.length/4;d.vertices.push(Q,K,w,C,Nt,K,S,C,Nt,ht,S,P,Q,ht,w,P),d.indices.push(At,At+1,At+2,At,At+2,At+3)}for(const m of c){if(!m.indices.length)continue;if(m.vertices.length/4>65535){console.warn("TileMapActorRenderer: Layer has more than 65k vertices; skipping draw call.");continue}const f=e.createBuffer(),p=e.createBuffer();if(!f||!p)continue;e.bindBuffer(e.ARRAY_BUFFER,f),e.bufferData(e.ARRAY_BUFFER,new Float32Array(m.vertices),e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,p),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(m.indices),e.STATIC_DRAW);const _=e.createVertexArray();_&&(e.bindVertexArray(_),e.bindBuffer(e.ARRAY_BUFFER,f),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,2,e.FLOAT,!1,16,0),e.enableVertexAttribArray(1),e.vertexAttribPointer(1,2,e.FLOAT,!1,16,8),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,p),e.bindVertexArray(null)),i.drawCalls.push({vao:_,vertexBuffer:f,indexBuffer:p,indexCount:m.indices.length,textureKey:m.textureKey,opacity:l.opacity??1,layerIndex:a})}}}disposeCache(e,t){for(const r of t.drawCalls)r.vao&&e.deleteVertexArray(r.vao),r.vertexBuffer&&e.deleteBuffer(r.vertexBuffer),r.indexBuffer&&e.deleteBuffer(r.indexBuffer);t.drawCalls=[]}findTileset(e,t){let r;for(const i of e)t>=i.firstGid&&(!r||i.firstGid>r.firstGid)&&(r=i);return r}decodeGid(e){return{gid:e&536870911,flipH:(e&2147483648)!==0,flipV:(e&1073741824)!==0,flipDiag:(e&536870912)!==0}}getTexture(e,t){if(!t)return null;let r=this.textureCache.get(e);r||(r=new Map,this.textureCache.set(e,r));let i=r.get(t);return i!=null&&i.texture?i.texture:(i||(i={texture:null,promise:null},r.set(t,i)),i.promise||(i.promise=this.loadTexture(e,t).then(n=>{i.texture=n}).catch(n=>{console.error(`Failed to load tileset texture '${t}':`,n),r.delete(t)})),null)}async loadTexture(e,t){const r=await this.loadImage(t),i=e.createTexture();if(!i)throw new Error("Failed to create WebGL texture");return e.bindTexture(e.TEXTURE_2D,i),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r),i}loadImage(e){return new Promise((t,r)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>t(i),i.onerror=()=>r(new Error(`Failed to load image '${e}'`)),i.src=e})}};_f=q0([E_(za)],_f);var U0=Object.getOwnPropertyDescriptor,od=(e,t,r,i)=>{for(var n=i>1?void 0:i?U0(t,r):t,o=e.length-1,s;o>=0;o--)(s=e[o])&&(n=s(n)||n);return n};const $0=()=>{const e=Ae.useRef(null);Ae.useEffect(()=>{e.current=new WebSocket("ws://localhost:3001/?userId=world"),e.current.addEventListener("open",()=>{e.current&&(console.log("Sending data. We're open!"),e.current.send(JSON.stringify({userid:"world"})))}),e.current.addEventListener("message",n=>console.log("msg:",JSON.stringify(n.data)))},[]);const[t]=Ae.useState(new Yy(new k0({gravity:new H(0,-10),allowSleep:!0}),void 0,"client")),[r]=Ae.useState(new Qy);return Ae.useEffect(()=>{let n=!1;return(async()=>{const s=new Fi("DemoActor");s.addChild(new Fi("ChildActor1")),s.addChild(new Fi("ChildActor2"));const a=new Fi("DemoActor2");a.tickGroup="post-physics",a.setIsPhysicsSimulated(!0,"dynamic"),r.addActor(s),r.addActor(a);try{const l=await j0(r,"GrasslandsMap","/nostalgi2dts-client/grasslands.tmx");if(n)return;const c=l.getWorldCenter();if(l.setPosition(c),await t.loadLevelObject(r),r.getWorldSize()){const m=new Ia(c.clone(),1,40);t.setCurrentCamera(m)}else t.setCurrentCamera(new Ia(new H(0,0),1))}catch(l){console.error("Failed to initialize level",l)}})(),window.addEventListener("keydown",s=>{if(console.log("Key down:",s.key),s.key==="ArrowLeft"){const a=t.getCurrentCamera(),l=a==null?void 0:a.getPosition();l&&a.setPosition(new H(l.x-1,l.y))}else if(s.key==="ArrowRight"){const a=t.getCurrentCamera(),l=a==null?void 0:a.getPosition();l&&a.setPosition(new H(l.x+1,l.y))}else if(s.key==="ArrowUp"){const a=t.getCurrentCamera(),l=a==null?void 0:a.getPosition();l&&a.setPosition(new H(l.x,l.y+1))}else if(s.key==="ArrowDown"){const a=t.getCurrentCamera(),l=a==null?void 0:a.getPosition();l&&a.setPosition(new H(l.x,l.y-1))}}),()=>{n=!0}},[t,r]),Mf("div",{children:[tr(sg,{title:"Rendered Engine"}),tr("div",{className:"card",children:tr(Ny,{draw:n=>{t.tick(),n&&t.render(n),t.finishFrame()},options:{context:"webgl2"},onClick:n=>{const o=n.currentTarget,s=o.getBoundingClientRect(),a=o.width/s.width,l=o.height/s.height,c=(n.clientX-s.left)*a,h=(n.clientY-s.top)*l,m=t.getCurrentCamera();if(!m)return;const f=m.screenToWorld(new H(c,h),o.width,o.height),p=t.aabbCast(f,!0,!0,at);if(p.length>0){for(const _ of p)console.log(`Clicked actor: ${_.name}`),_.isMarkedForDespawn=!0;return}for(let _=0;_<1;_++){const d=new Fi("SpawnedActor-"+_+Date.now());d.setIsPhysicsSimulated(!0,"dynamic"),d.setPosition(f),t.spawnActor(d)}console.log(`Canvas clicked {${c.toFixed(2)}, ${h.toFixed(2)}} => World ${f.x.toFixed(2)}, ${f.y.toFixed(2)}`)}})}),tr(R_.Provider,{value:t,children:tr(ag,{})})]})};T_(document.getElementById("app")).render(tr($0,{}));async function j0(e,t,r,i=new Uc,n={}){const o=new Eu(t,r,i,n);return e.addActor(o),o}let Eu=class extends za{constructor(e,t,r=new Uc,i={}){super(e,t,r,i)}handleLayer(e){var n,o;const t=((o=(n=e.name)==null?void 0:n.toLowerCase)==null?void 0:o.call(n))??"",r=e.properties?e.properties.Type:void 0;console.log(t,r);const i=typeof r=="string"?r.toLowerCase():"";return(t.includes("wall")||i==="walls")&&(console.log("Handling walls for layer:",e.name),this.handleWalls(e)),!0}handleWalls(e){if(!e.visible||!e.objects.length)return;const t=this.getWorldUnitsPerPixel(),r=this.getRenderTranslation(),i=new Set(this.getChildren().map(n=>n.name));console.log("Processing walls for layer:",e.name),e.objects.forEach((n,o)=>{var v;if(!n.visible)return;const s=n.polygon;if(!s||s.length<3)return;const a=-((n.rotation??0)*(Math.PI/180)),l=Math.cos(a),c=Math.sin(a),h=s.map(y=>{const g=y.x*t,A=-y.y*t;return{x:g*l-A*c,y:g*c+A*l}}),m=this.getObjectBaseName(e,n,o),f=this.makeUniqueName(m,i);i.add(f);const p=new Nu(f);p.setIsPhysicsSimulated(!0,"static"),p.addComponent(new zc(h));const _=(n.x+(e.offsetX??0))*t,d=-((n.y+(e.offsetY??0))*t),x=new H(_+r.x,d+r.y);p.setPosition(x),this.addChild(p),(v=this.getWorld())==null||v.spawnActor(p,x)})}};Eu=od([yi()],Eu);let Nu=class extends at{constructor(e){super(e)}};Nu=od([yi()],Nu);
